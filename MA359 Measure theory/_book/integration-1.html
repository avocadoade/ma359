<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Integration | Measure theory lecture notes</title>
  <meta name="description" content="Chapter 5 Integration | Measure theory lecture notes" />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Integration | Measure theory lecture notes" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="https://github.com/avocadoade/ma359" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Integration | Measure theory lecture notes" />
  
  
  

<meta name="author" content="Jo Evans" />


<meta name="date" content="2022-08-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mesurable-funtions.html"/>
<link rel="next" href="norms-and-inequalities.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#integration"><i class="fa fa-check"></i><b>1.1</b> Integration</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#the-most-important-things-you-will-learn-in-this-course"><i class="fa fa-check"></i><b>1.2</b> The most important things you will learn in this course</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="sigma-algebras-definition-of-a-measure.html"><a href="sigma-algebras-definition-of-a-measure.html"><i class="fa fa-check"></i><b>2</b> <span class="math inline">\(\sigma\)</span>-algebras, definition of a measure</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sigma-algebras-definition-of-a-measure.html"><a href="sigma-algebras-definition-of-a-measure.html#collections-of-subsets"><i class="fa fa-check"></i><b>2.1</b> Collections of subsets</a></li>
<li class="chapter" data-level="2.2" data-path="sigma-algebras-definition-of-a-measure.html"><a href="sigma-algebras-definition-of-a-measure.html#set-functions"><i class="fa fa-check"></i><b>2.2</b> Set functions</a></li>
<li class="chapter" data-level="2.3" data-path="sigma-algebras-definition-of-a-measure.html"><a href="sigma-algebras-definition-of-a-measure.html#measure-spaces"><i class="fa fa-check"></i><b>2.3</b> Measure spaces</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="outer-measures-and-lebesgue-measure.html"><a href="outer-measures-and-lebesgue-measure.html"><i class="fa fa-check"></i><b>3</b> Outer measures and Lebesgue Measure</a>
<ul>
<li class="chapter" data-level="4.2" data-path="mesurable-funtions.html"><a href="mesurable-funtions.html"><i class="fa fa-check"></i><b>4.2</b> Egoroff’s Theorem and Lusin’s Theorem</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="integration-1.html"><a href="integration-1.html"><i class="fa fa-check"></i><b>5</b> Integration</a>
<ul>
<li class="chapter" data-level="5.1" data-path="integration-1.html"><a href="integration-1.html#convergence-theorems-for-integrals-of-functions"><i class="fa fa-check"></i><b>5.1</b> Convergence theorems for integrals of functions</a></li>
<li class="chapter" data-level="7.1" data-path="product-measures.html"><a href="product-measures.html"><i class="fa fa-check"></i><b>7.1</b> Applications of product measure and Fubini’s theorem</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="radon-nikodym-theorem.html"><a href="radon-nikodym-theorem.html"><i class="fa fa-check"></i><b>8</b> Radon-Nikodym Theorem</a>
<ul>
<li class="chapter" data-level="8.1" data-path="radon-nikodym-theorem.html"><a href="radon-nikodym-theorem.html#signed-measures"><i class="fa fa-check"></i><b>8.1</b> Signed measures</a></li>
<li class="chapter" data-level="8.2" data-path="radon-nikodym-theorem.html"><a href="radon-nikodym-theorem.html#absolute-continuity"><i class="fa fa-check"></i><b>8.2</b> Absolute Continuity</a></li>
<li class="chapter" data-level="8.3" data-path="radon-nikodym-theorem.html"><a href="radon-nikodym-theorem.html#duality-in-lp-spaces"><i class="fa fa-check"></i><b>8.3</b> Duality in <span class="math inline">\(L^p\)</span> spaces</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Measure theory lecture notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="integration-1" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Integration<a href="integration-1.html#integration-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>We now get to the definition of the Lebesgue integral which is the second important object that we construct in this course. There are several different notations for the integral of a function <span class="math inline">\(f\)</span> with respect to a measure <span class="math inline">\(\mu\)</span>. We have</p>
<p><span class="math display">\[ \mu(f) = \int_E f \mathrm{d}\mu = \int_E f(x) \mu(\mathrm{d}x). \]</span></p>
<p>When you are integrating with respect to Lebesgue measure the most common notation is</p>
<p><span class="math display">\[ \int_E f(x)\mathrm{d}x. \]</span></p>
<p>Before we start constructing the integral we’ll briefly discuss the motivations for how to construct it. Firstly, you’ve already seen the Riemann integral. We can describe the strategy of Riemann integration - very loosly - as splitting the <em>domain</em> of the function into equal sized chunks, estimating the height of the function on each chunk then adding them together. Broadly what happens with Lebesgue integration is that we split the <em>range</em> of the function into equal sized chunks, estimate the size of the part of the domain which will end up in that chunk of range then sum everything up. We need the theory of measure in order to do this because the bit of the domain corresponding to chuncks of the range can be quite weird sets whose size it wouldn’t be possible to measure. The first motivation for this is that whilst Riemann integration only works for functions from subsets of <span class="math inline">\(\mathbb{R}^d\)</span> to <span class="math inline">\(\mathbb{R}\)</span>, Lebesgue integration allows the domain on the function to be quite weird, (as long as it is a measure space). As an example, this is helpful for taking expectations rigorously because expectations are integral of random variables and the domain of a random variable is a probability space which may not be explicit.</p>
<p>The second big motivation for introducing a new theory of integration is the issue of convergence. It is important in many practical applications of integration theory to know when <span class="math inline">\(\lim_n \int f_n(x) \mathrm{d}x = \int \lim_n f_n(x) \mathrm{d}x\)</span> or when <span class="math inline">\(\int_{E_x} \int_{E_y} f(x,y) \mathrm{d}x \mathrm{d}y = \int_{E_y} \int_{E_x} f(x,y) \mathrm{d}y \mathrm{d}x\)</span>. Lebesgue integration allows us to rigorously find conditions on <span class="math inline">\(f\)</span> under which these statements will be true. This is often not possible in a satisfactory way with the Riemann theory of integration. We will see some of these convergence theorems next week and then switching the order of integration towards the end of the course (currently planned for week 9). The most important motivation for developing good convergence theorems was the development of Fourier series. We want to know when it is possible to integrate a Fourier series term by term.</p>
<p>The strategy for constructing the integral is to begin by defining <span class="math inline">\(\mu(f)\)</span> when <span class="math inline">\(f\)</span> belongs to a special class of measurable functions that we call <em>simple functions</em>. We then define the integral to progressively larger classes of functions.</p>
<div class="definition">
<p><span id="def:unlabeled-div-104" class="definition"><strong>Definition 5.1  (Simple functions) </strong></span>Let <span class="math inline">\((E, \mathcal{E}, \mu)\)</span> be a measure space. The set of simple functions on this space taking values in <span class="math inline">\(\mathbb{R}\)</span> are functions of the form</p>
<p><span class="math display">\[ f(x) = \sum_{k=1}^n a_k 1_{A_k}(x). \]</span></p>
<p>Here, the <span class="math inline">\(A_k\)</span> are disjoint sets in <span class="math inline">\(\mathcal{E}\)</span>, <span class="math inline">\(1_{A}\)</span> represents the indicator function of the set, and the <span class="math inline">\(a_k\)</span> are non-negative real numbers. We note that this representation of <span class="math inline">\(f\)</span> is not unique.</p>
</div>
<div class="definition">
<p><span id="def:unlabeled-div-105" class="definition"><strong>Definition 5.2  (The integral of a simple function) </strong></span>Still working in the setting above, let <span class="math inline">\(f(x) = \sum_{k=1}^n a_k 1_{A_k}(x)\)</span>, then we can define</p>
<p><span class="math display">\[ \mu(f) = \sum_{k=1}^n a_k \mu(A_k). \]</span></p>
</div>
<div class="lemma">
<p><span id="lem:unlabeled-div-106" class="lemma"><strong>Lemma 5.1  </strong></span>The integral of a simple function is well defined (it doesn’t depend on the choice of representation of the simple function) and satisfies the following properties.</p>
<ul>
<li>For <span class="math inline">\(\alpha &gt;0\)</span> we have <span class="math inline">\(\mu(\alpha f) = \alpha \mu(f)\)</span></li>
<li><span class="math inline">\(\mu(f+g) = \mu(f) + \mu(g)\)</span>.</li>
<li>If <span class="math inline">\(f(x) \leq g(x)\)</span> for every <span class="math inline">\(x \in E\)</span> then <span class="math inline">\(\mu(f) \leq \mu(g)\)</span>.</li>
<li><span class="math inline">\(f=0\)</span> <span class="math inline">\(\mu\)</span>-almost everywhere if and only if <span class="math inline">\(\mu(f)=0\)</span></li>
</ul>
</div>
<div class="proof">
<p><span id="unlabeled-div-107" class="proof"><em>Proof</em>. </span>Let us first look at the well definedness, without loss of generality lets assume the <span class="math inline">\(a_k, b_j\)</span> are strictly positive and the sets <span class="math inline">\(A_k\)</span> are disjoint and similar for the <span class="math inline">\(B_j\)</span>. Let us suppose that <span class="math inline">\(f = \sum_{k=1}^n a_k 1_{A_k} = \sum_{k=1}^m b_k 1_{B_k}\)</span> which are both simple function representations. Then we can see that <span class="math inline">\(\bigcup_{k=1}^nA_k = \bigcup_{k=1}^m B_k\)</span> and that <span class="math inline">\(a_i =b_j\)</span> if <span class="math inline">\(A_i \cap B_j \neq \emptyset\)</span>. Using this we can write</p>
<p><span class="math display">\[\begin{align*}
\mu(f) &amp;= \sum_{k=1}^n a_k \mu(A_k)\\
\left(\mbox{as}\, A_k = \bigcup_j (A_k \cap B_j)\, \mbox{as}\, \bigcup_{k=1}^nA_k = \bigcup_{j=1}^m B_j\right) \quad \quad &amp;= \sum_{k=1}^n \sum_{j=1}^m a_k \mu(A_k \cap B_j) \\
\left(\mbox{as}\, a_k = b_j\, \mbox{if}\, A_k \cap B_j \neq \emptyset\, \mbox{so}\, a_k=b_j\, \mbox{or}\, \mu(A_k\cap B_j) = 0\right) \quad \quad &amp; = \sum_{k=1}^n \sum_{j=1}^m b_j \mu(A_k \cap B_j) = \sum_{j=1}^m b_j \sum_{k=1}^n \mu(A_k \cap B_j) \\
&amp;= \sum_{j=1}^m b_j \mu(B_j).
\end{align*}\]</span></p>
<p>Now we move on to the linearity properties. These come naturally from the defintion,</p>
<p><span class="math display">\[\begin{align*}
\mu(\alpha f) = \sum_{k=1}^n \alpha a_k \mu(A_k) = \alpha \sum_{k=1}^n a_k \mu(A_k) = \alpha \mu(A_k).
\end{align*}\]</span></p>
<p>When we are dealing with two simple functions simultaneously it is useful to write them both in a representation where the measurable sets appearing are the same for both functions. If we let <span class="math inline">\(g = \sum_{j=1}^m c_j 1_{C_j}\)</span> then let us write <span class="math inline">\(A_0 = E \setminus \bigcup_{k=1}^n A_k, a_0 =0\)</span> and define <span class="math inline">\(C_0, c_0\)</span> similarly then we can write <span class="math inline">\(f+g\)</span> as a simple function via</p>
<p><span class="math display">\[f(x) + g(x) = \sum_{k=0}^n \sum_{j=0}^m (a_k + c_j) 1_{A_k \cap C_j}\]</span></p>
<p>and we have</p>
<p><span class="math display">\[ \mu(f+g) = \sum_{k=0}^n \sum_{j=0}^m (a_k +c_j) \mu(A_k \cap C_j). \]</span></p>
<p>We note that <span class="math inline">\(\bigcup_{k=0}^n A_k = \bigcup_{j=0}^m C_j = E\)</span> and the <span class="math inline">\(A_k\)</span> are mutually disjont, and the <span class="math inline">\(C_j\)</span> are mutually disjoint. Therefore</p>
<p><span class="math display">\[\begin{align*}
\mu(f+g) &amp;= \sum_{k=0}^n \sum_{j=0}^m (a_k +c_j) \mu(A_k \cap C_j)\\
&amp;= \sum_{k=0}^n a_k \sum_{j=0}^m \mu(A_k \cap C_j) + \sum_{j=0}^m c_j \sum_{k=0}^n \mu(A_k \cap C_j) \\
\mbox{as the unions of the $A_k$ or $C_j$ fill the space} \quad &amp; = \sum_{k=0}^n a_k \mu(A_k) + \sum_{j=0}^m c_j \mu(C_j)\\
\mbox{as}\, a_0 = c_0 =0 \quad &amp; = \sum_{k=1}^n a_k \mu(A_k) + \sum_{j=1}^m c_j \mu(C_j) \\
&amp; = \mu(f) + \mu(g).
\end{align*}\]</span></p>
<p>Now we move onto the monotonicity of the integral. Let us express <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> as before, again the goal is to represent the two functions using the same measurable sets. We can rewrite as</p>
<p><span class="math display">\[ f = \sum_{k=0}^n \sum_{j=0}^m a_k 1_{A_k \cap C_j} = \sum_{k=0}^n \sum_{j=0}^m a_{k,j}1_{A_k \cap C_j},\]</span></p>
<p>where <span class="math inline">\(a_{k,j} = a_k 1_{A_k \cap C_j \neq \emptyset}\)</span>. Here again we are using the fact that <span class="math inline">\(\bigcup_{j=0}^m C_j\)</span> fill the space. In the same way we can write</p>
<p><span class="math display">\[ g = \sum_{k=1}^n \sum_{j=1}^m c_{k,j}1_{A_k \cap C_j}, \]</span></p>
<p>where <span class="math inline">\(c_{k,j} = c_j 1_{A_k \cap C_j \neq \emptyset}\)</span>. Then if <span class="math inline">\(f(x) \leq g(x)\)</span> for every <span class="math inline">\(x\)</span> we know that this means <span class="math inline">\(a_{k,j} \leq c_{k,j}\)</span> for every <span class="math inline">\(k,j\)</span>. Then by the well definedness of the integral we have</p>
<p><span class="math display">\[ \mu(f) = \sum_{k=1}^n \sum_{j=1}^m a_{k,j} \mu(A_k \cap C_j) \leq \sum_{k=1}^n \sum_{j=1}^m c_{k,j} \mu(A_k \cap C_j) = \mu(g).\]</span></p>
<p>Lastly, we look at when <span class="math inline">\(\mu(f)=0\)</span>. First if <span class="math inline">\(f=0\)</span> <span class="math inline">\(\mu\)</span>-almost everywhere then <span class="math inline">\(a_k=0\)</span> or <span class="math inline">\(\mu(A_k)=0\)</span> for each <span class="math inline">\(k\)</span>, therefore <span class="math inline">\(\mu(f)=0\)</span>. If <span class="math inline">\(\mu(f) =0\)</span> then since all the terms <span class="math inline">\(a_k \mu(A_k) \geq 0\)</span> we have that <span class="math inline">\(a_k=0\)</span> or <span class="math inline">\(\mu(A_k) =0\)</span> for each <span class="math inline">\(k\)</span>.</p>
</div>
<p>We are now going to extend the definition of the integral to a larger class of functions.</p>
<div class="definition">
<p><span id="def:unlabeled-div-108" class="definition"><strong>Definition 5.3  (Lebesgue integral for positive functions) </strong></span>Let <span class="math inline">\(f\)</span> be a positive, measurable function, we define</p>
<p><span class="math display">\[ \mu(f) = \sup \{ \mu(g)\, :\, g \, \mbox{is a simple function}, g \leq f\} \]</span></p>
</div>
<div class="lemma">
<p><span id="lem:unlabeled-div-109" class="lemma"><strong>Lemma 5.2  </strong></span>The above definition of Lebesgue integral for positive functions is consistent with the defintion for simple functions. That is to say that if <span class="math inline">\(f = \sum_{k=1}^n a_k 1_{A_k}\)</span> where <span class="math inline">\(a_k \geq 0\)</span> and the <span class="math inline">\(A_k\)</span> are disjoint measurable sets then</p>
<p><span class="math display">\[ \sum_{k=1}^n a_k \mu(A_k) = \sup \{ \mu(g)\, :\, g \, \mbox{is a simple function}, g \leq f\}.  \]</span></p>
</div>
<div class="proof">
<p><span id="unlabeled-div-110" class="proof"><em>Proof</em>. </span>This is on the exercise sheet.</p>
</div>
<div class="definition">
<p><span id="def:unlabeled-div-111" class="definition"><strong>Definition 5.4  (Final definition of Lebesgue integral) </strong></span>Suppose that <span class="math inline">\(f\)</span> is a measurable function which is not necessarily positive. Then we call <span class="math inline">\(f\)</span>, <span class="math inline">\(\mu\)</span>-<em>integrable</em> or <em>Lebesgue integrable</em> if <span class="math inline">\(\mu(|f|)&lt; \infty\)</span>. In this case we can write <span class="math inline">\(f = f_+ - f_{-}\)</span> where <span class="math inline">\(f_+\)</span> and <span class="math inline">\(f_-\)</span> are both positive and measurable (<span class="math inline">\(f_+ = \max\{f, 0\}\)</span>). We then define the integral of <span class="math inline">\(f\)</span> by</p>
<p><span class="math display">\[ \mu(f) = \mu(f_+) - \mu(f_-). \]</span></p>
</div>
<div class="remark">
<p><span id="unlabeled-div-112" class="remark"><em>Remark</em>. </span>Notice that we haven’t yet proved that these definitions of the integral behave the way we hope (e.g. are linear, monotone, etc). In order to do this we need to prove some convergence results.</p>
</div>
<div id="convergence-theorems-for-integrals-of-functions" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Convergence theorems for integrals of functions<a href="integration-1.html#convergence-theorems-for-integrals-of-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This is one of the most useful parts of the course. In follow on courses in PDE and probability you will use these theorems again and again.</p>
<div class="lemma">
<p><span id="lem:unlabeled-div-113" class="lemma"><strong>Lemma 5.3  </strong></span>If <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> are non-negative, measurable, real valued functions on <span class="math inline">\((E, \mathcal{E}, \mu)\)</span> and <span class="math inline">\(f \leq g\)</span> then <span class="math inline">\(\mu(f) \leq \mu(g)\)</span>.</p>
</div>
<div class="proof">
<p><span id="unlabeled-div-114" class="proof"><em>Proof</em>. </span>If <span class="math inline">\(f \leq g\)</span> then we recall that by definition</p>
<p><span class="math display">\[\mu(f) = \sup\{ \mu(\tilde{f}) \,:\, \mbox{$\tilde{f}$ is simple},\, \tilde{f} \leq f\}y.\]</span></p>
<p>So if <span class="math inline">\(h\)</span> is a simple function with <span class="math inline">\(h \leq f\)</span> then we also have that <span class="math inline">\(h \leq g\)</span>. Therefore, we can write</p>
<p><span class="math display">\[\begin{align*} \mu(g) &amp;= \sup\{ \mu(h) \,:\, \mbox{$h$ is simple},\, h \leq g\} \\ &amp;= \max\{\sup\{ \mu(h)\, :\, \mbox{$h$ simple}, h \leq f\}, \sup\{ \mu(h)\, :\, \mbox{$h$ simple}, h \leq g, \mbox{$h$ is not $\leq$ f}\} \}\\ &amp;= \max\{ \mu(f), \sup\{ \mu(h)\, :\, \mbox{$h$ simple}, h \leq f, \mbox{$h$ is not $\leq$ g}\}\} \geq \mu(f).\end{align*}\]</span></p>
</div>
<div class="theorem">
<p><span id="thm:unlabeled-div-115" class="theorem"><strong>Theorem 5.1  (Monotone Convergence Theorem) </strong></span>Let <span class="math inline">\(f\)</span> be a non-negative, measurable real-valued function and let <span class="math inline">\(f_n\)</span> be a sequence of such functions. Then if <span class="math inline">\(f_n \uparrow f\)</span> we will have that <span class="math inline">\(\mu(f_n) \uparrow \mu(f)\)</span>.</p>
</div>
<div class="proof">
<p><span id="unlabeled-div-116" class="proof"><em>Proof</em>. </span>We will break this proof down into progressively more complicated cases. First we note that by monotonicity <span class="math inline">\(\lim_n \mu(f_n) \leq \mu(f)\)</span> and therefore it is sufficient to prove <span class="math inline">\(\mu(f) \leq \lim_n \mu(f_n)\)</span>.</p>
<p>First let us look at the case where <span class="math inline">\(f_n = 1_{A_n}\)</span> and <span class="math inline">\(f=1_{A}\)</span>, then the assumptions imply that <span class="math inline">\(A_1 \subseteq A_2 \subseteq A_3 \subseteq \dots\)</span> and <span class="math inline">\(A= \bigcup_n A_n\)</span>. Then this result is the same as the continuity of a measure as proved before.</p>
<p>Now let us keep <span class="math inline">\(f=1_{A}\)</span> and let <span class="math inline">\(f_n\)</span> be a sequence of simple functions. Pick <span class="math inline">\(\epsilon \in (0,1)\)</span> arbitrary. Then let <span class="math inline">\(A_n = \{ x\,:\, f_n(x)&gt;1-\epsilon\}\)</span> then we have that <span class="math inline">\(A_n \uparrow A\)</span>, and <span class="math inline">\((1-\epsilon)1_{A_n} \leq f_n\)</span>. Therefore by the first case we have that <span class="math inline">\(\lim_n \mu(f_n) \geq \lim_n \mu((1-\epsilon)1_{A_n}) = \lim_n (1-\epsilon) \mu(1_{A_n}) = (1-\epsilon) \mu(f)\)</span>. Since <span class="math inline">\(\epsilon\)</span> is arbitrary this gives the result.</p>
<p>Now we look at the case where both <span class="math inline">\(f\)</span> and <span class="math inline">\(f_n\)</span> are simple functions. We can write <span class="math inline">\(f = \sum_{k=1}^n a_k 1_{A_k}\)</span>, where wlog each <span class="math inline">\(a_k\)</span> is strictly positive, then we have that <span class="math inline">\(a_k^{-1} f_n 1_{A_k} \uparrow 1_{A_k}\)</span> so we can apply the previous case to each part of <span class="math inline">\(f\)</span>. Specifically</p>
<p><span class="math display">\[ \mu(f_n) = \mu(\sum_{k=1}^n  1_{A_k}f_n) = \sum_{k=1}^n a_k \mu (a_k^{-1} 1_{A_k}f_n) \uparrow \sum_{k=1}^n a_k \mu(A_k) = \mu(f). \]</span></p>
<p>Here the first equality follows from the fact that the support of <span class="math inline">\(f_n\)</span> must be included in the support of <span class="math inline">\(f\)</span> since <span class="math inline">\(0 \leq f_n \leq f\)</span>.</p>
<p>Our next case is when <span class="math inline">\(f\)</span> is positive and measurable and <span class="math inline">\(f_n\)</span> are all simple. Let us pick <span class="math inline">\(g\)</span> a simple function with <span class="math inline">\(g \leq f\)</span> then <span class="math inline">\(g_n = f_n \wedge g = \min\{f_n, g\}\)</span> is a sequence of simple functions increasing to <span class="math inline">\(g\)</span>. Therefore, by our previous case <span class="math inline">\(\mu(g_n) \uparrow \mu(g)\)</span>. Furthermore <span class="math inline">\(g_n \leq f_n\)</span> so by monotonicity</p>
<p><span class="math display">\[\mu(g) =\lim_n \mu(g_n) \leq \lim_n \mu(f_n).\]</span></p>
<p>As <span class="math inline">\(g\)</span> is an arbitrary this means that <span class="math inline">\(\sup\{\mu(g)\,:\, g \, \mbox{is a simple function}, g \leq f\} \leq \lim_n \mu(f_n).\)</span></p>
<p>The last case is the most general where both <span class="math inline">\(f_n\)</span> and <span class="math inline">\(f\)</span> are positive and measureable. In this case we introduce our favorite kind of approximation (which is very similar to what we used in Lusin’s theorem)</p>
<p><span class="math display">\[ g_n = \left( 2^{-n} \lfloor 2^n f_n \rfloor \right) \wedge n, \]</span></p>
<p>then <span class="math inline">\(g_n\)</span> is a sequence of simple functions with <span class="math inline">\(g_n \uparrow f\)</span> and <span class="math inline">\(g_n \leq f_n\)</span>, proving this is an exercise on the assignment. Therefore we have</p>
<p><span class="math display">\[ \mu(f) = \lim_n \mu(g_n) \leq \lim_n \mu(f_n) \leq \mu(f). \]</span></p>
<p>Hence we have the required result.</p>
</div>
<p>We have a corollary of this result which can be thought of as another definition of <span class="math inline">\(\mu(f)\)</span> for non-negative, measurable <span class="math inline">\(f\)</span>. This makes concrete our hand-waving definition of how Lebesgue measure works as splitting the range of <span class="math inline">\(f\)</span> up into equal chunks and using this to approximate the area under the curve. This is often a more practically useful definition of the integral of a positive function.</p>
<div class="corollary">
<p><span id="cor:unlabeled-div-117" class="corollary"><strong>Corollary 5.1  </strong></span>Let <span class="math inline">\(f\)</span> be a non-negative, measurable, real valued function on <span class="math inline">\((E, \mathcal{E}, \mu)\)</span> and define</p>
<p><span class="math display">\[ f_n = \left( 2^{-n} \lfloor 2^n f \rfloor \right) \wedge n, \]</span></p>
<p>then <span class="math inline">\(\mu(f) = \lim_n \mu(f_n)\)</span>.</p>
</div>
<div class="proof">
<p><span id="unlabeled-div-118" class="proof"><em>Proof</em>. </span><span class="math inline">\(f_n \uparrow f\)</span> so by monotone convergence <span class="math inline">\(\lim_n \mu(f_n) = \mu(f)\)</span>.</p>
</div>
<p>We can now use this to prove that the integral of positive measurable functions has the desired properties.</p>
<div class="proposition">
<p><span id="prp:unlabeled-div-119" class="proposition"><strong>Proposition 5.1  </strong></span>Suppose <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> are non-negative, real valued, measurable function on a space <span class="math inline">\((E, \mathcal{E}, \mu)\)</span> then</p>
<ul>
<li>For every <span class="math inline">\(\alpha&gt;0\)</span> <span class="math inline">\(\mu(\alpha f) = \alpha \mu(f)\)</span>,</li>
<li><span class="math inline">\(\mu(f+g) = \mu(f) + \mu(g)\)</span></li>
<li>If <span class="math inline">\(f \leq g\)</span> then <span class="math inline">\(\mu(f) \leq \mu(g)\)</span></li>
<li><span class="math inline">\(\mu(f) = 0\)</span> if and only if <span class="math inline">\(f\)</span> is <span class="math inline">\(0\)</span> almost everywhere.</li>
</ul>
</div>
<div class="proof">
<p><span id="unlabeled-div-120" class="proof"><em>Proof</em>. </span>Suppose that <span class="math inline">\(f_n\)</span> is a sequence of simple functions with <span class="math inline">\(f_n \uparrow f\)</span> then <span class="math inline">\(\alpha f_n\)</span> is a sequence of simple functions with <span class="math inline">\(\alpha f_n \uparrow \alpha f\)</span>. Monotone convergence tells us that <span class="math inline">\(\mu(\alpha f) = \lim_n \mu(\alpha f_n)\)</span>. We can use our previous results for simple functions to get that <span class="math inline">\(\mu(\alpha f_n) = \alpha \mu(f_n)\)</span>. Therefore <span class="math inline">\(\mu(\alpha f) = \lim_n \mu(\alpha f_n) = \lim_n \alpha \mu(f_n) = \alpha \mu(f)\)</span>.</p>
<p>For the sum let <span class="math inline">\(f_n\)</span> and <span class="math inline">\(g_n\)</span> be sequences of simple functions with <span class="math inline">\(f_n \uparrow f\)</span> and <span class="math inline">\(g_n \uparrow g\)</span>. Then we have <span class="math inline">\((f_n + g_n) \uparrow f+g\)</span> and by monotone convergence and the results for simple functions we have <span class="math inline">\(\mu(f+g) = \lim_n \mu(f_n + g_n) = \lim_n \mu(f_n) + \lim_n \mu(g_n) = \mu(f) + \mu(g)\)</span>.</p>
<p>The third point is proved before.</p>
<p>Now <span class="math inline">\(\mu(f) = 0\)</span> if and only if</p>
<p><span class="math display">\[\sup\{ \mu(h) \,:\, \mbox{$h$ simple},\, h \leq f\} = 0\]</span></p>
<p>which is if and only if <span class="math inline">\(\mu(h) = 0\)</span> for every <span class="math inline">\(h \leq f\)</span> and <span class="math inline">\(h\)</span> simple. Now we know that if <span class="math inline">\(h\)</span> is simple <span class="math inline">\(\mu(h) = 0\)</span> if and only if <span class="math inline">\(h\)</span> is zero almost everywhere. This tells us that <span class="math inline">\(\mu(f) = 0\)</span> if and only if <span class="math inline">\(h \leq f\)</span> and <span class="math inline">\(h\)</span> simple, implies <span class="math inline">\(h = 0\)</span> almost everywhere. If we look at the set on which <span class="math inline">\(f\)</span> is positive we have <span class="math inline">\(\{x\,:\, f(x)&gt;0\} = \bigcup_n \{ x \,:\, f(x) &gt; 1/n\}\)</span> so by continuity of measure if <span class="math inline">\(\mu( f&gt;0)&gt;0\)</span> then there exists some <span class="math inline">\(n\)</span> such that <span class="math inline">\(\mu(f &gt;1/n)&gt;0\)</span> therefore <span class="math inline">\(f\)</span> is zero almost everywhere if and only if we can’t fit any simple function underneath <span class="math inline">\(f\)</span> which is not zero almost everywhere.</p>
</div>
<p>Using this we can give another writing of the monotone convergence theorem.</p>
<div class="proposition">
<p><span id="prp:unlabeled-div-121" class="proposition"><strong>Proposition 5.2  (Beppo-Levi) </strong></span>Suppose that <span class="math inline">\((f_n)_{n \geq 0}\)</span> is a sequence of real-valued measurable functions. Then <span class="math inline">\(\mu(\sum_n f_n) = \sum_n \mu(f_n)\)</span>.</p>
</div>
<div class="proof">
<p><span id="unlabeled-div-122" class="proof"><em>Proof</em>. </span>Write <span class="math inline">\(g_n = \sum_{k=1}^n f_k\)</span> then <span class="math inline">\(g_n \uparrow \sum_n f_n\)</span></p>
<p><span class="math display">\[  \sum_n \mu(f_n) = \lim_n \sum_{k=1}^n \mu(f_k),\]</span></p>
<p>then by linearity</p>
<p><span class="math display">\[ \lim_n \sum_{k=1}^n \mu(f_k) = \lim_n \mu(\sum_{k=1}^n f_k) = \lim_n \mu(g_n), \]</span></p>
<p>then using monotone convergence we have</p>
<p><span class="math display">\[ \lim_n \mu(g_n) = \mu(\sum_n f_n). \]</span></p>
</div>
<p>We can also prove that our notion of convergence for integrable functions behaves in the way we expect. First we prove a helpful Lemma</p>
<div class="lemma">
<p><span id="lem:unlabeled-div-123" class="lemma"><strong>Lemma 5.4  </strong></span>Let <span class="math inline">\(f_1, f_2, g_1, g_2\)</span> all be non-negative, integrable, real valued functions such that <span class="math inline">\(f_1-f_2 = g_1-g_2\)</span> then we have <span class="math inline">\(\mu(f_1) - \mu(f_2) = \mu(g_1) - \mu(g_2)\)</span>.</p>
</div>
<div class="proof">
<p><span id="unlabeled-div-124" class="proof"><em>Proof</em>. </span>We have that <span class="math inline">\(f_1+g_2 = g_1 + f_2\)</span> so <span class="math inline">\(\mu(f_1+g_2) = \mu(g_1+f_2)\)</span>, using linearity we have</p>
<p><span class="math display">\[ \mu(f_1) + \mu(g_2) = \mu(g_1) + \mu(f_2) \]</span></p>
<p>since all the integrals involved are finite we can rearrange this to give</p>
<p><span class="math display">\[ \mu(f_1) - \mu(f_2) = \mu(g_1) - \mu(g_2). \]</span></p>
</div>
<div class="proposition">
<p><span id="prp:unlabeled-div-125" class="proposition"><strong>Proposition 5.3  </strong></span>Suppose that <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> are integrable, real valued function on <span class="math inline">\((E, \mathcal{E}, \mu)\)</span> then</p>
<ul>
<li>For every <span class="math inline">\(\alpha&gt;0\)</span> we have <span class="math inline">\(\mu(\alpha f) = \alpha \mu(f)\)</span>, we also have <span class="math inline">\(\mu(-f) = -\mu(f)\)</span></li>
<li>The function <span class="math inline">\(f+g\)</span> is integrable and <span class="math inline">\(\mu(f+g) = \mu(f) + \mu(g)\)</span></li>
<li>If <span class="math inline">\(f \leq g\)</span> then <span class="math inline">\(\mu(f) \leq \mu(g)\)</span></li>
</ul>
</div>
<div class="proof">
<p><span id="unlabeled-div-126" class="proof"><em>Proof</em>. </span>Let us write <span class="math inline">\(f= f_+ - f_-\)</span> and <span class="math inline">\(g= g_+ - g_-\)</span> where these are split into the positive and negative parts of <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span>. Then <span class="math inline">\(\alpha f = \alpha f_+ - \alpha f_-\)</span> so <span class="math inline">\(\mu(\alpha f) = \mu(\alpha f_+) - \mu(\alpha f_-) = \alpha (\mu(f_+)-\mu(f_-))\)</span>. Similarly <span class="math inline">\(-f=f_- - f_+\)</span> so <span class="math inline">\(\mu(-f) = \mu(f_-) - \mu(f_+) = -\mu(f)\)</span>.</p>
<p>First we have that <span class="math inline">\(|f+g| \leq |f|+|g|\)</span> so <span class="math inline">\(f+g\)</span> is integrable. For the second point we need to use the Lemma above. We know that <span class="math inline">\((f_+ + g_+) - (f_- + g_-) = (f+g)_+ - (f+g)_-\)</span> and all of <span class="math inline">\((f_+ + g_+),(f_-+g_-), (f+g)_+, (f+g)_-\)</span> are non-negative and integrable so using the lemma we have</p>
<p><span class="math display">\[ \mu(f+g) = \mu((f+g)_+) - \mu((f+g)_-) = \mu(f_+ +g_+) - \mu(f_- + g_-) = \mu(f_+) - \mu(f_-) + \mu(g_+) - \mu(g_-) = \mu(f) + \mu(g). \]</span></p>
<p>For the last point if <span class="math inline">\(f \leq g\)</span> then <span class="math inline">\(g-f\)</span> is a non-negative measurable function so <span class="math inline">\(\mu(g-f) \geq 0\)</span> and <span class="math inline">\(\mu(g) = \mu(f+(g-f))\)</span>. We then use the linearity from the last point to get <span class="math inline">\(\mu(f + (g-f)) = \mu(f) + \mu(g-f) \geq \mu(f)\)</span>.</p>
</div>
<div class="theorem">
<p><span id="thm:unlabeled-div-127" class="theorem"><strong>Theorem 5.2  (Fatou's Lemma) </strong></span>Let <span class="math inline">\(f_n\)</span> be a sequence of non-negative measurable function then we have the following result</p>
<p><span class="math display">\[ \mu \left( \liminf_n f_n \right) \leq \liminf_n \mu(f_n) \]</span></p>
</div>
<div class="remark">
<p><span id="unlabeled-div-128" class="remark"><em>Remark</em>. </span>I always have trouble remembering which way around the inequality goes in this lemma. A helpful example is if <span class="math inline">\(f_n = 1_{[n,n+1)}\)</span> and <span class="math inline">\(\mu\)</span> is Lebesgue measure. Then <span class="math inline">\(\lambda(f_n) = 1\)</span> for every <span class="math inline">\(n\)</span> and <span class="math inline">\(\liminf_n f_n = 0\)</span>. This is also an instructive example for why the limits can fail to be the same. Essentially here the mass we are trying to integrate escapes to infinity.</p>
</div>
<div class="proof">
<p><span id="unlabeled-div-129" class="proof"><em>Proof</em>. </span>This is essentially a consequence of monotone convergence. Let <span class="math inline">\(g_n = \inf_{k \geq n} f_k\)</span>, then <span class="math inline">\(g_n\)</span> is a non-decreasing sequence of measurable functions and <span class="math inline">\(g_n \leq f_n\)</span> for each <span class="math inline">\(n\)</span>. By definition of the <span class="math inline">\(g_n\)</span> we also know that <span class="math inline">\(\liminf f_n = \liminf_n g_n = \lim_n g_n\)</span>. Using Monotone convergence we then have</p>
<p><span class="math display">\[ \mu(\liminf_n f_n) = \mu(\lim_n g_n) = \lim_n \mu(g_n). \]</span></p>
<p>Then using monotonicity we have</p>
<p><span class="math display">\[ \mu(g_n) \leq \mu(f_n) \]</span></p>
<p>for each <span class="math inline">\(n\)</span>, so consequently</p>
<p><span class="math display">\[\lim_n \mu(g_n) =  \liminf_n \mu(g_n) \leq \liminf_n \mu(f_n). \]</span></p>
<p>Putting these all together gives the result.</p>
</div>
<p>Fatou’s lemma is key to proving our next important convergence theorem.</p>
<div class="theorem">
<p><span id="thm:unlabeled-div-130" class="theorem"><strong>Theorem 5.3  (Dominated convergence theorem) </strong></span>Let <span class="math inline">\(f_n\)</span> be a sequence of functions and <span class="math inline">\(f\)</span> another function such that <span class="math inline">\(f_n \rightarrow f\)</span> almost everywhere. Suppose further that there exists a positive function <span class="math inline">\(g\)</span> such that <span class="math inline">\(|f| \leq g, |f_n| \leq g\)</span> for every <span class="math inline">\(n\)</span> and <span class="math inline">\(\mu(g) &lt; \infty\)</span>, then <span class="math inline">\(\lim_n \mu(f_n) = \mu(f)\)</span>. The function <span class="math inline">\(g\)</span> is called the <em>dominating function</em>.</p>
</div>
<div class="proof">
<p><span id="unlabeled-div-131" class="proof"><em>Proof</em>. </span>Let us first suppose that <span class="math inline">\(f_n \rightarrow f\)</span> and the domination conditions hold everywhere. Then we have that <span class="math inline">\(g+f_n\)</span> is a sequence of non-negative measurable functions whose limit is <span class="math inline">\(g+f\)</span>. Applying Fatou’s lemma gives</p>
<p><span class="math display">\[ \mu(g+f) \leq \liminf_n \mu(g+f_n) = \mu(g) + \liminf_n \mu(f_n), \]</span></p>
<p>subtracting <span class="math inline">\(\mu(g)\)</span> from each side (which we can do as it is finite) gives</p>
<p><span class="math display">\[ \mu(f) \leq \liminf_n \mu(f_n). \]</span></p>
<p>Similarly <span class="math inline">\(g-f_n\)</span> is a sequence of non-negative measurable functions whose limit is <span class="math inline">\(g-f\)</span>. Applying Fatou’s lemma again gives</p>
<p><span class="math display">\[ \mu(g) - \mu(f) \leq \mu(g) + \liminf_n (-\mu(f_n)) = \mu(g) - \limsup_n \mu(f_n). \]</span></p>
<p>Rearranging this since all the quantities are finite gives</p>
<p><span class="math display">\[ \limsup_n \mu(f_n) \leq \mu(f). \]</span></p>
<p>Putting both parts together gives</p>
<p><span class="math display">\[ \mu(f) \leq \liminf_n \mu(f_n) \leq \limsup_n \mu(f_n) \leq \mu(f). \]</span></p>
<p>Therefore the limit of the sequence <span class="math inline">\(\mu(f_n)\)</span> exists and is equal to <span class="math inline">\(\mu(f)\)</span>.</p>
<p>The extension of this result to when the conditions only hold almost everywhere is due to the fact that the integrals of any function is unchanged by modifying that function on a measure zero set. This type of result will be discussed in more detail when we introduce <em>Lebesgue spaces</em>. It isn’t really the point of this particular theorem, we just give the full version here so we are able to apply it.</p>
</div>
<p>The following is a useful criteria for when we can differentiate under the integral sign which also serves as a good example of how to use the dominated convergence theorem.</p>
<div class="theorem">
<p><span id="thm:unlabeled-div-132" class="theorem"><strong>Theorem 5.4  (Differentiation under the integral sign) </strong></span>Let <span class="math inline">\((E, \mathcal{E}, \mu)\)</span> be a measure space and <span class="math inline">\(f: U \times E \rightarrow \mathbb{R}\)</span> be a function such that <span class="math inline">\(x \mapsto f(t,x)\)</span> is integrable for every <span class="math inline">\(t\)</span>, and <span class="math inline">\(t \mapsto f(t,x)\)</span> is differentiable for every <span class="math inline">\(x\)</span>, and suppose further that there exists an integrable function <span class="math inline">\(g(x)\)</span> such that</p>
<p><span class="math display">\[ \left| \frac{\partial f(t,x)}{\partial t} \right| \leq g(x), \quad \forall t \in U \]</span></p>
<p>then the function <span class="math inline">\(x \mapsto \partial f(t,x)/ \partial t\)</span> is integrable and the function <span class="math inline">\(F(t) = \int_E f(t,x) \mu(\mathrm{d}x)\)</span> is differentiable with</p>
<p><span class="math display">\[ \frac{\mathrm{d}F}{\mathrm{d}t} = \int_E \frac{\partial f}{\partial t}(t,x) \mu(\mathrm{d}x). \]</span></p>
<p>Notice here we are using a different notation for the integral with respect to <span class="math inline">\(\mu\)</span>. We do this because it is helpful to be able to emphasise that we integrate in <span class="math inline">\(x\)</span> but not <span class="math inline">\(t\)</span>.</p>
</div>
<div class="proof">
<p><span id="unlabeled-div-133" class="proof"><em>Proof</em>. </span>Let <span class="math inline">\(\epsilon_n\)</span> be an arbitrary sequence which tends towards <span class="math inline">\(0\)</span>. Let</p>
<p><span class="math display">\[ g_n(t,x) = \frac{f(t+\epsilon_n,x) - f(t,x)}{\epsilon_n} - \frac{\partial f}{\partial t}(t,x). \]</span></p>
<p>First we notice that <span class="math inline">\(g_n \rightarrow 0\)</span> and <span class="math inline">\(g_n + \partial f/\partial t\)</span> is measurable so <span class="math inline">\(\partial f/ \partial t\)</span> is the limit of measurable functions so measurable. By the mean value theorem we have <span class="math inline">\(|g_n| \leq 2g\)</span> for each <span class="math inline">\(n\)</span>. Therefore, by dominated convergence we have</p>
<p><span class="math display">\[ \int g_n(t,x) \mu(\mathrm{d}x) \rightarrow 0.  \]</span></p>
<p>This gives the required result.</p>
</div>
<p>We have a couple of useful facts about integration which don’t fit into a big section.</p>
<div class="definition">
<p><span id="def:unlabeled-div-134" class="definition"><strong>Definition 5.5  (Restriction of a Measure) </strong></span>Suppose that <span class="math inline">\((E, \mathcal{E}, \mu)\)</span> is a measure space and <span class="math inline">\(A \in \mathcal{E}\)</span> then the set of measurable subsets of <span class="math inline">\(A\)</span> is a <span class="math inline">\(\sigma\)</span> algebra we call <span class="math inline">\(\mathcal{A}\)</span> and the restriction of <span class="math inline">\(\mu\)</span> to <span class="math inline">\(\mathcal{E}_A\)</span> is a measure we call <span class="math inline">\(\mu_A\)</span>. Furthermore we have that if <span class="math inline">\(f\)</span> is a measurable function on <span class="math inline">\(E\)</span> then <span class="math inline">\(\mu(f1_A) = \mu_A(f)\)</span>.</p>
</div>
<div class="remark">
<p><span id="unlabeled-div-135" class="remark"><em>Remark</em>. </span>The last part is actually a lemma whose proof is an exercise.</p>
</div>
<p>We can use this definition to make sense of Lebesgue integrals on intervals (for example). If <span class="math inline">\(I= [a,b]\)</span> then <span class="math inline">\(\int_a^b f(x) \mathrm{d}x = \lambda(f1_I)\)</span>.</p>
<p>We also notice that we can define a measure using a positive function <span class="math inline">\(f\)</span>.</p>
<div class="proposition">
<p><span id="prp:unlabeled-div-136" class="proposition"><strong>Proposition 5.4  </strong></span>Let <span class="math inline">\((E, \mathcal{E}, \mu)\)</span> be a measure space and let <span class="math inline">\(f\)</span> be a non-negative measurable function. Define <span class="math inline">\(\nu(A) = \mu(f1_A)\)</span> for each <span class="math inline">\(A \in \mathcal{E}\)</span>. Then <span class="math inline">\(\nu\)</span> is a measure on <span class="math inline">\(E\)</span> and for all non-negative <span class="math inline">\(g\)</span> we have</p>
<p><span class="math display">\[ \nu(g) = \mu(fg) \]</span></p>
</div>
<div class="proof">
<p><span id="unlabeled-div-137" class="proof"><em>Proof</em>. </span>First we need to show that <span class="math inline">\(\nu\)</span> is indeed a measure. <span class="math inline">\(f1_\emptyset = 0\)</span> so we have <span class="math inline">\(\nu(\emptyset) = 0\)</span> as required. We will also have that <span class="math inline">\(\nu(A) \geq 0\)</span> since <span class="math inline">\(f\)</span> is non-negative. We show countable additivity, we note that if <span class="math inline">\(A\)</span> an <span class="math inline">\(B\)</span> are disjoin then <span class="math inline">\(1_{A \cup B} = 1_A + 1_B\)</span> and furthermore if $A_1, A_2, $ is a sequence of disjoint sets then <span class="math inline">\(1_{\bigcup_n A_n} = \sum_n 1_{A_n}\)</span>. With this reformulation <span class="math inline">\(\nu(\bigcup_n A_n) = \mu( f1_{\bigcup_n A_n}) = \mu ( \sum_n f1_{A_n})\)</span> using the Beppo-Levi reformulation of monotone convergence we have</p>
<p><span class="math display">\[ \mu(\sum_n f1_{A_n} ) = \sum_n \mu(f1_{A_n}) = \sum_n \nu(A_n), \]</span></p>
<p>which is our desired result.</p>
<p>Now we want to show that if <span class="math inline">\(g \geq 0\)</span> then <span class="math inline">\(\nu(g) = \mu(fg)\)</span>. Let us begin with the case where <span class="math inline">\(g=1_A\)</span> for some measurable <span class="math inline">\(A\)</span>, then <span class="math inline">\(\nu(g) = \nu(A) = \mu(f1_A) = \mu(fg)\)</span> so the result follows by definition. Then using the linearity of <span class="math inline">\(\mu\)</span> we can see that if <span class="math inline">\(g\)</span> is a simple function then <span class="math inline">\(\nu(g) = \mu(fg)\)</span>. Now suppose that <span class="math inline">\(g\)</span> is not necessarilly simple, we can constuct (in our standard way) a sequence of simple functions, <span class="math inline">\(g_n\)</span>, which increase to <span class="math inline">\(g\)</span> then by monotone convergence we have that <span class="math inline">\(\nu(g) = \lim_n \nu(g_n) = \lim_n \mu(f g_n)\)</span>. Now <span class="math inline">\(fg_n\)</span> is a sequence of function which increases to <span class="math inline">\(fg\)</span> so using monotone convergence we have that <span class="math inline">\(\lim_n \mu(f g_n) = \mu(fg)\)</span> so we have that <span class="math inline">\(\nu(g) = \mu(fg)\)</span>.</p>
</div>
<p>There are also a few facts about Riemann integration which work in pretty much exactly the same way for Lebesgue integration. For example the fundamental theorem of calculus holds equally well in this case. We will see in general that when something is Riemann integrable it is also Lebesgue integrable which will prove all these in general.</p>
<div class="theorem">
<p><span id="thm:unlabeled-div-138" class="theorem"><strong>Theorem 5.5  (Fundamental theorem of calculus) </strong></span>Suppose that <span class="math inline">\(f: [a,b] \rightarrow \mathbb{R}\)</span> is a continuous function and set <span class="math inline">\(F(t) = \int_a^t f(x) \mathrm{d}x = \lambda( 1_{[a,t]} f)\)</span>, then <span class="math inline">\(F\)</span> is differentiable with <span class="math inline">\(F&#39;(t) = f(t)\)</span>. Furthermore, let <span class="math inline">\(F: [a,b] \rightarrow \mathbb{R}\)</span> have continuous derivative <span class="math inline">\(f\)</span>, then <span class="math inline">\(F(b) - F(a) = \int_a^b f(x) \mathrm{d}x\)</span>.</p>
</div>
<p>::: {.proof}</p>
<p>Given <span class="math inline">\(\epsilon &gt;0\)</span> there exists <span class="math inline">\(\delta &gt;0\)</span> such that <span class="math inline">\(|x-t| \leq \delta\)</span> implies that <span class="math inline">\(|f(x) -f(t)| \leq \epsilon\)</span> therefore if we take <span class="math inline">\(|h| \leq \delta\)</span> then</p>
<p><span class="math display">\[ \left| \frac{1}{h}(F(t+h) - F(t)) - f(t)\right| = \frac{1}{|h|} \left|\int_t^{t+h}(f(x) - f(t)) \mathrm{d}x\right| \leq \frac{1}{|h|} \int_{t \wedge (t+h)}^{t \vee (t+h)} |f(x) - f(t)| \mathrm{d}x. \]</span></p>
<p>Now we can use the fact that inside the integral <span class="math inline">\(|x-t| \leq \delta\)</span> so we have</p>
<p><span class="math display">\[ [\left| \frac{1}{h}(F(t+h) - F(t)) - f(t)\right| \leq \frac{1}{|h|} \int_{t \wedge (t+h)}^{t \vee (t+h)} \epsilon \mathrm{d}x = \epsilon. \]</span></p>
<p>Therefore <span class="math inline">\(\lim_{h \rightarrow 0} (F(t+h)-F(t))/h = f(t)\)</span>.</p>
<p>In the other direction <span class="math inline">\(\mathrm{d}/\mathrm{d}t(F(t) - \int_a^t f(x) \mathrm{d}x) = 0\)</span> so <span class="math inline">\(F(t) - \int_a^t f(x) \mathrm{d}x\)</span> is constant in <span class="math inline">\(t\)</span> (by the mean value theorem), so <span class="math inline">\(F(t) = F(a) + \int_a^t f(x) \mathrm{d}x\)</span>. This gives us the result.</p>
<div class="proof">
<p><span id="unlabeled-div-195" class="proof"><em>Proof</em>. </span>We can use the fundamental theorem of calculus to prove the standard result about change of variables. This time we can exploit our new machinery.</p>
<div class="proposition">
<p><span id="prp:unlabeled-div-139" class="proposition"><strong>Proposition 5.5  </strong></span>Let <span class="math inline">\(\phi: [a,b] \rightarrow [\phi(a), \phi(b)]\)</span> be continuously differentiable and strictly increasing then for all non-negative <span class="math inline">\(g\)</span> on <span class="math inline">\([\phi(a), \phi(b)]\)</span> we have</p>
<p><span class="math display">\[ \int_{\phi(a)}^{\phi(b)}g(y) \mathrm{d}y = \int_a^b g(\phi(x)) \phi&#39;(x) \mathrm{d}x. \]</span></p>
</div>
<div class="proof">
<p><span id="unlabeled-div-140" class="proof"><em>Proof</em>. </span>First suppose that <span class="math inline">\(g\)</span> is the indicator function of an interval <span class="math inline">\((c,d]\)</span> then we want to prove that</p>
<p><span class="math display">\[ \int_{\phi(a)}^{\phi(b)} 1_{(c,d]}(x) \mathrm{d}y = \int_a^b  1_{(c,d]}(\phi(x)) \phi&#39;(x) \mathrm{d}x.\]</span></p>
<p>Here the left hand side is equal to <span class="math inline">\([\phi(a), \phi(b)] \cap (c,d]\)</span> and the right hand side is</p>
<p><span class="math display">\[ \int_{a \vee \phi^{-1}(c)}^{b \wedge \phi^{-1}(d)} \phi&#39;(x) \mathrm{d}x,\]</span></p>
<p>using the fundamental theorem of calculus this is</p>
<p><span class="math display">\[ \phi(b \wedge \phi^{-1}(d)) - \phi(a \vee \phi^{-1}(c)) = \phi(b) \wedge d - \phi(a) \vee c = [\phi(a), \phi(b)] \cap (c,d] \]</span></p>
<p>where here we used the fact that <span class="math inline">\(\phi\)</span> was increasing to commute it with min and max.</p>
<p>Now we have shown our proposition holds when <span class="math inline">\(g\)</span> is the indicator function of a half open interval. By linearity of the integral it will hold when <span class="math inline">\(g\)</span> is the indicator function of a finite disjoint union of half open intervals. Now let <span class="math inline">\(\mathcal{D}\)</span> be the set of all Borel sets <span class="math inline">\(A\)</span> such that <span class="math inline">\(1_A\)</span> satisfies our proposition. As the name suggests we want to show that <span class="math inline">\(\mathcal{D}\)</span> is a <span class="math inline">\(d\)</span>-system. If <span class="math inline">\(A \subseteq B\)</span> and <span class="math inline">\(A, B \in \mathcal{D}\)</span> then <span class="math inline">\(1_{B \setminus A} = 1_B - 1_A\)</span> so the proposition will hold for <span class="math inline">\(B \setminus A\)</span> by linearity of the integral. Suppose that <span class="math inline">\(A_1 \subseteq A_2 \subseteq A_3 \dots\)</span> then let <span class="math inline">\(g_n=1_{A_n}\)</span> then <span class="math inline">\(g_n \uparrow 1_A\)</span> = g and <span class="math inline">\(g_n \circ \phi \uparrow g \circ \phi\)</span>, as <span class="math inline">\(\phi\)</span> is increasing so if</p>
<p><span class="math display">\[ \int_{\phi(a)}^{\phi(b)}g_n(y) \mathrm{d}y = \int_a^b g_n(\phi(x)) \phi&#39;(x) \mathrm{d}x \]</span></p>
<p>for each <span class="math inline">\(n\)</span> applying monotone convergence to each side gives the result for <span class="math inline">\(g = 1_A\)</span>. This shows that <span class="math inline">\(\mathcal{D}\)</span> is a <span class="math inline">\(d\)</span>-system. Applying Dynkin’s lemma then shows that for every <span class="math inline">\(A \in \mathcal{B}(R)\)</span> we have that the proposition holds with <span class="math inline">\(g=1_A\)</span>.</p>
<p>Linearity of the integral allows us to extend this result to any simple function <span class="math inline">\(g\)</span>. We can then use monotone convergence in exactly the same way as for the last part to extend it to any non-negative measurable <span class="math inline">\(g\)</span>.</p>
</div>
<div id="agreement-with-riemann-integral" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Agreement with Riemann Integral<a href="integration-1.html#agreement-with-riemann-integral" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We now turn our attention to the case wher <span class="math inline">\(\mu\)</span> is Lebesgue measure, <span class="math inline">\(\lambda\)</span>. We want to show that our new definition of the integral will agree with the Riemann integral when they are both defined. Let us first recall the definitions associated with the Riemann integral.</p>
<div class="definition">
<p><span id="def:unlabeled-div-141" class="definition"><strong>Definition 5.6  </strong></span>Let <span class="math inline">\([a,b]\)</span> be an interval in <span class="math inline">\(\mathbb{R}\)</span> then a finite sequence of real numbers <span class="math inline">\(\{a_k\}_{k=0}^n\)</span> is called a <em>partition</em> of the interval if <span class="math inline">\(a=a_0 &lt; a_1 &lt; \dots&lt;a_n=b\)</span>. I usually denote a partition with a lower case <span class="math inline">\(p\)</span> or <span class="math inline">\(q\)</span>. You also often see the notation <span class="math inline">\(\mathscr{P}\)</span>.</p>
</div>
<div class="definition">
<p><span id="def:unlabeled-div-142" class="definition"><strong>Definition 5.7  </strong></span>If we have two partitions <span class="math inline">\(p = \{a_k\}_{k=0}^n\)</span> and <span class="math inline">\(q=\{b_j\}_{j=0}^m\)</span> then we say <span class="math inline">\(q\)</span> is a <em>refinement</em> of <span class="math inline">\(p\)</span> if every element of <span class="math inline">\(p\)</span> appears in <span class="math inline">\(q\)</span>.</p>
</div>
<div class="definition">
<p><span id="def:unlabeled-div-143" class="definition"><strong>Definition 5.8  </strong></span>We call a sequence of partitions <span class="math inline">\((p_n)_{n \geq 1}\)</span> <em>nested</em> if for every <span class="math inline">\(n\)</span> we have that <span class="math inline">\(p_{n+1}\)</span> is a refinement of <span class="math inline">\(p_n\)</span>.</p>
</div>
<div class="definition">
<p><span id="def:unlabeled-div-144" class="definition"><strong>Definition 5.9  </strong></span>If we have a partition <span class="math inline">\(p = \{a_k\}_{k=0}^n\)</span> and a function <span class="math inline">\(f\)</span> then we can define</p>
<p><span class="math display">\[ m_k = \inf \{ f(x) \,:\, x \in [a_{k-1},a_k] \} \quad \mbox{and}\quad M_k = \sup\{ f(x)\,:\, x \in [a_{k-1},a_k]\}. \]</span></p>
<p>Then we have the upper sum and lower sum associated to the partition which are defined as</p>
<p><span class="math display">\[ l(f,p) = \sum_{k=1}^n m_k(a_k-a_{k-1}), \quad u(f,p) = \sum_{k=1}^n M_k (a_k-a_{k-1}). \]</span></p>
</div>
<div class="remark">
<p><span id="unlabeled-div-145" class="remark"><em>Remark</em>. </span>We can check that if <span class="math inline">\(q\)</span> is a refinement of <span class="math inline">\(p\)</span> then</p>
<p><span class="math display">\[ l(f,p) \leq l(f,q) \leq u(f,q) \leq u(f,p). \]</span></p>
</div>
<div class="definition">
<p><span id="def:unlabeled-div-146" class="definition"><strong>Definition 5.10  </strong></span>We call a function <span class="math inline">\(f\)</span>, <em>Riemann integrable</em> on <span class="math inline">\([a,b]\)</span> if <span class="math inline">\(\sup_p l(f,p) = \inf_q u(f,q)\)</span>.</p>
</div>
<div class="lemma">
<p><span id="lem:unlabeled-div-147" class="lemma"><strong>Lemma 5.5  </strong></span>A function, <span class="math inline">\(f\)</span>, is Riemann integrable if and only if there exists a partition <span class="math inline">\(p\)</span> such that</p>
<p><span class="math display">\[ u(f,p) - l(f,p) &lt; \epsilon. \]</span></p>
</div>
<div class="proof">
<p><span id="unlabeled-div-148" class="proof"><em>Proof</em>. </span>First suppose that <span class="math inline">\(f\)</span> satisfies that for every <span class="math inline">\(\epsilon\)</span> there exists a <span class="math inline">\(p\)</span> such that <span class="math inline">\(u(f,p)-l(f,p) &lt; \epsilon\)</span> then</p>
<p><span class="math display">\[ \inf_q u(f,q) - \sup_q l(f,q) \leq u(f,p)-l(f,p) &lt; \epsilon. \]</span></p>
<p>Since, <span class="math inline">\(\epsilon\)</span> is arbitrary this implies</p>
<p><span class="math display">\[ \inf_q u(f,q) = \sup_q l(f,q) \]</span></p>
<p>and therefore <span class="math inline">\(f\)</span> is Riemann integrable.</p>
<p>Suppose that <span class="math inline">\(f\)</span> is Riemann integrable then we know that <span class="math inline">\(\inf_q u(f,q) = \sup_q l(f,q) = \int f \mathrm{d}x\)</span>. Therefore, given <span class="math inline">\(\epsilon\)</span> there exists <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span> so that <span class="math inline">\(u(f,p_1) \leq \int f \mathrm{d}x + \epsilon/2\)</span> and <span class="math inline">\(l(f,p_2) \geq \int f \mathrm{d}x - \epsilon/2\)</span>. Now let <span class="math inline">\(p = p_1 \cup p_2\)</span>, that is to say the partition made up of all the point in both <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span>. In this case <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span> are both refinements of <span class="math inline">\(p\)</span>, so we have</p>
<p><span class="math display">\[ \int f \mathrm{d}x - \epsilon/2 \leq l(f,p_2) \leq l(f,p) \leq u(f,p) \leq u(f,p_1) \leq \int f \mathrm{d}x + \epsilon/2, \]</span></p>
<p>so</p>
<p><span class="math display">\[ u(f,p)-l(f,p) &lt; \epsilon. \]</span></p>
</div>
<p>We need a final Lemma before we prove our theorem</p>
<div class="lemma">
<p><span id="lem:unlabeled-div-149" class="lemma"><strong>Lemma 5.6  </strong></span>Suppose that <span class="math inline">\(f: \mathbb{R} \rightarrow \mathbb{R}\)</span> is Lebesgue measurable and <span class="math inline">\(g = f\)</span> Lebesgue almost everywhere then <span class="math inline">\(g\)</span> is also Lebesgue measurable.</p>
</div>
<div class="proof">
<p><span id="unlabeled-div-150" class="proof"><em>Proof</em>. </span>Take any Lebesgue measurable set <span class="math inline">\(B\)</span> and look at <span class="math inline">\(g^{-1}(B)\)</span> we have that <span class="math inline">\(g^{-1}(B) = (f^{-1}(B) \cup \{ x\,:\, g(x) \in B, f(x) \notin B\}) \setminus \{ x \, :\, g(x) \notin B, f(x) \in B\}\)</span>. Now write <span class="math inline">\(N = \{ x \,:\, f(x) \neq g(x)\}\)</span>, by definition <span class="math inline">\(\lambda(N) = 0\)</span>. We also have that <span class="math inline">\(\{ x \,:\, g(x) \in B, f(x) \notin B\} \subseteq N\)</span> and <span class="math inline">\(\{x\,:\, g(x) \notin B, f(x) \in B\} \subseteq N\)</span> so they are both null sets and therefore Lebesgue measurable. As <span class="math inline">\(f\)</span> is Lebesgue measurable <span class="math inline">\(f^{-1}(B)\)</span> is Lebesgue measurable. Since <span class="math inline">\(\mathscr{M}\)</span> is a <span class="math inline">\(\sigma\)</span>-algebra this implies that <span class="math inline">\((f^{-1}(B) \cup \{ x\,:\, g(x) \in B, f(x) \notin B\}) \setminus \{ x \, :\, g(x) \notin B, f(x) \in B\}\)</span> is Lebesgue measurable. Therefore <span class="math inline">\(g\)</span> is Lebesgue measurable.</p>
</div>
<div class="theorem">
<p><span id="thm:unlabeled-div-151" class="theorem"><strong>Theorem 5.6  </strong></span>Let <span class="math inline">\([a,b]\)</span> be an interval. Suppose that <span class="math inline">\(f\)</span> is a function which is Riemann integrable on <span class="math inline">\([a,b]\)</span>, then it is Lebesgue integrable and the Riemann integral agrees with the Lebesgue integral.</p>
</div>
<div class="proof">
<p><span id="unlabeled-div-152" class="proof"><em>Proof</em>. </span>Note first that all Riemann integrable functions are bounded. As <span class="math inline">\(f\)</span> is bounded we only need to show that it is Lebesgue measurable in order for it to be integrable.
Using the lemma above there exists a nested sequence of partitions <span class="math inline">\(p_n\)</span> such that <span class="math inline">\(u(f,p_n) - l(f,p_n) &lt; 1/n\)</span> for each <span class="math inline">\(n\)</span>. Let us define two sequences of functions <span class="math inline">\(g_n\)</span> and <span class="math inline">\(h_n\)</span>. We write <span class="math inline">\(p_n = \{ a^n_k \}_{k=0}^{N_n}\)</span>, and recall the definition of <span class="math inline">\(m^n_k\)</span> and <span class="math inline">\(M^n_k\)</span> associated to the partition. Then we define</p>
<p><span class="math display">\[ g_n:= \sum_{k=1}^{N_n} m^n_k 1_{[a_{k-1}^n, a_k^n)}, \quad h_n :=\sum_{k=1}^{N_n} M^n_k 1_{[a_{k-1}^n, a_k^n)}.\]</span></p>
<p>Here we can see that <span class="math inline">\(g_n\)</span> and <span class="math inline">\(h_n\)</span> are both sequences of simple functions. We also have that <span class="math inline">\(g_n\)</span> is a monotonically increasing sequence and <span class="math inline">\(h_n\)</span> is a monotonically decreasing sequence. As <span class="math inline">\(f\)</span> is bounded so are the sequences <span class="math inline">\(g_n(x)\)</span> and <span class="math inline">\(h_n(x)\)</span> for each <span class="math inline">\(x\)</span> so we define <span class="math inline">\(g(x) = \lim_n g_n(x)\)</span> and <span class="math inline">\(h(x) = \lim_n h_n(x)\)</span>, these are both bounded, Borel measurable functions. We also have that <span class="math inline">\(g_n(x) \leq f(x) \leq h_n(x) \leq \sup_{[a,b]} f\)</span> so consequently <span class="math inline">\(g(x) \leq f(x) \leq h(x)\)</span>. We can see that <span class="math inline">\(\lambda(g_n) = l(f,p_n)\)</span> and <span class="math inline">\(\lambda(h_n) = u(f,p_n)\)</span>. We can use <span class="math inline">\(\sup_{[a,b]}f\)</span> as a dominating function, so we have by dominated convergence that</p>
<p><span class="math display">\[ \lambda (g) = \lim_n \lambda(g_n) = \lim_n l(f,p_n) = \lim_n u(f,p_n) = \lim_n \lambda(h_n) = \lambda(h). \]</span></p>
<p>We also have that <span class="math inline">\(h-g \geq 0\)</span> and <span class="math inline">\(\lambda(h-g) = 0\)</span> so we know that <span class="math inline">\(h=g\)</span> Lebesgue almost everywhere and as <span class="math inline">\(h-f \leq h-g\)</span> we know that <span class="math inline">\(f=h=g\)</span> almost everywhere. Therefore, <span class="math inline">\(f\)</span> is almost everywhere equal to a measurable function and it is bounded so is Lebesgue integrable</p>
</div>
<p>We finish this section with some examples of functions which are Lebesgue integrable but are not Riemann integrable. The most classic example of this is</p>
<div class="example">
<p><span id="exm:unlabeled-div-153" class="example"><strong>Example 5.1  </strong></span>Let <span class="math inline">\(f(x) = 1_\mathbb{Q}\)</span> then <span class="math inline">\(f\)</span> is Lebesgue integrable but not Riemann integrable on <span class="math inline">\([0,1]\)</span> (or any other interval). In order to see that this function is not Riemann integrable we can see that for any partition <span class="math inline">\(p\)</span> as the rationals an the irrationals are dense in <span class="math inline">\([0,1]\)</span> then <span class="math inline">\(l(f,p) =0\)</span> and <span class="math inline">\(u(f,p) =1\)</span> therefore if we take a seqence of nested partitions <span class="math inline">\(p_n\)</span> then we wont have the limits of <span class="math inline">\(l(f,p_n)\)</span> and <span class="math inline">\(u(f,p_n)\)</span> meeting.</p>
</div>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="mesurable-funtions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="norms-and-inequalities.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/05-integration.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
