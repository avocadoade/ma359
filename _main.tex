% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{book}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{amsfonts}
\usepackage{mathrsfs}
\usepackage{amsthm}
\usepackage{fullpage}
\usepackage{amssymb}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage[]{natbib}
\bibliographystyle{plainnat}
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={Measure theory lecture notes},
  pdfauthor={Jo Evans},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Measure theory lecture notes}
\author{Jo Evans}
\date{2023-09-26}

\usepackage{amsthm}
\newtheorem{theorem}{Theorem}[chapter]
\newtheorem{lemma}{Lemma}[chapter]
\newtheorem{corollary}{Corollary}[chapter]
\newtheorem{proposition}{Proposition}[chapter]
\newtheorem{conjecture}{Conjecture}[chapter]
\theoremstyle{definition}
\newtheorem{definition}{Definition}[chapter]
\theoremstyle{definition}
\newtheorem{example}{Example}[chapter]
\theoremstyle{definition}
\newtheorem{exercise}{Exercise}[chapter]
\theoremstyle{definition}
\newtheorem{hypothesis}{Hypothesis}[chapter]
\theoremstyle{remark}
\newtheorem*{remark}{Remark}
\newtheorem*{solution}{Solution}
\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\hypertarget{about}{%
\chapter*{About}\label{about}}
\addcontentsline{toc}{chapter}{About}

These are the lecture notes for the Warwick maths course MA359: Measure theory. They will be updated as the course goes along. Please send me any typos or questions you find! Email me at \href{mailto:name.surname@warwick.ac.uk}{\nolinkurl{name.surname@warwick.ac.uk}}

\hypertarget{introduction}{%
\chapter{Introduction}\label{introduction}}

Welcome to measure theory. This course introduces the modern theory of functions and integration which underpins most advanced analysis topics. In particular the theory of function spaces will be important in PDEs and the notion of measurable functions allows us to rigorously understand random variables.

The key example we will study is \textbf{Lebesgue measure} in \(\mathbb{R}^d\). The goal of defining Lebesgue measure is to find a way of asigning length/area/volume/whatever its called if \(d \geq 4\) to a subset of \(\mathbb{R}^d\). It turns out that it is not possible to do this for every possible subset of \(\mathbb{R}^d\), but it is possible to do this for every subset you are likely to come across!

\hypertarget{integration}{%
\section{Integration}\label{integration}}

One of the most important results of measure theory is the ability to integrate `against' the measures that we define. We want this new definition of the integral to agree with the Riemann integral on subsets of \(\mathbb{R}^d\) and also allow us to integrate over sets that aren't subsets of \(\mathbb{R}^d\) or with different weightings of the different parts of \(\mathbb{R}^d\). This new theory of integration allows us to rigorously define expectation in probability theory and provides numerous convergence theorems which are some of the results you will use most from this course.

\hypertarget{the-most-important-things-you-will-learn-in-this-course}{%
\section{The most important things you will learn in this course}\label{the-most-important-things-you-will-learn-in-this-course}}

For your own knowledge of how measure and function `really' work:

\begin{itemize}
\tightlist
\item
  How Lebesgue measure is constructed.
\item
  How the Lebesgue integral is constructed.
\item
  How product measures/spaces are constructed.
\item
  How \(L^p\) spaces are defined.
\end{itemize}

For use in later courses:

\begin{itemize}
\tightlist
\item
  The fact that Lebesgue measure exists and does what you expect it to do.
\item
  Why you can work with measures just by looking at how they behave on a \(\pi\)-system (find out what that is soon!).
\item
  The different ways in which functions can converge.
\item
  Equivalences between ways things converge.
\item
  Convergence theorems: i.e.~when convergence of functions implies convergence of their integrals (dominated convergence and monotone convergence).
\item
  Important inequalities: Hölder/Cauchy-Schwartz, Minkowski, Jensen.
\item
  When you can switch the order of integration.
\end{itemize}

\hypertarget{sigma-algebras-definition-of-a-measure}{%
\chapter{\texorpdfstring{\(\sigma\)-algebras, definition of a measure}{\textbackslash sigma-algebras, definition of a measure}}\label{sigma-algebras-definition-of-a-measure}}

We are going to begin by learning the basic definitions of measure and the different types of collections of subsets that are important in the theory. While this is fairly dry and unmotivated it is relatively straightforward and provides a good foundation for the rest of the course. You should think about this section like you would think about learning the group axioms before learning any specific use group theory would be put to.

\hypertarget{collections-of-subsets}{%
\section{Collections of subsets}\label{collections-of-subsets}}

We begin with some dry definitions of collections of sets and functions from collections of sets to \(\mathbb{R}\). Measures are objects which measure the size of subsets so you can think of these collections of subsets as collections of things we will measure.

These definitions are similar to the definition of a topology that you've hopefully seen before. In measure theory we are usually not able to work with any subset of our main set, we will have to restrict ourselves to a subcollection of all possible subsets and so we can think of these definitions as providing collections of sets which will be the objects we can measure.

We begin with the most basic definition. An algebra is is collection of sets closed under finite set operations.

\begin{definition}[Algebra]

A collection of subsets of a space \(E\), \(\mathcal{A}\), is called an algebra if

\begin{itemize}
\tightlist
\item
  \(\emptyset \in \mathcal{A}, \, E \in \mathcal{A}\).
\item
  If \(A \in \mathcal{A}\) then \(A^c \in \mathcal{A}\).
\item
  If \(A, B \in \mathcal{A}\) then \(A \cup B \in \mathcal{A}\).
\item
  If \(A, B \in \mathcal{A}\) then \(A \cap B \in \mathcal{A}\).
\end{itemize}

\end{definition}

We next define a \(\sigma\)-algebra. This is the \emph{key} definition of a collection of sets for measure theory. The letter \(\sigma\) here denotes countability. A \(\sigma\)-algebra is a collection of subsets of a space \(E\), which are closed under countable set operations.

\begin{definition}[$\sigma$-algebra]

A collection of subsets of a space \(E\), \(\mathcal{A}\) is a \(\sigma\)-algebra if

\begin{itemize}
\tightlist
\item
  \(\emptyset \in \mathcal{A}, E \in \mathcal{A}\).
\item
  If \(A \in \mathcal{A}\) then \(A^c \in \mathcal{A}\).
\item
  If \(A_1, A_2, \dots\) is a countable collection of sets in \(\mathcal{A}\) then \(\bigcup_{n=1}^\infty A_n \in \mathcal{A}\).
\item
  If \(A_1, A_2, \dots\) is a countable collection of sets in \(\mathcal{A}\) then \(\bigcap_{n=1}^\infty A_n \in \mathcal{A}\).
\end{itemize}

\end{definition}

\begin{lemma}
We can equivalently define a \(\sigma\)-algebra as a collection of sets which is contains \(\emptyset\) and is closed under taking complements and countable unions.

We can think of this as a kind of \emph{motto} for what a \(\sigma\)-algebra is.
\end{lemma}

\begin{proof}
Suppose that \(\mathcal{E}\) is closed under complements and taking countable unions and contains \(\emptyset\), then it is clear that \(E \in \mathcal{E}\). We need to show that if \((A_n)_n\) is a sequence in \(\mathcal{E}\) then \(\bigcap A_n \in \mathcal{E}\). We know that \(\bigcap A_n = \left( \bigcup A_n^c \right)^c\) so this gives our result.
\end{proof}

\begin{example}

In this course we really only deal with one concrete, non-trivial example of a \(\sigma\)-algebra. This is complicated to introduce and we will discuss below.

However, in order to better understand the definition we give a few examples of things which are, and are not \(\sigma\)-algebras.

\begin{itemize}
\tightlist
\item
  The main example is the Borel \(\sigma\)-algebra which we will meet in week 2
\item
  The power set (set of all subsets) of \(E\) is always a \(\sigma\) algebra.
\item
  If \(A \subset E\) then \(\{\emptyset, A, A^c, E\}\) is a \(\sigma\)-algebra.
\item
  The set of all intervals in \(\mathbb{R}\) is not a \(\sigma\)-algebra as it is not closed under taking unions.
\item
  The set of all finite unions of half open intervals of the form\((a,b], a \in \mathbb{R}\cup\{-\infty\}, b \in \mathbb{R}\) or \((a, \infty), a \in \mathbb{R}\cup\{-\infty\}\) is an algebra but not a \(\sigma\)-algebra as it is closed under finite unions but not countable unions (work out why!).
\item
  If \(A, B \neq \phi, E\) and \(A \neq B, B^c\) then any \(\sigma\)-algebra containing \(A\) and \(B\) must contain \(\phi, E, A, B, A^c, B^c, A\cup B, A\cap B, A^c \cup B^c, A^c \cap B^c, A^c \cup B, A^c \cap B, A \cup B^c, A \cap B^c\). This is the smallest \(\sigma\)-algebra that contains \(A\) and \(B\).
\end{itemize}

\end{example}

We now collect some results and further definitions about \(\sigma\)-algebras. The most important is the idea of a \(\sigma\)-algebra being generated by a smaller set.

\begin{lemma}
Suppose \(E\) is a space and \(\mathcal{C}\) is a collection of \(\sigma\) algebras possibly uncountable. Then \(\bigcap_{\mathcal{A} \in \mathcal{C}} \mathcal{A}\) is also a \(\sigma\)-algebra.
\end{lemma}

\begin{proof}
It is straightforward to check that every part of the definition of a \(\sigma\)-algebra holds for the intersection. Just start writing down what the definition would mean.
\end{proof}

\begin{corollary}
For any collection of subsets of a space \(E\), \(\mathcal{F}\) there is a smallest \(\sigma\)-algebra containing \(\mathcal{F}\). We call this \(\sigma(\mathcal{F})\) or the \(\sigma\)-algebra generated by \(\mathcal{F}\).
\end{corollary}

\begin{proof}
There exists at least one \(\sigma\)-algebra containing \(\mathcal{F}\) since the set of all subsets of \(E\) is a \(\sigma\) algebra. Then we can consider the non-empty intersection \(\bigcap_{\mathcal{A} \in \mathcal{C}} \mathcal{A}\) where \(\mathcal{C}\) is the collection of all \(\sigma\)-algebras which contain \(\mathcal{F}\). We call this resulting \(\sigma\)- algebra the \(\sigma\)-\emph{algebra generated by} \(\mathcal{F}\).
\end{proof}

Let us now move on to one of the most important types of \(\sigma\)-algebra that we will consider. This is the \emph{important} \(\sigma\)-algebra mentioned above.

\begin{example}[Key example: Borel $\sigma$-algebra]
If \(E\) is a topological space and \(\mathcal{O}\) the family of open sets in \(E\), then we write \(\mathcal{B}(E)\) to be the \(\sigma\)-algebra generated by \(\mathcal{O}\). This is called the Borel \(\sigma\)-algebra.
\end{example}

We are most interested in \(\mathcal{B}(\mathbb{R}^d)\). We have the following result

\begin{lemma}

\(\mathcal{B}(\mathbb{R})\) is generated (recall this means the smallest \(\sigma\)-algebra containing this collection of subsets) by the following collections of subsets.

\begin{itemize}
\tightlist
\item
  The collection of closed sets in \(\mathbb{R}\).
\item
  The collection of intervals of the form \((-\infty, b]\).
\item
  The collection of intervals of the form \((a,b]\).
\item
  The collection of open intervals of the form \((a,b)\).
\end{itemize}

\end{lemma}

\begin{proof}
Let us call \(\mathcal{B}_1, \mathcal{B}_2, \mathcal{B}_3, \mathcal{B}_4\) to be the \(\sigma\)-algebras generated by the sets above. We then want to show that \(\mathcal{B}(\mathbb{R}) \supseteq \mathcal{B}_1 \supseteq \mathcal{B}_2 \supseteq \mathcal{B}_3\).

As \(\mathcal{B}(\mathbb{R})\) contains all the open sets, it also contains all the closed sets (whose complements are open). Therefore, it also contains \(\mathcal{B}_1\).

As \(\mathcal{B}_1\) contains all the closed sets, and all the intervals \((-\infty, b]\) are closed then \(\mathcal{B}_1\) contains the \(\sigma\)-algebra generated by these sets, namely \(\mathcal{B}_2\).

As \(\mathcal{B}_2\) contains \((-\infty, b]\) and \((-\infty, a]\) and is closed under complements it also contains, \((-\infty, b]\) and \((a, \infty)\). As \(\mathcal{B}_2\) is closed under intersection, this means it also contains \((a,b]\). This is true for all \(a<b\) so \(\mathcal{B}_2\) contains all sets of this form. Consequently, it contains \(\mathcal{B}_3\).

Now we can see that \(\mathcal{B}_3\) contains \(\bigcup_n (a,b-1/n] = (a,b)\) for every \((a,b)\) therefore \(\mathcal{B}_3\) contains \(\mathcal{B}_4\).

Now we want to show that \(\mathcal{B}(\mathbb{R}) \subseteq \mathcal{B}_4\). This will conclude the proof. We need to show that any open set in \(\mathbb{R}\) is a countable union of open intervals. Let \(U\) be such an open set then let
\[ O = \bigcup_{q \in \mathbb{Q} \cap U} \bigcup_{r \in \mathbb{Q} \, \mbox{s.t} \, (q-r,q+r) \subseteq U} (q-r,q+r). \] Then since \(O\) is a union of subsets of \(U\) then \(O \subseteq U\). Suppose that \(x \in U\) then there exists some \(\rho\) such that \((x-\rho, x+\rho) \subseteq U\). There is some rationals \(q,r\) such that \(x \in (q-r,q+r) \subseteq (x-\rho,x+\rho)\) therefore \(x \in O\). Consequently \(U= O\).
\end{proof}

\begin{remark}
It is worth noting that \(\mathcal{B}(\mathbb{R})\) is very big and contains many more sets than just open sets and closed sets. It is in fact very difficult to come up with a set which isn't a Borel set. We can think of all the sets in the Borel \(\sigma\)-algebra in a hierarhcy: open sets, countable intersections of open sets, countable unions of countable intersections of open sets, countable intersections of countable unions of open sets \ldots{} and so on. It is never the case that you can't generate more new sets by finding countable intersection or countable unions of sets from the previous set in the hierarchy.
\end{remark}

We have two further definitions of collections of sets which will be useful. These separate the two parts of the definition of a \(\sigma\)-algebra.

Rather than thinking of these as a collection of subsets that we can measure or pay attention to these definitions will typically appear inside proofs.

\begin{definition}[$\pi$-system]

A collection of subsets of \(E\), \(\mathcal{A}\) is a \(\pi\)-system if

\begin{itemize}
\tightlist
\item
  \(\emptyset \in \mathcal{A}\)
\item
  If \(A, B \in \mathcal{A}\) then \(A \cap B \in \mathcal{A}\).
\end{itemize}

\end{definition}

\begin{definition}[$D$-system]

A collection of subsets of \(E, \mathcal{A}\) is a \(d\)-system if

\begin{itemize}
\tightlist
\item
  \(E \in \mathcal{A}\).
\item
  If \(A, B \in \mathcal{A}\) with \(A \subset B\) then \(B \setminus A \in \mathcal{A}\).
\item
  If \(A_1 \subset A_2 \subset A_3 \subset \dots\) then \(\bigcup_{n=1}^\infty A_n \in \mathcal{A}\).
\end{itemize}

\end{definition}

\begin{lemma}[Dynkin's $\pi$-system lemma]
Let \(\mathcal{A}\) be a \(\pi\)-system. Then any \(d\)-system containing \(\mathcal{A}\) also contains the \(\sigma\)-algebra generated by \(\mathcal{A}\).
\end{lemma}

\begin{proof}
This is an exercise.
\end{proof}

\hypertarget{set-functions}{%
\section{Set functions}\label{set-functions}}

We are now able to introduce the next important set of objects we will be studying in the course. These are measures. We can think of these as measuring the size of different sets.

\begin{definition}[Set function]
A set function \(\phi\) is a function from a family of subsets of a space \(E\), \(\mathcal{A}\) to \(\mathbb{R}\cup\{\infty\}\).
\end{definition}

\begin{definition}[Measure]
A measure is a specific type of set function which satisfies certain axioms. A set function \(\mu\) defined from a \(\sigma\)-algebra \(\mathcal{A}\) is a measure if,

\begin{itemize}
\tightlist
\item
  \(\mu(A) \geq 0\) for every \(A \in \mathcal{A}\).
\item
  \(\mu(\emptyset) = 0\)
\item
  If \(A_1, A_2, A_3, \dots\) are all pairwise disjoint and in \(\mathcal{A}\) then
\end{itemize}

\[\mu \left( \bigcup_n A_n \right) = \sum_n \mu(A_n).\]

We call this last property \emph{countable additivity}. Note that the domain of a measure \emph{must be} a \(\sigma\)-algebra.
\end{definition}

\begin{example}[Delta (function)]
You've probably seen \(\delta_{x_0}(x)\) used before; it is similar to the Kroeneker delta which appears in discrete spaces \(\delta_{x,y} = 1\) if and only if \(x=y\). This is the `function' defined by \(\int \delta_{x_0}(x)f(x) \mathrm{d}x = f(x_0)\). We can define a measure on \(\mathbb{R}^d\) which will have this property by

\[\delta_{x_0}(A) = \left\{ \begin{array}{l l} 1 & x_0 \in A \\ 0 & x_0 \notin A \end{array} \right.\]
\end{example}

\begin{example}[Countable spaces]
If \(E = \{ x_1, x_2, \dots\}\) is a countable space and \(F: E \rightarrow \mathbb{R}_{\geq 0}\) is a non-negative function then we can define a measure by \(\mu(A) = \sum_n F(x_n)1_{x_n \in A}\). In fact any measure on a countable set can be written this way by choosing \(F(x_n) = \mu(\{x_n\})\).
\end{example}

\begin{example}[Function (informally)]
In the course we will define this rigorously later. However we can define a measure on \(\mathbb{R}^d\) by integrating a function over subsets of \(\mathbb{R}^d\). If \(f\) is a non-negative function then we define \(\mu_f(A) = \int_A f(x) \mathrm{d}x\).
\end{example}

We also define two further possible properties of set functions

\begin{definition}[monotonicity]
A set function \(\phi\) is monotone if whenever \(A \subseteq B\) we have \(\phi(A) \leq \phi(B)\).
\end{definition}

\begin{definition}[Countable subadditivity]
A set function \(\phi\) is countably subadditive if for every sequence of sets \(A_1, A_2, A_3, \dots\) we have

\[ \phi \left( \bigcup_n A_n \right) \leq \sum_n \phi(A_n). \]
\end{definition}

\begin{lemma}
If \(\mu\) is a measure the \(\mu\) is both monotone and countably subadditive.
\end{lemma}

\begin{proof}
Suppose \(A \subseteq B\) then \(B = A \cup (B \setminus A)\) and this union is disjoint. Countable additivity then implies that \(\mu(B) = \mu(A) + \mu(B \setminus A)\) and since \(\mu(B \setminus A) \geq 0\) we have \(\mu(A) \leq \mu(B)\).

Now take a sequence \(A_1, A_2, A_3, \dots\) and define \(B_n = A_n \setminus \left(A_n \cap \bigcup_{k=1}^{n-1}A_k \right)\) then the \(B_n\) form a disjoint sequence with \(\bigcup_n A_n = \bigcup_n B_n\). We also have, for every \(n\), that \(B_n \subseteq A_n\) so by monotonicity \(\mu(B_n) \leq \mu(A_n)\). Then using countable additivity on the union of the \(B_n\) we have
\[ \mu(\bigcup_n A_n) = \mu(\bigcup_n B_n) = \sum_n \mu(B_n) \leq \sum_n \mu(A_n). \]
\end{proof}

\hypertarget{measure-spaces}{%
\section{Measure spaces}\label{measure-spaces}}

We have seen that in order to define a measure you need to start with a \(\sigma\)-algebra. Normally we consider the base space, \(\sigma\)-algebra, and measure all coming together. This forms the fundamental object we study in the first half of the course. You can compare the idea of a measure space to that of a topological space.

\begin{definition}[Measurable space]
We call a pair \((E, \mathcal{A})\) of a space and a \(\sigma\)-algebra, a \emph{measureable space}.
\end{definition}

\begin{definition}[Measure space]
We call a triple \((E, \mathcal{A}, \mu)\) of a space, a \(\sigma\)-algebra and a measure a \emph{measure space}.
\end{definition}

\begin{definition}[Finite measure space]
We call a measure space \((E, \mathcal{A}, \mu)\) \emph{finite} if \(\mu(E) < \infty\).
\end{definition}

Again we have some further definitions for specific properties measure spaces can have. You can explore these definitions a bit more with the exercises.

\begin{definition}[$\sigma$-finite measure space]
We call a measure space, \((E, \mathcal{A}, \mu)\), \(\sigma\)-\emph{finite} if there exists a countable collection \(E_1, E_2, \dots \in \mathcal{A}\) such that
\[ E = \bigcup_n E_n, \]
and

\[ \mu(E_i) < \infty, \, \forall i. \]
\end{definition}

\begin{definition}[Borel measures and Radon measures]
A measure \(\mu\) on a subset of a topological space \(E\) is called a \emph{Borel measure} if it is a measure with respect to the Borel \(\sigma\)-algebra.

A Borel measure is called a \emph{Radon measure} if for every compact set \(K \in \mathcal{B}(E)\) we have that \(\mu(K) < \infty\).
\end{definition}

We can now prove the first theorem in our course. This is known as continuity of measure and it shows that we can approximate the measure of a set by finding a sequence of sets that approach that set.

\begin{theorem}[Continuity of measure]
Let \((E, \mathcal{E}, \mu)\) be a measure space. Suppose that \((A_n)_n\) is a sequence of measurable sets with \(A_1 \subseteq A_2 \subseteq \dots\) and \((B_n)_n\) is a sequence of measurable sets with \(B_1 \supseteq B_2 \supseteq \dots\), and \(\mu(B_1)< \infty\) then we have

\[ \mu\left( \bigcup_n A_n\right) = \lim_n \mu(A_n) \]
and

\[ \mu\left( \bigcap_n B_n \right) = \lim_n \mu(B_n). \]
\end{theorem}

\begin{proof}
Let \(\tilde{A}_n = A_n \setminus A_{n-1}\). We have that \(\bigcup_n A_n = \bigcup_n \tilde{A}_n\). Furthermore, countable additivity gives us that
\[ \mu\left( \bigcup_n \tilde{A}_n \right) = \sum_n \mu(\tilde{A}_n). \] Therefore, we have \(\sum_{n=1}^m \mu(\tilde{A}_n) \rightarrow \mu \left( \bigcup_n A_n \right)\). We also have \(\sum_{n=1}^m \mu(\tilde{A}_n) = \mu \left( \bigcup_{n=1}^m \tilde{A}_n \right) = \mu (A_m)\).

Now we move onto the \(B_n\), let \(C_n = B_1 \setminus B_n\) then the \(C_n\) are an increasing sequence of measurable sets with \(C_n \uparrow B_1 \setminus \bigcap_n B_n\). So by the first part we have \(\mu\left(B_1 \setminus \bigcap_n B_n \right) = \lim_n \mu(C_n)\). Therefore
\[ \mu(B_1) - \mu\left( \bigcap_n B_n \right) = \mu(B_1) - \lim_n \mu(B_n). \] This gives the result as long as \(\mu(B_1) < \infty\). If there exist an \(m\) such that \(\mu(B_m) < \infty\) then we can renumber starting with \(m\) and repeat the argument above.

N.b. the fact that \(\mu(B)< \infty\) implies \(\mu(A)< \infty\) if \(B \subset A\) follows from finite additivity. \(\mu(B) = \mu(A) + \mu(B \setminus A) \geq \mu(A)\).
\end{proof}

\hypertarget{outer-measures-and-lebesgue-measure}{%
\chapter{Outer measures and Lebesgue Measure}\label{outer-measures-and-lebesgue-measure}}

In this section we will define Lebesgue measure which is one of the most fundamental objects in this course. Lebesgue measure is the measure which generalises the notion of length/area/volume to sets where we don't have an existing idea of their length/area/volume.

In order to do this we first define something called Lebesgue outer measure. So we start by finding out what an outer measure is.

\begin{definition}[Outer measure]

We write \(\mathscr{P}(E)\) to be the power set of \(E\), that is to say the set of all subsets of \(E\). An outer measure is a function, \(\nu\), from \(\mathscr{P}(E) \rightarrow \mathbb{R}_+ \cup \{\infty\}\) such that

\begin{itemize}
\tightlist
\item
  \(\nu(\emptyset) =0\),
\item
  If \(A \subseteq B\) then \(\nu (A) \leq \nu(B)\), (this is called \emph{monotonicity})
\item
  If \(A_1, A_2, \dots\) is a sequence of subsets then \(\nu\left( \bigcup_n A_n \right) \leq \sum_n \nu(A_n)\), (this is called \emph{countable subadditivity}).
\end{itemize}

\end{definition}

The key example of an outer measure is \emph{Lebesgue outer measure}, defining this is our first step to defining Lebesgue measure.

WARNING: Throughout this section \(\lambda\) is going to be redefined a few times. Eventually it will be Lebesgue measure. I'll only call something \(\lambda\) if it is consistent with Lebesgue measure and defined on a smaller collection of sets that \(\mathcal{B}(\mathbb{R})\).

\begin{definition}[Lebesgue measure on intervals]
Let us write \(\mathcal{I}\) to be the set of half open intervals. Then we define a set function \(\lambda\) from \(\mathcal{I}\) to \(\mathbb{R}\) by

\[ \lambda \left( (a,b] \right) = b-a.\]
\end{definition}

Using this we can define Lebesgue outer measure.

\begin{definition}[Lebesgue outer measure]
We define Lebesgue outer measure on \(\mathscr{P}(\mathbb{R})\) by

\[\lambda^* (A) = \inf \{ \sum_n\lambda (I_n) \, : \, \mbox{$I_n$ are half open intervals}\, , A \subset \bigcup_n I_n\}. \]
\end{definition}

\begin{proposition}
Lebesgue outer measure is an outer measure and agrees with \(\lambda\) on any half open interval.
\end{proposition}

\begin{proof}
We need to check each part of the definition of outer measure. First the fact that \(\lambda^*(\emptyset) = 0\) follows from the fact that \(\emptyset \in \mathcal{I}\) and \(\lambda(\emptyset) = 0\). Now suppose that \(A_1 \subset A_2\), then any set \(B\) which is a countable union of half open intervals with \(A_2 \subseteq B\) also has \(A_1 \subseteq B\) so

\[ \inf \{ \sum_n\lambda (I_n) \, : \, \mbox{$I_n$ are intervals}\,, A_1 \subset B = \bigcup_n I_n\} \leq \inf \{ \sum_n\lambda (I_n) \, : \, \mbox{$I_n$ are intervals}\,, A_2 \subset B = \bigcup_n I_n\}, \]

as the infimum over a larger set will always be smaller. Now let us turn to the countable subadditivity. Let us take some sequence \(A_1, A_2, \dots\), if \(\sum_n \lambda^*(A_n) = \infty\) then we are done. Therefore we can assume that \(\sum_n \lambda^*(A_n) < \infty\). Now let us fix an arbitrary \(\epsilon>0\). Now by the definition of \(\lambda^*\) for each \(n\) there exists some \(B_n\) such that \(A_n \subseteq B_n\) and \(B_n = \bigcup_k I_{n,k}\) where the \(I_{n,k}\) are half open intervals, and \(\sum_k\lambda(I_{n,k}) \leq \lambda^* (A_n) + \epsilon 2^{-n}\). Then the set \(I = \bigcup_n B_n\) is a countable union of half open intervals and \(\sum_{n,k}\lambda(I_{n,k}) = \sum_n \sum_k\lambda(I_{n,k}) \leq \sum_n \lambda^*(A_n) + \epsilon\). Therefore \(\lambda^*(\bigcup_n A_n) \leq \sum_n \lambda^*(A_n) + \epsilon\).

Lastly if \(A\) is the interval \((a,b]\) then \((a,b] \in \mathcal{I}\) so \(\lambda^*(A) \leq b-a\).

Suppose that \((a,b] \subseteq (c_1,d_1] \cup (c_2, d_2] \cup \dots\). Then we have that for any \(\epsilon, \delta\) that

\[ [a+\epsilon, b-\epsilon] \subseteq (c_1-\delta/2, d_1 + \delta/2) \cup (c_2 - \delta/4, d_2 + \delta/4) \cup \dots (c_k -2^{-k} \delta, d_k + 2^{-k} \delta) \cup \dots.  \]

Then using compactness (which tells us any open cover of a compact set has a finite subcover) there exists some \(n\) such that

\[ [a+\epsilon, b-\epsilon] \subseteq \bigcup_{k=1}^n (c_k -2^{-k}\delta, d_k + 2^{-k} \delta). \]

Now we know about the lengths of finite unions of intervals (Lebesgue measure doesn't wipe out our existing knowledge of length) so we can compare the lengths of the sides to get

\[ b-a - 2\epsilon \leq \sum_{k=1}^n (d_k - c_k + 2^{-k+1} \delta) \leq \sum_{k=1}^\infty (d_k-c_k) + 2 \delta. \]

Both \(\epsilon\) and \(\delta\) are arbitrary so we can let them go to \(0\) and get

\[ b-a \leq \sum_k (d_k - c_k). \]

Now ranging over all possible covering sequences gives

\[ b-a \leq \lambda^*((a,b]). \]

Note: When we are working in \(\mathbb{R}^d\) as in the assignment the terms involving \(\epsilon\) and \(\delta\) will be multiplied by something involving the side lengths of rectangles. In order to run the proof you can say that wlog all the rectangles you are looking at are contained inside some fixed large rectangle. This will allow you to send \(\epsilon\) and \(\delta\) to zero without having to worry.
\end{proof}

We want to turn this outer measure into a true measure. In order to do this we need to restrict \(\lambda^*\) to some subset of \(\mathscr{P}(\mathbb{R})\).

\begin{definition}[Lebesgue Measurable sets]
We call a set \(A \in \mathscr{P}(\mathbb{R})\) is \emph{Lebesgue Measureable} if for any \(B \in \mathscr{P}(\mathbb{R})\) we have

\[ \lambda^*(B) = \lambda^*(A \cap B) + \lambda^*(A^c \cap B). \]
\end{definition}

\begin{proposition}
The collection of Lebesgue measureable sets, \(\mathscr{M}\), is an algebra.
\end{proposition}

\begin{proof}
First let us notice that the definition of a Lebesgue measureable sets is symmetric in \(A\) and \(A^c\), so \(A \in \mathscr{M}\) implies that \(A^c \in \mathscr{M}\).

Secondly we can see that \(\emptyset \in \mathscr{M}\) as \(\lambda^*(A\cap \emptyset) + \lambda^*(A \cap \emptyset^c) = \lambda^*(\emptyset) + \lambda^*(A \cap E) = 0+ \lambda^*(A)\). This also implies via the first point that \(E \in \mathscr{M}\).

We then show that if \(A_1, A_2 \in \mathscr{M}\) then \(A_1 \cup A_2 \in \mathscr{M}\). Using the fact that \(A_1 \in \mathscr{M}\) we have

\begin{align*} \lambda^*(B \cap (A_1 \cup A_2)) &= \lambda^*(B \cap (A_1 \cup A_2) \cap A_1) + \lambda^*(B \cap(A_1 \cup A_2) \cap A_1^c)\\
&= \lambda^* (B \cap A_1)  + \lambda^* (B \cap A_2 \cap A_1^c).  
\end{align*}
We also have the identity \((A_1 \cup A_2)^c = A_1^c \cap A_2^c\) therefore

\[ \lambda^*(B \cap (A_1 \cup A_2)) + \lambda^*(B \cap (A_1 \cup A_2)^c) = \lambda^*(B \cap A_1) + \lambda^* (B \cap A_2 \cap A_1^c) + \lambda^*(B \cap A_1^c \cap A_2^c). \]
Then since \(A_2 \in \mathscr{M}\) we have

\[  \lambda^* (B \cap A_2 \cap A_1^c) + \lambda^*(B \cap A_1^c \cap A_2^c) = \lambda^*(B \cap A_1^c).\]

Therefore,

\[  \lambda^*(B \cap (A_1 \cup A_2)) + \lambda^*(B \cap (A_1 \cup A_2)^c) = \lambda^*(B \cap A_1) + \lambda^*(B \cap A_1^c). \]
Then we use again the fact that \(A_1 \in \mathscr{M}\) to get

\[  \lambda^*(B \cap (A_1 \cup A_2)) + \lambda^*(B \cap (A_1 \cup A_2)^c) =\lambda^*(B). \]

This shows that \(A_1 \cup A_2 \in \mathscr{M}\).
\end{proof}

\begin{proposition}
\(\mathscr{M}\) is a \(\sigma\)-algebra and the restriction of \(\lambda^*\) to \(\mathscr{M}\) is a measure.
\end{proposition}

\begin{proof}
Let us take an infinite sequence of disjoint sets \(A_1, A_2, A_3, \dots\) then we will show

\[ \lambda^*(B) = \sum_{i=1}^n \lambda^* (B \cap A_i) + \lambda^*\left( B \cap \left( \bigcap_{i=1}^n A_i^c \right) \right). \]

We can show this by induction. For the base case it just follows with \(n=1\) from the fact that \(A_1 \in \mathscr{M}\). Then by induction suppose we know that

\[ \lambda^*(B) = \sum_{i=1}^{n-1} \lambda^*(B \cap A_i) + \lambda^*\left( B \cap \left( \bigcap_{i=1}^{n-1} A_i^c \right) \right).  \]

Now since \(A_n \in \mathscr{M}\) we have

\[ \lambda^*\left( B \cap \left( \bigcap_{i=1}^{n-1} A_i^c \right) \right) = \lambda^* \left(B \cap A_n \cap \left( \bigcap_{i=1}^{n-1} A_i^c \right)  \right) + \lambda^* \left( B \cap A_n^c \cap \left( \bigcap_{i=1}^{n-1} A_i^c \right) \right).\]

Now since \(A_n\) is disjoint from \(A_1, \dots, A_{n-1}\) we have that \(A_n \cap \left( \bigcap_{i=1}^{n-1} A_i^c \right) = A_n\) so we have
\[  \lambda^*\left( B \cap \left( \bigcap_{i=1}^{n-1} A_i^c \right) \right) = \lambda^*(B \cap A_n) + \lambda^*\left( B \cap \left( \bigcap_{i=1}^{n} A_i^c \right) \right). \]

This gives our induction step.

By monotonicity of the outer measure this gives that for any \(n\) we have

\[ \lambda^*(B) \geq \sum_{i=1}^n \lambda^*(B \cap A_i) + \lambda^* \left(B \cap \left( \bigcap_{i=1}^\infty A_i^c \right) \right). \]
Consequently we can let \(n\) tend to infinity to get

\[ \lambda^*(B) \geq \sum_{i=1}^\infty \lambda^*(B \cap A_i) +\lambda^* \left(B \cap \left( \bigcap_{i=1}^\infty A_i^c \right) \right). \]
Now we can use the countable subadditivity of \(\lambda^*\) to get

\[ \lambda^*(B) \geq \lambda^*\left( B \cap \left( \bigcup_{i=1}^\infty A_i \right)\right) + \lambda^*\left((B \cap \left( \bigcap_{i=1}^\infty A_i^c \right) \right) = \lambda^* \left( B \cap \left( \bigcup_{i=1}^\infty A_i \right) \right) + \lambda^* \left( B \cap \left( \bigcup_{i=1}^\infty A_i \right)^c \right).\]

Furthermore, the subadditivity of \(\lambda^*\) gives

\[ \lambda^*(B) \leq  \lambda^* \left( B \cap \left( \bigcup_{i=1}^\infty A_i \right) \right) + \lambda^* \left( B \cap \left( \bigcup_{i=1}^\infty A_i \right)^c \right). \]

Therefore,

\[ \lambda^*(B) =  \lambda^* \left( B \cap \left( \bigcup_{i=1}^\infty A_i \right) \right) + \lambda^* \left( B \cap \left( \bigcup_{i=1}^\infty A_i \right)^c \right). \]

This shows that if \((A_n)_{n \geq 1}\) is a sequence of \emph{disjoint} sets in \(\mathscr{M}\) then \(\bigcup_n A_n \in \mathscr{M}\).

Now take a \(\tilde{A}_n\) sequence of sets in \(\mathscr{M}\) which aren't necessarily disjoint. Then define \(A_n = \tilde{A}_n \setminus \left( \tilde{A}_n \cap \bigcup_{k=1}^{n-1} \tilde{A}_k\right)\) then \(\bigcup_n A_n = \bigcup_n \tilde{A}_n\) and the \(A_n\)s are defined to be disjoint. Furthermore, \(A_n \in \mathscr{M}\) because it can be made from the \(\tilde{A}_n\) by finitely many set operations and we showed that \(\mathscr{M}\) is an algebra. Now as all the \(A_n\) are disjoint and in \(\mathscr{M}\) this shows \(\bigcup_n A_n \in \mathscr{M}\). This shows that \(\mathscr{M}\) is closed under countable unions so is a \(\sigma\)-algebra.

We need to show that \(\lambda^*\) is countably additive on \(\mathscr{M}\) so let \(A_1, A_2, \dots\) be a sequence of disjoint subsets in \(\mathscr{M}\). In the proof that \(\mathscr{M}\) is a \(\sigma\)-algebra we showed that

\[ \lambda^*(B) \geq \sum_{i=1}^\infty \lambda^*(B \cap A_i) + \lambda^* \left( B \cap \left( \bigcap_{i=1}^\infty A_i^c \right) \right). \]
Now let us take the particular case where \(B = \bigcup_{i=1}^\infty A_i\) this gives

\[ \lambda^* \left( \bigcup_{i=1}^\infty A_i \right) \geq \sum_{i=1}^n \lambda^*(A_i) + \lambda^* \left(\left( \bigcup_{i=1}^\infty A_i \right) \cap \left( \bigcup_{i=1}^\infty A_i \right)^c \right) = \sum_{i=1}^\infty \lambda^* (A_i). \]
Countable subadditivity gives

\[ \lambda^* \left( \bigcup_{i=1}^\infty A_i \right) \leq \sum_{i=1}^n \lambda^*(A_i),  \]

so consequently

\[ \lambda^* \left( \bigcup_{i=1}^\infty A_i \right) = \sum_{i=1}^n \lambda^*(A_i).  \]
\end{proof}

\begin{remark}
We now call the restriction of \(\lambda^*\) to \(\mathscr{M}\), \(\lambda\) and call it \emph{Lebesgue measure}.
\end{remark}

We now want to know that there are some Lebesgue measurable sets. In order to do this we first show that all the intervals of the form \((-\infty, b]\) are Lebesgue measurable.

\begin{lemma}
The intervals of the form \((-\infty, b]\) are Lebesgue measureable.
\end{lemma}

\begin{proof}
Let \(B\) be a subset of \(\mathbb{R}\) and let \(I_1, I_2, \dots\) be a sequence of half open intervals such that \(B \subseteq I_1 \cup I_2 \cup \dots\). Now let us define the (often empty) intervals \(I^l_i = I_i \cap (-\infty, b]\) and \(I^r_i = I_i \cap (b, \infty)\), these are also half open intervals. We have \(B \cap (-\infty,b] \subseteq \bigcup_n I^l_n\) and \(B \cap (b,\infty) \subseteq \bigcup_n I^r_n\). Therefore we have

\[ \lambda^*(B \cap (-\infty, b]) \leq \sum_n \lambda(I^l_n), \quad \lambda^*(B \cap (b,\infty)) \leq \sum_n \lambda(I^r_n). \]

Using this we have

\[ \lambda^*(B \cap(-\infty,b])) + \lambda^*(B \cap (b,\infty)) \leq \sum_n \lambda(I^l_n) + \sum_n \lambda(I^r_n) = \sum_n \lambda(I_n).\]
We can then take the infimum over all possible sequences of intervals covering \(B\) to get

\[ \lambda^*(B \cap(-\infty,b])) + \lambda^*(B \cap (b,\infty)) \leq \lambda^*(B). \]

Combining this with countable subadditivity gives

\[ \lambda^*(B) = \lambda^*(B \cap(-\infty,b])) + \lambda^*(B \cap (b,\infty)). \]

Therefore, \((-\infty,b]\) is Lebesgue measurable.
\end{proof}

\begin{corollary}
Every set in \(\mathcal{B}(\mathbb{R})\) is Lebesgue measurable.
\end{corollary}

\begin{proof}
The Borel \(\sigma\) algebra is the \(\sigma\) algebra generated by sets of the form \((-\infty, b]\) as shown last week. Therefore, as \(\mathscr{M}\) is a \(\sigma\)-algebra and contains all the intervals of the form \((-\infty, b]\) then it contains the Borel \(\sigma\)-algebra.
\end{proof}

The construction of Lebesgue measure via the outer measure can be generalised via Carathéodory's extension theorem. This theorem is not examinable and won't be lectured. The main objective here is to go over the ideas in the proof of the construction of Lebesgue measure again. Hopefully seeing things in a more abstract form helps draw out the key ideas.

We briefly give the defintion of a ring of subsets. This is different (though a bit similar) to the definition you may have seen in group theory.

\begin{definition}[Ring - NONEXAMINABLE]
A collection of subsets, \(\mathcal{A}\), of a space \(E\) is called a ring if for every \(A,B \in \mathcal{A}\) we have \(A \setminus B \in \mathcal{A}\) and \(A \cup B \in \mathcal{A}\).
\end{definition}

Now we introduce Carathéodory's Extension theorem. We can see that the proof is in many ways very similar to the construction of Lebesgue measure.

\begin{theorem}[Carathéodory's Extension Theorem - NONEXAMINABLE]
Let \(\mathcal{A}\) be a ring of subsets of \(E\), and let \(\mu: \mathcal{A} \rightarrow [0, \infty]\) be a countably additive set function. Then \(\mu\) extends to a measure on \(\sigma(\mathcal{A})\).
\end{theorem}

\begin{proof}
We define the outer measure \(\mu^*\) on \(\mathscr{P}(E)\) by

\[ \mu^*(B) = \inf \left\{ \sum_n \mu(A_n) \,:\, A_n \in \mathcal{A} \forall n, B \subset \bigcup_n A_n \right\}.\]
We have that \(\mu^*(B) = \infty\) if there is not possible sequence of \(A_n\) so that \(B\) is contained in their union. We can see immediately that \(\mu^*(\emptyset) =0\) and \(\mu^*\) is increasing.

As before we define \(\mathscr{M}\) to be the set of \(\mu^*\) measurable sets \(A\) that satisfy, for every \(B \subseteq E\) that

\[ \mu^*(B) = \mu^*(B \cap A) + \mu^*(B \cap A^c).  \]
We want to show that \(\mathscr{M}\) is a \(\sigma\)-algebra and that \(\mu^*\) restricts to a measure on \(\mathscr{M}\).

First we show that \(\mu^*\) is countably subadditive. Suppose that we have a sequence \(B_n\) and want to show that

\[ \mu^*\left( \bigcup_n B_n\right) \leq \sum_n \mu^*(B_n). \]

Let us fix some \(\epsilon >0\) then for each \(n\) there is a sequence \(A_{n,m} \in \mathcal{A}\) such that \(B_n \subset \bigcup_m A_{n,m}\) and \(\sum_m \mu(A_{n,m}) \leq \mu^*(B_n) + \epsilon 2^{-n}\). Then \(\bigcup_n B_n \subset \bigcup_{n,m} A_{n,m}\) and \(\sum_{n,m}\mu(A_{n,m}) \leq \sum_n \mu^*(B_n) + \epsilon\). Therefore \(\mu^* \left( \bigcup_n B_n \right) \leq \sum_n \mu(B_n) + \epsilon\). Since \(\epsilon\) is arbitrary this gives the countable subadditivity.

Now we show that \(\mu^*\) agrees with \(\mu\) on \(\mathcal{A}\). Let us take \(A \in \mathcal{A}\) clearly \(A \subseteq A\) so \(\mu^*(A) \leq \mu(A)\). Now suppose that there is a sequence \(A_n \in \mathcal{A}\) such that \(A \subseteq \bigcup_n A_n\). Then \(A \cap A_n = A \setminus (A \setminus A_n) \in \mathcal{A}\). Therefore we use the countable subadditivity of \(\mu\) on \(\mathcal{A}\) to get

\[ \mu (A) \leq  \sum_n \mu(A_n \cap A) \leq \sum_n \mu(A_n).\]

Taking the infimum over such sequences gives \(\mu(A) \leq \mu^*(A)\). Therefore \(\mu\) and \(\mu^*\) agree on \(\mathcal{A}\).

Now we show that \(\mathscr{M}\) contains \(\mathcal{A}\). That is to say we want to show that if \(A \in \mathcal{A}\) then for every \(B\)

\[ \mu^*(B) = \mu^*(B \cap A) + \mu^*(B \cap A^c). \]
Using subadditivity of \(\mu^*\) we have that \(\mu^*(B) \leq \mu^*(B \cap A) + \mu^*(B \cap A^c)\). Therefore we want to show \(\mu^*(B) \geq \mu^*(B \cap A) + \mu^*(B \cap A^c)\). Let \(A_n\) be a sequence in \(\mathcal{A}\) such that \(\mu^*(B) \geq \sum_n \mu(A_n) - \epsilon, B \subseteq \bigcup_n A_n\), then we already know that \(A \cap A_n\) will be in \(\mathcal{A}\) we also have that \(A^c \cap A_n = A_n \setminus (A \cap A_n) \in \mathcal{A}\). Therefore \(\mu(B \cap A) \leq \sum_n \mu(A_n \cap A)\) and \(\mu(B \cap A^c) \leq \sum_n \mu(A^c \cap A_n)\) and consequently

\[ \mu^*(B \cap A) + \mu^*(B \cap A^c) \leq \sum_n \left( \mu(A_n \cap A) + \mu(A_n \cap A^c) \right) = \sum_n \mu(A_n) \leq \mu^*(B) + \epsilon. \]
As \(\epsilon\) is arbitrary this gives the required result.

The next step is to show that \(\mathscr{M}\) is a \(\sigma\)-algebra. We start with the algebra part. \(E\) and \(\emptyset\) are in \(\mathscr{M}\) as

\[ \mu^*(B) = \mu^*(B \cap E) + \mu^*(B \cap \emptyset), \]

just because \(B \cap E = B\) and \(B \cap \emptyset = \emptyset\) and we know \(\mu^*(\emptyset) =0\). We also can see that

\[ \mu^*(B) = \mu^*(B \cap A) + \mu^*(B \cap A^c) \]

is symmetric in exchanging \(A\) and \(A^c\) so if \(A \in \mathscr{M}\) then so is \(A^c\). Now suppose \(A_1, A_2 \in \mathscr{M}\). We notice that \((A_1 \cap A_2)^c \cap A_1 = (A_1^c \cup A_2^c) \cap A_1 = (A_1^c \cap A_1) \cup (A_2^c \cap A_1) = A_2^c \cap A^1\) and \(A_1^c = A_1^c \cap(A_1 \cap A_2)^c\). Using this and the fact that \(A_1, A_2, A_1^c, A_2^c\) are in \(\mathscr{M}\) we have

\begin{align*}\mbox{Using that} \, A_1 \in \mathscr{M} \quad \mu^*(B) &= \mu^*(B \cap A_1) + \mu^*(B \cap A_1^c)\\
\mbox{Using that}\, A_2 \in \mathscr{M} \quad &= \mu^*(B \cap (A_1 \cap A_2)) + \mu^*(B \cap A_1 \cap A_2^c) + \mu^*(B \cap A_1^c)\\
\mbox{Using our first identity} \quad &= \mu^*(B \cap (A_1 \cap A_2)) + \mu^*(B \cap (A_1 \cap A_2)^c \cap A_1) + \mu^*(B \cap A_1^c)\\
\mbox{Using our second identiy} \quad &= \mu^*(B \cap (A_1 \cap A_2)) + \mu^*(B \cap (A_1 \cap A_2)^c \cap A_1) + \mu^*(B \cap (A_1 \cap A_2)^c \cap A_1^c)\\
\mbox{Using the fact that}\, A_1 \in \mathscr{M} \quad &= \mu^*(B \cap (A_1 \cap A_2)) + \mu^*(B \cap (A_1 \cap A_2)^c).
\end{align*}

Now that we have shown that \(\mathscr{M}\) contains finite unions we want to show it countains countable unions. Let \(A_n\) be a sequence of disjoin sets in \(\mathscr{M}\). Let us write \(A = \bigcup_n A_n\). Then itterating our previous result we have for any \(B, n\) that

\[ \mu^*(B) = \sum_{k=1}^n \mu^*(B \cap A_k) + \mu^*( B \cap A_1^c \cap \dots \cap A_n^c). \]

Now as \(A^c \subseteq A_1^c \cap A_2^c \dots \cap A_n^c\) for each \(n\) we have \(\mu^*(B \cap A^c) \leq \mu^*(B \cap A_1^c \cap \dots \cap A_n^c)\). Therefore for each \(n\)

\[ \mu^*(B) \geq \sum_{k=1}^n \mu^*(B \cap A_k) + \mu^*(B \cap A^c). \]

Letting \(n \rightarrow \infty\) we have

\[ \mu^*(B) \geq \sum_n \mu^*(B \cap A_n) + \mu^*(B \cap A^c). \]

Now we use the countable subadditivity of \(\mu^*\) and the fact that \(B \cap A = \bigcup_n (B \cap A_n)\) to get

\[ \mu^*(B) \geq \mu^*(B \cap A) + \mu^*(B \cap A^c). \]

As the other inequality holds by subadditivity of \(\mu^*\) we have that \(\mu^*(B) = \mu^*(B \cap A) + \mu^*(B \cap A^c)\) and hence \(A \in \mathscr{M}\).

Lastly, we want to show that \(\mu^*\) is a measure on \(\mathscr{M}\). In order to do this we need to show that \(\mu^*\) is countably additive on \(\mathscr{M}\). In the last step we showed that for any \(B\), and a sequence of disjoint sets \(A_n\) in \(\mathscr{M}\) with \(A= \bigcup_n A_n\), that

\[ \mu^*(B) \geq \sum_n \mu^*(A_n \cap B) + \mu^*(B \cap A^c). \]

If we apply this identity with \(B=A\) and use the fact that \(A_n \cap A = A_n\) we get

\[ \mu^*(A) \geq \sum_n \mu^*(A_n). \]

Since we already know that \(\mu^*\) is countably subadditive this is sufficient to show that \(\mu^*\) is countably additive and hence a measure on \(\mathscr{M}\).
\end{proof}

\begin{theorem}[Uniqueness of Extension]
Let \(\mu_1\) and \(\mu_2\) be measures on \((E,\mathcal{E})\) with \(\mu_1(E) = \mu_2(E) < \infty\). Suppose that \(\mu_1 = \mu_2\) on \(\mathcal{A}\) where \(\mathcal{A}\) is a \(\pi\)-system generating \(\mathcal{E}\), then \(\mu_1 = \mu_2\) on \(\mathcal{E}\).
\end{theorem}

\begin{proof}
Let us consider \(\mathcal{D} \subseteq \mathcal{E}\) defined as the measurable sets on which \(\mu_1(A) = \mu_2(A)\). By hypothesis \(E \in \mathcal{D}\) and \(\mathcal{A} \subseteq \mathcal{D}\). We want to show that \(\mathcal{D}\) is a \(\sigma\)-algebra and therefore \(\mathcal{D} = \mathcal{E}\). Suppose that \(A, B \in \mathcal{E}\) with \(A \subseteq B\) then we have \(\mu_i(A) + \mu_i (B \setminus A) = \mu_i(B) < \infty.\) This means that if \(A\) and \(B\) are in \(\mathcal{D}\) then so is \(A \setminus B\). Suppose that \(A_n\) is a sequence of elements in \(\mathcal{D}\) with \(A_1 \subseteq A_2 \subseteq A_3 \dots\) then by continuity of measure \(\mu_1(\bigcup_n A_n) = \lim_n \mu_1(A_n) = \lim_n \mu_2(A_n) = \mu_2(\bigcup_n A_n)\). Therefore \(\bigcup_n A_n \in \mathcal{D}\). Therefore, \(\mathcal{D}\) is a \(d\)-system containing the \(\pi\)-system \(\mathcal{A}\) so by Dynkin's lemma is equal to \(\mathcal{E}\).
\end{proof}

We now want to show that Lebesgue measure is the only which assigns each interval the correct measure.

\begin{proposition}
Lebesgue measure is the only measure on \((\mathbb{R}, \mathcal{B}(\mathbb{R}))\) which assigns each half open interval its length. This is equally true with half open hyper-rectangles in \(\mathbb{R}^d\).
\end{proposition}

\begin{proof}
The collection of half open intervals is a \(\pi\)-system which generates the Borel \(\sigma\)-algebra. Therefore, if \(\lambda(\mathbb{R})\) had been finite we could use Dynkin's uniqueness of extension Lemma to get that any other measure which agrees with Lebesgue measure on the half open intervals must agree with Lebesgue measure on the whole of the Borel \(\sigma\)-algebra. Instead let \(E_n = (-n,n]^d\) then, by Dynkin's uniqueness of extension lemma we have that \(\lambda\) is the only measure on \(E_n\), assigning each rectangle inside \(E_n\) its measure. That is to say if \(\mu\) is another measure on \(\mathbb{R}^d\) which agrees with Lebesgue measure on rectangles then it agrees with Lebesgue measure on every Borel set which is a subset of \(E_n\).

We also have that, for any \(A \in \mathcal{B}(\mathbb{R})\), \(\mu(A) = \lim_n \mu(A \cap E_n)\) by continuity of measure. By the argument above \(\mu(A_n) = \lambda(A_n)\) for each \(n\) as \(A_n \subset E_n\) and is Borel. So \(\mu(A) = \lim_n \mu(A\cap E_n) = \lim_n \lambda(A \cap E_n) = \lambda(A)\).
\end{proof}

\hypertarget{properties-of-lebesgue-measure}{%
\section{Properties of Lebesgue measure}\label{properties-of-lebesgue-measure}}

This collection is a section of facts about Lebesgue measure and the set of Lebesgue measurable sets. We start with looking at \(\mathscr{M}\) the \(\sigma\)-algebra of Lebesgue measurable sets. We call sets with \(\lambda*(A)=0\) null sets.

\begin{lemma}[Null sets are all Lebesgue measurable]
If \(A\) in \(\mathscr{P}(\mathbb{R})\) and \(\lambda^*(A) =0\) then \(A \in \mathscr{M}\).
\end{lemma}

\begin{proof}
This is on the week 2 exercise sheet.
\end{proof}

The most important thing we want to prove about \(\mathscr{M}\) is that there exists a non-Lebesgue measurable set. Before we do this we need to explore a few more properties of Lebesgue measure itself.

\begin{proposition}

Lebesgue measure is \emph{regular} that is to say

\begin{itemize}
\tightlist
\item
  \[\lambda(A) = \inf \{ \lambda(U)\,:\, \mbox{U is open}, A \subseteq U\},\]
\item
  \[\lambda(A) = \sup \{ \lambda(K)\,:\, \mbox{K is compact}, K \subseteq A\}.\]
\end{itemize}

\end{proposition}

\begin{proof}
By monotonicity we can see that \[\lambda(A) \leq \inf \{ \lambda(U)\,:\, \mbox{U is open}, A \subseteq U\}.\]
Furthermore we can find a sequence of half open rectangles \(R_k\) such that \(A \subseteq \bigcup_n R_n\) and \(\sum_n \lambda(R_n) \leq \lambda(A) + \epsilon\). By slightly enlarging each of the half open rectangles we can produce another sequence of fully open rectangles \(\tilde{R}_n\) such that \(A \subseteq \bigcup_n \tilde{R}_n\) and \(\lambda(A) \geq \sum_n \lambda(\tilde{R}_n)-2\epsilon\). The set, \(\bigcup_n \tilde{R}_n\) is open and \(\epsilon\) can be made arbitrarily small so this shows \[\lambda(A) \geq \inf \{ \lambda(U)\,:\, \mbox{U is open}, A \subseteq U\}.\]

Monotonicity shows that \[\lambda(A) \geq \sup \{ \lambda(K)\,:\, \mbox{K is compact}, K \subseteq A\}.\] First let us assume that \(A\) is contained in some ball, \(B\) around 0. Now use the first part to find some open set \(U\) such that \(B \setminus A \subseteq U\) and \(\lambda(U) \leq \lambda(B \setminus A) + \epsilon\). Now let \(K = B \setminus U\) then we have \(K \subseteq A \subseteq B\) and \(\lambda(K) \geq \lambda(B) - \lambda(U) \geq \lambda(B) - \lambda(B \setminus A) - \epsilon = \lambda(A) - \epsilon\) (here we use the fact that \(B, A, U, K\) will all have finite measure as they are inside \(B\)). As \(\epsilon\) is arbitrary this concludes the proof when \(A\) is contained in a ball.

Now suppose that \(A\) is unbounded. Then let \(A_n = A \cap B_n\) where \(B_n\) is the closed ball of radius \(n\). We have that \(\lambda(A_n) \rightarrow \lambda(A)\). If \(\lambda(A) = \infty\) then we can find \(K_n \subseteq A_n\) with \(\lambda(K_n)\) arbitrarily close to \(\lambda(A_n)\) therefore we can find such a sequence with \(\lambda(K_n) \rightarrow \infty\). If \(\lambda(A) \neq \infty\) then, given \(\epsilon\), there exists \(N\) such that \(\lambda(A_n) \geq \lambda(A)-\epsilon\) for \(n \geq N\). Then we can find \(K_N \subseteq A_N\) such that \(\lambda(K_n) \geq \lambda(A_N) - \epsilon\) therefore \(\lambda(K_N) \geq \lambda(A)- 2 \epsilon\). This shows we can a compact set which is contained in \(A\), with measure arbitrarily close to that of \(A\).
\end{proof}

We now want to recall that Lebesgue measure is the unique measure which assigns half open intervals (rectangles\ldots) the correct length.

\begin{corollary}
Lebesgue measure is translation invariant on \(\mathbb{R}\). That is to say if we define the set \(x+A = \{ x+y, y \in A\}\) then \(\lambda(x+A) = \lambda(A)\)
\end{corollary}

\begin{proof}
Define a new measure \(\lambda_x\) by \(\lambda_x(A) = \lambda(x+A)\) then \(\lambda_x((a,b]) = \lambda((a+x,b+x]) = b+x -(a+x) = b-a\). Therefore \(\lambda_x\) agrees with \(\lambda\) on the half open intervals and therefore agrees with \(\lambda\) on the whole of \(\mathcal{B}(\mathbb{R})\). Again it is straightforward to extend this to \(\mathbb{R}^d\).
\end{proof}

Now we can use regularity of Lebesgue measure in order to characterise the sets in \(\mathscr{M}\) (we can also do this in other ways as seen on the exercise sheet).

\begin{proposition}
If \(A\) is in \(\mathscr{M}\) then there exists \(B \in \mathcal{B}(\mathbb{R})\) and \(N\) a null set such that \(A= B \cup N\) and this is a disjoint union.
\end{proposition}

\begin{proof}
Suppose first that \(\lambda(A)< \infty\) by the second part of the regularity of Lebesgue measure result we have that
\[\lambda(A) = \sup\{ \lambda(K) \,:\, \mbox{K compact}, K \subseteq A\}. \]
Therfore for each \(n\) we can find \(K_n\) such that \(K_n \subseteq A\), \(K_n\) is compact and \(\lambda(K_n) \geq \lambda(A)-1/n\). Then let \(B = \bigcup_n K_n\).

Then as each \(K_n\) is compact it is a Borel set and so \(B\) is a countable union of Borel sets so also a Borel set. We also have \(B \subseteq A\) so \(\lambda(B) \leq \lambda(A)\) and \(K_n \subseteq B\) so \(\lambda(B)\geq \lambda(K_n) \geq \lambda(A)-1/n\) for each \(n\). Therefore \(\lambda(B) = \lambda(A)\). Now let \(N= A \setminus B\) then \(\lambda(N) = \lambda(A) - \lambda(B)=0\) so \(N\) is a null set. This gives our result for \(\lambda(A) < \infty\).

If \(\lambda(A) = \infty\) then split \(\mathbb{R}\) into a countable union of sets with finite Lebesgue measure \(E_n\) for example \(E_n = [n, n+1)\cup [-n-1,-n)\). Then set \(A_n = A \cap E_n\). Then \(\lambda(A_n) < \infty\) so there exists a Borel set \(B_n\) and a null set \(N_n\) such that \(A_n = B_n \cup N_n\) and these sets are disjoint. Now set \(B = \bigcup_n B_n\) and \(N = \bigcup_n N_n\). \(B\) is a Borel set as it's the countable union of Borel sets. \(\lambda(N) = \sum_n \lambda(N_n) = 0\) so \(N\) is a null set. Lastly \(B\) and \(N\) are disjoint as all the \(E_n\) are disjoint so we can't have that \(B_n\) has points in common with \(N_{n'}\) for \(n \neq n'\) as they will be in different \(E_n\). Therefore we can write \(A\) as \(B \cup N\) with this being a disjoint union.
\end{proof}

We can use this to show that \(\lambda\) is translation invariant on \(\mathscr{M}\) not just on \(\mathcal{B}(\mathbb{R}^d)\) to do this we need to show that the translation of a null set is also null.

\begin{lemma}
If \(N\) is a null set then \(x+N = \{ x+y \,:\, y \in N\}\) is also null
\end{lemma}

\begin{proof}
We know that \(0 = \lambda^*(N) = \inf_{(I_n)_n \in \mathcal{C}(N)}\sum_n \lambda(I_n)\) so for a given \(\epsilon > 0\) we can find a sequence \((I_n)_n\) such that \(N \subseteq \bigcup_n I_n\) and \(\sum_n \lambda(I_n) \leq \epsilon\). Now if we shift everything we can see that \(x+ I_n\) is still a half open interval for each \(n\) and \(x+N \subseteq \bigcup_n (x+I_n)\) so \(\lambda^*(x+N) \leq \sum_n \lambda(x+I_n)\) and \(\lambda(x+ I_n) = \lambda(I_n)\) for each \(n\) so \(\lambda^*(x+N) \leq \sum_n \lambda (I_n) \leq \epsilon\). Therefore the Lebesgue outer measure of \(x+N\) can be made arbitrarily small so it must be 0.
\end{proof}

Now we can prove translation invariance

\begin{proposition}
If \(A \in \mathscr{M}\) then \(x+A \in \mathscr{M}\) and \(\lambda(x+A)=\lambda(A)\).
\end{proposition}

\begin{proof}
We've shown that \(A\) can be expressed as a disjoint union of a Borel set and a null set. So \(A = B \cup N\). This means that \(x+A = (x+B) \cup (x+N)\) then \((x+B)\) is a Borel set and \((x+N)\) is a null set so \(x+A\) is the union of two sets in \(\mathscr{M}\) so also in \(\mathscr{M}\). Furthermore \(\lambda(x+A) = \lambda(x+B) + \lambda(x+N)\). We know that Lebesgue measure is translation invariant on the Borel sets and that the translation of a null set is null so this gives
\[ \lambda(x+A) = \lambda(x+B)+\lambda(x+N)= \lambda(B) = \lambda(B\cup N)= \lambda(A).  \]
\end{proof}

Lastly, in the construction of Lebesgue measure we show that \(\mathscr{M}\) is not the whole of \(\mathscr{P}(\mathbb{R})\) and that there exist non-Lebesgue measureable sets.

\begin{proposition}
There exists sets that are in \(\mathscr{P}(\mathbb{R})\) which are not in \(\mathscr{M}\). This result is due to Vitali and the set we construct is often called the \emph{Vitali set}
\end{proposition}

\begin{proof}
This proof involves the use of the axiom of choice. In fact it is known that it is necessary to use some form of the axiom of choice to prove the existence of a non-Lebesgue measurable set in \(\mathbb{R}\).

We use an argument by contradiction, we begin by assuming every subset of \(\mathbb{R}\) is Lebesgue measurable. We define an equivalence relation on \([0,1)\) by saying \(x \sim y\) exactly when \(x-y \in \mathbb{Q}\). Using the axiom of choice we find a subset \(S\) of \([0,1)\) which contains exactly one representative of each equivalence class. Next we define the set \(S_q = \{ s+q \, (\mbox{mod}\,1) \, : \, s \in S \}\) for each \(q \in \mathbb{Q} \cap [0,1)\). Then by our choice of \(S\) we have that

\[ [0,1) = \bigcup_{q \in \mathbb{Q} \cap [0,1)} (S_q), \]
where this union is disjoint. We can check see that \(S_q \cap S_{q'} = \emptyset\) for \(q \neq q'\) as if \(x\) was in both then there exists \(y, y' \in S\) such that \(x = y +q \,(mod 1)\) and \(x= y' + q' (mod 1)\) this means \(y - y' \in \mathbb{Q}\setminus\{0\}\) which is a contradiction to the fact that \(S\) contains exactly one member of each equivalence class. Also we can see that this union contains every element of \([0,1)\) since if \(x \in [0,1)\) there exists some \(y\) which is in the same equivalence class of \(x\) with \(y \in S\). Therefore \(x = y + q \,(mod 1)\) for some \(q \in \mathbb{Q}\cap [0,1)\) so \(x \in S_q\) for this \(q\).

We can also see by translation invariance of \(\lambda\) that if \(S\) were Lebesgue measurable then we would have

\[ \lambda(S) = \lambda(S+q) \]
for every \(q\). Therefore, by countable additivity we would have

\[ \lambda([0,1)) = \sum_{q \in \mathbb{Q} \cap [0,1)} \lambda (S+q) = \sum_{q \in \mathbb{Q} \cap [0,1)} \lambda(S) = \infty. \]
\end{proof}

\hypertarget{mesurable-funtions}{%
\chapter{Mesurable funtions}\label{mesurable-funtions}}

A big part of measure theory is the study of functions which are compatible with the measure spaces. We begin with a basic definition which will be satisfied by all the functions we are interested in.

\begin{definition}[Mesasurable functions]
If \((E, \mathcal{E})\) and \((F, \mathcal{F})\) are two measurable spaces and \(f\) is a function \(E \rightarrow F\), then we say \(f\) is \emph{measurable} if for every \(A \in \mathcal{F}\) we have \(f^{-1}(A) \in \mathcal{E}\).
\end{definition}

\begin{lemma}
Suppose that \(\mathcal{A} \subset \mathcal{F}\) is such that \(\sigma(\mathcal{A})= \mathcal{F}\). If \(f\) is a function such that for every \(A \in \mathcal{A}\) we have \(f^{-1}(A) \in \mathcal{E}\) then \(f\) is measurable.
\end{lemma}

\begin{proof}
First we note that

\[ f^{-1}\left( \bigcup_i A_i \right) = \bigcup_i f^{-1}(A_i), \]

and

\[ f^{-1}(B \setminus A) = f^{-1}(B) \setminus f^{-1}(A). \]

Now if we consider \(\{ A \in \mathcal{F} \, :\, f^{-1}(A) \in \mathcal{E}\}\) then this is a \(\sigma\)-algebra, as \(\mathcal{E}\) is a \(\sigma\)-algebra and \(f^{-1}\) preserves set operations. Therefore, \(\{ A \in \mathcal{F} \, :\, f^{-1}(A) \in \mathcal{E}\}\) is a \(\sigma\)-algebra containing \(\mathcal{A}\) therefore \(\mathcal{F} \subseteq \{ A \in \mathcal{F} \, :\, f^{-1}(A) \in \mathcal{E}\}\) so \(f\) is measurable.
\end{proof}

\begin{remark}
In particular note that the above lemma means that whenever we have \(f: E \rightarrow \mathbb{R}\) and \(\mathbb{R}\) is equipped with the Borel \(\sigma\) algebra, we know that \(f\) is measurable if \(f^{-1}((-\infty, b])\) is a measurable set for every \(b\).
\end{remark}

\begin{lemma}
If \(E, F\) are topological spaces, equipped with their Borel \(\sigma\)-algebras, and we have \(f:E \rightarrow F\) is a continuous map then \(f\) is measurable.
\end{lemma}

\begin{proof}
This is on the exercise sheet and a solution on the solution sheet.
\end{proof}

\begin{lemma}
If \((E, \mathcal{E}), (F, \mathcal{F})\) and \((G, \mathcal{G})\) are all measurable spaces and \(f : E \rightarrow F\) and \(g: F \rightarrow G\) are measurable then so is \(g \circ f\).
\end{lemma}

\begin{proof}
Take any set \(A \in \mathcal{G}\) then \((g\circ f)^{-1}(A) = \{ x \in E \,:\, g(f(x)) \in A\}\). Let us call \(B = \{y \in F \,:\, g(y) \in A\} = g^{-1}(A)\) then \((g \circ f)^{-1}(A) = \{ x \in E \,:\, f(x) \in B\} = f^{-1}(B)\). Then as \(g\) is measurable and \(A \in \mathcal{G}\) then \(B \in \mathcal{F}\). In the same way as \(f\) is measurable and \(B \in \mathcal{F}\) then \(f^{-1}(B) \in \mathcal{E}\). As \(f^{-1}(B) = (g \circ f)^{-1}(A)\) this shows that \((g \circ f)^{-1}(A) \in \mathcal{E}\) for every \(A \in \mathcal{G}\) and hence \(g \circ f\) is measurable.
\end{proof}

\begin{lemma}
Suppose that \(f: \mathbb{R} \rightarrow \mathbb{R}\) is a monotone function. Then \(f\) is measurable with respect to the Borel \(\sigma\)-algebra.
\end{lemma}

\begin{proof}
Suppose without loss of generality that \(f\) is increasing then \(f^{-1}((-\infty, b])\) is \(\emptyset, (-\infty, \infty)\) or \((-\infty, a)\) or \((-\infty, a]\) for some \(a\). All these possibilities are Borel measurable sets.
\end{proof}

\begin{lemma}

If \(f_n\) is a sequence of measurable function taking values in \((\mathbb{R}, \mathcal{B}(\mathbb{R})\) then the following functions are all measurable:

\begin{itemize}
\tightlist
\item
  \(-f_1\)
\item
  \(\lambda f_1\) for \(\lambda >0\) a fixed contant.
\item
  \(f_1 \wedge f_2\)
\item
  \(f_1 \vee f_2\)
\item
  \(f_1+f_2\),
\item
  \(f_1 f_2\),
\item
  \(\sup_n f_n\),
\item
  \(\inf_n f_n\),
\item
  \(\limsup_n f_n\),
\item
  \(\liminf_n f_n\).
\end{itemize}

\end{lemma}

\begin{proof}
We only show two result. The rest are on the assignment.

In order to show that any of these functions are measureable we want to look at \(f^{-1}((-\infty, b])\) or a similar set. \((f_1 \vee f_2)^{-1}((-\infty, b]) = \{ x \,:\, \max\{f_1(x), f_2(x)\} \leq b\} = \{ x \,:\, f_1(x) \leq b \, \mbox{and} \, f_2(x) \leq b\} = \{ x \,:\, f_1(x) \leq b \} \cap \{x \,:\, f_2(x) \leq b\} = f_1^{-1}((-\infty, b]) \cap f_2^{-1}((-\infty, b])\). Now since \(f_1\) and \(f_2\) are both measureable the sets \(f_1^{-1}((-\infty, b])\) and \(f_2^{-1}((-\infty, b])\) are both measurable. We also know that the intersection of two measurable sets is measurable.

\((f_1+f_2)^{-1}((b,\infty)) = \{ x \,:\, f_1(x) + f_2(x) > b \}\). Now if \(f_1(x) > b-f_2(x)\) then there exists a \(q \in \mathbb{Q}\) such that \(f_1(x)> q > b - f_2(x)\). Let us define the set \(A= \bigcup_{q \in \mathbb{Q}} \{ x \,:\, f_1(x) > q\} \cap \{ x\,:\, f_2(x) > b-q\}\). Since \(f_1,f_2\) are both measurable \(A\) is a countable union of measurable sets so measurable. We can also see that if \(x \in A\) then \(f_1(x) + f_2(x) > b\) and our observation shows that in fact \(A= \{ x \,:\, f_1(x) + f_2(x) > b \}\). Therefore, \(f_1+f_2\) is measurable.
\end{proof}

\begin{definition}[Image measure]
We can use a measurable function \(f\) to define an image measure. Suppose \(\mu\) is a measure on \((E, \mathcal{E})\) and \(f\) is a measurable function \((E, \mathcal{E}) \rightarrow (F, \mathcal{F})\) then we can define a new measure \(\nu\) by saying that

\[ \nu(A) = \mu(f^{-1}(A)),  \]

for every \(A \in \mathcal{F}\). We write \(\nu = \mu \circ f^{-1}\).
\end{definition}

We can use the notion of image measure to construct further measures from Lebesgue measure.

\begin{lemma}
Suppose \(g: \mathbb{R} \rightarrow \mathbb{R}\) and that \(g\) is non-constant, right-continuous and non-decreasing. Let us define \(g(-\infty) = \lim_{x \rightarrow -\infty} g(x)\) and \(g(\infty) = \lim_{x \rightarrow \infty} g(x)\) and let us call the interval \(I:= (g(-\infty),g(\infty))\) (this might be the whole of \(\mathbb{R}\). Define a partial inverse to \(g\) by \(f: I \rightarrow \mathbb{R}\) by

\[ f(x) = \inf \{y \,:\, x \leq g(y)\}. \]

Then \(f\) is left-continuous and non-decreasing and \(f(x) \leq y\) if and only if \(x \leq g(y)\).
\end{lemma}

\begin{proof}
Fix \(x \in I\) and consider the set \(J_x = \{ y \in \mathbb{R}\,:\, x \leq g(y)\}\) by definition of \(I\) we know that \(J_x\) is non empty and is not the whole of \(\mathbb{R}\) (this shows that \(f\) is well defined). As \(g\) is non-decreasing, if \(y \in J_x\) and \(y' \geq y\), then \(y' \in J_x\). As \(g\) is right-continuous, if \(y_n \in J_x\) and \(y_n \downarrow y\) then \(y \in J_x\) (noting the \(\leq\) sign in \(J_x\)). Now using this we have that if \(x \leq x'\) then \(J_x \supseteq J_{x'}\) so \(f(x) \leq f(x')\). We also have that if \(x_n \uparrow x\) then \(J_x = \bigcap_n J_{x_n}\), so \(f(x_n) \rightarrow f(x)\).
\end{proof}

\begin{theorem}
Let \(g\) be a non-constant, right-continuous and non-decreasing function from \(\mathbb{R} \rightarrow \mathbb{R}\). There exists a unique Radon measure on \(\mathbb{R}\) such that for all \(a,b \in \mathbb{R}\) with \(a < b\)

\[ \mathrm{d}g((a,b]) = g(b) - g(a). \]

We call this measure the \emph{Lebesgue Steitjles} measure associated with \(g\). Furthermore, every Radon measure on \(\mathbb{R}\) can be represented this way.
\end{theorem}

\begin{proof}
Define \(I\) and \(f\) as in the Lemma above. Then we can construct \(\mathrm{d}g\) as the image measure of Lebesgue measure on \(I\). That is to say we can let \(\mathrm{d}g = \lambda \circ f^{-1}\). If this is the case then

\[ \mathrm{d}g ((a,b]) = \lambda \left(\{ x \, :\, f(x) > a, f(x) \leq b \} \right) = \lambda ((g(a), g(b)]) = g(b) - g(a). \]

The standard argument for uniqueness of measures (as for that of Lebesgue measure) gives uniqueness of this measure.

Finally, if \(\nu\) is a Radon measure on \(\mathbb{R}\) then we can define a function \(g\), by

\[ g(y) = \nu((0,y]), \quad y \geq 0, \quad g(y) = -\nu((y,0]), \quad y<0. \]

Then \(\nu = \mathrm{d}g\) by uniqueness.
\end{proof}

\hypertarget{random-variables-and-the-measure-theoretic-formulation-of-probability---nonexaminable}{%
\subsection{Random variables and the measure theoretic formulation of probability - NONEXAMINABLE}\label{random-variables-and-the-measure-theoretic-formulation-of-probability---nonexaminable}}

The structure of measure theory allows us to put probability theory on a firm footing. This section is mainly as an example and for those of you who are interested in probability.

\begin{definition}
We call a measure space \((\Omega, \mathcal{F}, \mathbb{P})\) a \emph{probability space} (and use different letters for the different bits) if \(\mathbb{P}(\Omega) = 1\). In this setting we still have \(\Omega\) is a set, \(\mathcal{F}\) is a \(\sigma\)-algebra and \(\mathbb{P}\) is a measure. We call \(\mathbb{P}\) a probability measure.
\end{definition}

The set \(\Omega\) is not really described and we view it as the \emph{space of all possible outcomes}. We call \(A \subset \Omega\) and event if \(A \in \mathcal{A}\), and \(\mathbb{P}(A)\) the probability of an event happening.

\begin{definition}
A \emph{random variable}, \(X\) is a measurable function from a probability space \((\Omega, \mathcal{F}, \mathbb{P})\) to another measurable space \((E, \mathcal{A})\).
\end{definition}

Under this way of writng things, with \(B \in \mathcal{A}\), we have \(\mathbb{P}(X \in B) = \mathbb{P}(\{ \omega \in \Omega \,:\, X(\omega) \in B\}) = \mathbb{P}( X^{-1}(B))\), where \(X^{-1}(B) \in \mathcal{F}\) as \(X\) is measurable. We call \(X^{-1}(B)\) the event that \(X \in B\). When working with probability people usually suppress the argument \(\omega\).

\begin{definition}
The \emph{law of a random variable}, \(X\) is the image measure of \(\mathbb{P}\) under the measurable function \(X\). I.e. if \(X: (\Omega, \mathcal{F}, \mathbb{P}) \rightarrow (E, \mathcal{A})\) then we define a measure \(\mu_X\) on \((E, \mathcal{A})\) by \(\mu_X(B) = \mathbb{P}(X \in B)\).
\end{definition}

\begin{remark}
The law of a random variable is an object which allows us to understand both probability densities and discrete probability distributions in the same way.

If \(X\) takes values in \(\mathbb{R}\) then the distribition function of \(X\), \(F_X(x) = \mu_X((-\infty, x])\). If \(X\) has density \(f(x)\) then \(\mu_X\) is equal to the measure given by \(\mu_X(A) = \int_A f(x) \mathrm{d}x\), though we still don't know how to integrate over complicated sets.
\end{remark}

\hypertarget{convergence-of-measurable-functions}{%
\section{Convergence of measurable functions}\label{convergence-of-measurable-functions}}

\begin{definition}[Almost everywhere / Almost surely]
We use the short hand \emph{almost everywhere} (or \emph{almost surely} in a probability space) to discuss properties that are true everywhere except a measure zero set.
\end{definition}

\begin{definition}[Convergence almost everywhere]
Let \((E, \mathcal{E}, \mu)\) be a measureable space. A sequence of measureable functions, \((f_n)_{n \geq 1}: E \rightarrow F\), \emph{converges almost everywhere} to \(f\) if

\[ \mu \left( \{ x \in E \,:\, f_n(x) \not\to f(x) \} \right) = 0 \]
\end{definition}

\begin{definition}[Convergence in measure]
Let \((E, \mathcal{E}, \mu)\) be a measureable space. A sequence of real valued measureable functions, \((f_n)_{n \geq 1}: E \rightarrow F\), \emph{converges in measure} to \(f\) if for every \(\epsilon > 0\)

\[ \mu \left( \{ x \, :\, |f(x) - f_n(x)| > \epsilon \} \right) \rightarrow 0, \quad \mbox{as}\, n \rightarrow \infty. \]
\end{definition}

\begin{example}
The sequence of functions \(f_n(x) = x^n\) converges to \(0\) Lebesgue almost everywhere on \([0,1]\), and in measure, but it doesn't converge pointwise as it doesn't converge at \(x=1\).
\end{example}

\begin{example}
The- sequence of functions \(f_n(x) = 1_{[n,n+1]}(x)\) converges to 0 Lebesgue almost everywhere (in fact everywhere) but not in measure.
\end{example}

\begin{example}
Consider the sequence of functions \(f_1 = 1_{[0,1/2)}, f_2 = 1_{[1/2, 1)}, f_3 = 1_{[0,1/4)}, f_4 = 1_{[1/4, 1/2)}, f_5= 1_{[1/2, 3/4)}, f_6 = 1_{[3/4,1)}, f_7 = 1_{[0,1/8)}, f_8 = 1_{[1/8, 1/4)} \dots\) then \(f_n\) converges to 0 in measure, but \(f_n(x)\) does not converge for any \(x\).
\end{example}

We can prove a quasi-equivalence between these two notions of measure. Before we do this we need to introduce a very useful lemma, the Borel-Cantelli Lemma. We introduce it here as it is used to prove the following theorem but it is a useful tool to have whilst doing measure theory, particularly probability theory. First let us also introduce some more notation

\begin{definition}
Let \((A_n)_n\) be a sequence of measurable sets then we have the following names

\[ \limsup_n A_n = \bigcap_n \bigcup_{m \geq n} A_m = \{ A_n \, \mbox{infinitely often}\,\}, \]

and

\[ \liminf_n A_n = \bigcup_n \bigcap_{m \geq n} A_m = \{ A_n \, \mbox{eventually}\,\}. \]

The last names are more common when the \(A_n\) are events in a probability space.
\end{definition}

\begin{lemma}[First Borel-Cantelli Lemma]
Let \((E, \mathcal{E}, \mu)\) be a measure space. Then if \(\sum_n \mu(A_n) < \infty\) it follows that \(\mu(\limsup_n A_n) = 0)\).
\end{lemma}

\begin{proof}
For any \(n\) we have

\[ \mu(\limsup_n A_n) \leq \mu \left( \bigcup_{m \geq n} A_m\right) \leq \sum_{m \geq n} \mu(A_m). \]

Then the right hand side goes to zero as \(n \rightarrow \infty\), so \(\mu(\limsup_n A_n) = 0\).
\end{proof}

\begin{lemma}[Second Borel-Cantelli Lemma - NONEXAMINABLE]
Let \((E, \mathcal{E}, \mu)\) be a probability space (\(\mu(E) =1\)). Then suppose that the events are all inedepenent and that \(\sum_n \mu(A_n) = \infty\) then it will follow that \(\mu(\limsup_n A_n) =1\).
\end{lemma}

\begin{proof}
First we note that \(\mu(A_i^c \cap A_j^c) = \mu ((A_i \cup A_j)^c) = 1 - \mu(A_i \cup A_j) = 1 - \mu(A_i) - \mu(A_j)+ \mu(A_i)\mu(A_j) = (1-\mu(A_i))(1-\mu(A_j))\).
We use the inequality \(1-a \leq e^{-a}\). Let \(a_n = \mu(A_n)\) then

\[ \mu \left( \bigcap_{m=n}^N A_m^c \right) = \Pi_{m=n}^N (1-a_m) \leq \exp \left( - \sum_{m=n}^N a_m \right) \rightarrow 0, \quad \mbox{as}\, N \rightarrow 0. \]

Therefore, \(\mu \left( \bigcap_{m \geq n} A_m^c \right) = 0\) for every \(n\). So \(\mu(\limsup_n A_n ) = 1- \mu(\bigcup_n \bigcap_{m \geq n} A_m^c) = 1\).
\end{proof}

\begin{theorem}

Let \((E, \mathcal{E}, \mu)\) be a measure space and \((f_n)_n\) be a sequence of measurable functions. Then we have the following:

\begin{itemize}
\tightlist
\item
  Suppose that \(\mu(E) < \infty\) and that \(f_n \rightarrow 0\) almost everywhere, then \(f_n \rightarrow 0\) in measure.
\item
  If \(f_n \rightarrow 0\) in measure then there exists some subsequence \((n_k)_k\) such that \(f_{n_k} \rightarrow 0\) almost everywhere.
\end{itemize}

\end{theorem}

\begin{proof}
Suppose that \(f_n \rightarrow 0\) almost everywhere. Then

\[ \mu(\{ x\,:\, |f_n(x)| \leq \epsilon \}) \geq \mu \left( \bigcap_{m \geq n} \{ x \,:\, |f_m(x)| \leq \epsilon\}\right) \uparrow \mu \left(|f_n| \leq \epsilon \, \mbox{eventually} \right) \geq \mu(\{ x \,:\, f_n(x) \rightarrow 0\}) = \mu(E), \]

therefore,

\[ \mu(\{ x\,:\, |f_n(x)|> \epsilon) = \mu(E) - \mu(\{ x\,:\, |f_n(x)| \leq \epsilon \}) \rightarrow 0. \]

Now suppose that \(f_n \rightarrow 0\) in measure. We can find a subsequence \(n_k\) such that

\[ \mu(\{ x \,:\, |f_{n_k}(x)| > 1/k \}) \leq 2^{-k}. \]

Therefore

\[ \sum_k \mu(\{ x \,:\, |f_{n_k}(x)| > 1/k \})<\infty.\]

Therefore by the first Borel-Canteli lemma we have that

\[ \mu \left(\{ x\,:\, |f_{n_k}(x)|>1/k \, \mbox{infinitely often}\} \right) = 0. \]

Therefore \(f_{n_k} \rightarrow 0\) almost everywhere.
\end{proof}

\hypertarget{egoroffs-theorem-and-lusins-theorem}{%
\section{Egoroff's Theorem and Lusin's Theorem}\label{egoroffs-theorem-and-lusins-theorem}}

\begin{theorem}[Egoroff's Theorem]
Let \((E, \mathcal{E}, \mu)\) be a finite measure space and \((f_n)_n\) be a sequence of real valued measurable functions on \(E\). If \(\mu\) is finite and if \(f_n\) converges \(\mu\)-almost everywhere to \(f\) then for each positive \(\epsilon\) there is a set \(A\) with \(\mu(A^c)< \epsilon\), such that \(f_n\) converges uniformly on \(A\) to \(f\).
\end{theorem}

\begin{proof}
For each \(n\) let \(g_n(x) = \sup_{j \geq n}|f_j(x)-f(x)|\). Then \(g_n\) is a positive function which is finite almost everywhere. The sequence \((g_n)_n\) converges to 0 almost everywhere and so in measure. Therefore, for each positive integer \(k\) we can find \(n_k\) such that

\[ \mu \left( \{ x \,:\, g_{n_k} > 1/k \} \right) < \epsilon 2^{-k}.  \]

Define sets \(A_k = \{ x\,:\, g_{n_k}(x) \leq 1/k\}\) and let \(A= \bigcap_k A_k\). The set \(A\) has

\[ \mu(A^c) = \mu \left( \bigcup_k A_k^c \right) \leq \sum_k \mu(A_k^c) \leq \sum_k \epsilon 2^{-k} = \epsilon. \]

We want to show that \(f_n\) converges uniformly to \(f\) on \(A\). For each \(\delta\) there exists a \(k\) such athat \(1/k < \delta\), then as \(A \subseteq A_k\), we have that for every \(n \geq n_k\),

\[ |f_n - f| \leq g_{n_k} \leq 1/k < \delta, \]

uniformly on all \(x \in A_k\) and hence in \(A\).
\end{proof}

This proof motivates the following definition of convergence of functions, which we won't use a lot.

\begin{definition}[Almost uniform convergence]
We say a sequence of functions \((f_n)_{n \geq 1}\) converges \emph{almost uniformly} on a measure space \((E, \mathcal{E}, \mu)\) if for every \(\epsilon >0\) there exists a set \(A\) with \(\mu(A^c)< \epsilon\) with \(f_n \rightarrow f\) uniformly on \(A\).
\end{definition}

We can use Egoroff's theorem to prove a result called Lusin's theorem. First let us recall the definition of regularity

\begin{definition}

Let \(E\) be a topological space and \(\mu\) be a measure on \((E, \mathcal{B}(E))\) then say \(\mu\) is \emph{regular} if for every \(A \in \mathcal{B}(E)\) we have

\begin{itemize}
\tightlist
\item
  \[\mu(A) = \inf \{ \mu(U) \,:\, A \subseteq U, \mbox{$U$ is open}\},\]
\item
  \[\mu(A) = \sup \{ \mu(K) \,:\, K \subseteq A, \mbox{$K$ is compact}\}.\]
\end{itemize}

\end{definition}

\begin{theorem}[Lusin's Theorem]
Suppose that \(f\) is a measurable function and \(A \subseteq \mathbb{R}^d\) is a Borel set and \(\lambda(A) < \infty\) then for any \(\epsilon >0\) there is a compact subset \(K\) of \(A\) with \(\lambda(A \setminus K) < \epsilon\) such that the restriction of \(f\) to \(K\) is continuous.
\end{theorem}

\begin{remark}
This theorem can be generalised to locally compact Hausdorff spaces, see Cohn's book.
\end{remark}

\begin{proof}
Suppose first that \(f\) only takes countably many values, \(a_1, a_2, a_3, \dots\) on \(A\) the let \(A_k = \{ x \in A \,:\, f(x) = a_k\}\), by measurablility of \(f\) we can see that \(A_k = f^{-1}(\{a_k\})\) is measurable. We know that \(A = \bigcup_n A_n\) so by continuity of measure \(\lambda(\bigcup_{k=1}^n A_k) \uparrow \lambda(A)\). Since \(\lambda(A) < \infty\) we have that for any \(\epsilon >0\) there exists \(n\) such that \(\lambda(A \setminus \bigcup_{k=1}^n A_k) < \epsilon/2\). By the regularity of Lebesgue measure we can find compact subsets \(K_1, \dots, K_n\) such that \(\lambda(A_n \setminus K_n) \leq \epsilon/2n\). Then let \(K = \bigcup_{k=1}^n K_k\). This is a compact subset of \(A\) and

\[ \lambda(A \setminus K) \leq \lambda(A\setminus \bigcup_{k=1}^n A_k) + \lambda(\bigcup_{k=1}^n A_k \setminus \bigcup_{k=1}^n K_k ) < \epsilon/2 + \epsilon/2. \]

Now \(f\) restricted to \(K\) is continuous since the \(K_i\) are disjoint and \(f\) is constant on each \(K_i\).

Now we have proved the special case where \(f\) takes countably many values we can use this to prove the theorem for general \(f\). Let \(f_n = 2^{-n} \lfloor 2^n f \rfloor\) then \(2^{-n} \geq f(x)-f_n(x) \geq 0\) so \(f_n(x) \rightarrow f(x)\), uniformly. Now, \(f_n\) can only take countably many values, so by our special case of Lusin's theorem there exists a \(K_n \subseteq K\), compact, such that \(\lambda(A \setminus K_n) \leq \epsilon 2^{-n}\), and \(f_n\) is continuous on \(K_n\). Now let \(K_\infty = \bigcap_n K_n\), then \(K_\infty\) is compact and \(\lambda(A \setminus K_\infty) = \lambda (\bigcup_n(A \setminus K_n)) \leq \sum_n \epsilon 2^{-n} = \epsilon\). Now we have that \(f_n\) converges uniformly to \(f\) on \(K_\infty\) and \(f_n\) is continuous on \(K_\infty\) for each \(n\). As the uniform limit of continuous functions is continuous this shows that \(f\) is continuous on \(K\).
\end{proof}

\hypertarget{integration-1}{%
\chapter{Integration}\label{integration-1}}

We now get to the definition of the Lebesgue integral which is the second important object that we construct in this course. There are several different notations for the integral of a function \(f\) with respect to a measure \(\mu\). We have

\[ \mu(f) = \int_E f \mathrm{d}\mu = \int_E f(x) \mu(\mathrm{d}x). \]

When you are integrating with respect to Lebesgue measure the most common notation is

\[ \int_E f(x)\mathrm{d}x. \]

Before we start constructing the integral we'll briefly discuss the motivations for how to construct it. Firstly, you've already seen the Riemann integral. We can describe the strategy of Riemann integration - very loosly - as splitting the \emph{domain} of the function into equal sized chunks, estimating the height of the function on each chunk then adding them together. Broadly what happens with Lebesgue integration is that we split the \emph{range} of the function into equal sized chunks, estimate the size of the part of the domain which will end up in that chunk of range then sum everything up. We need the theory of measure in order to do this because the bit of the domain corresponding to chuncks of the range can be quite weird sets whose size it wouldn't be possible to measure. The first motivation for this is that whilst Riemann integration only works for functions from subsets of \(\mathbb{R}^d\) to \(\mathbb{R}\), Lebesgue integration allows the domain on the function to be quite weird, (as long as it is a measure space). As an example, this is helpful for taking expectations rigorously because expectations are integral of random variables and the domain of a random variable is a probability space which may not be explicit.

The second big motivation for introducing a new theory of integration is the issue of convergence. It is important in many practical applications of integration theory to know when \(\lim_n \int f_n(x) \mathrm{d}x = \int \lim_n f_n(x) \mathrm{d}x\) or when \(\int_{E_x} \int_{E_y} f(x,y) \mathrm{d}x \mathrm{d}y = \int_{E_y} \int_{E_x} f(x,y) \mathrm{d}y \mathrm{d}x\). Lebesgue integration allows us to rigorously find conditions on \(f\) under which these statements will be true. This is often not possible in a satisfactory way with the Riemann theory of integration. We will see some of these convergence theorems next week and then switching the order of integration towards the end of the course (currently planned for week 9). The most important motivation for developing good convergence theorems was the development of Fourier series. We want to know when it is possible to integrate a Fourier series term by term.

The strategy for constructing the integral is to begin by defining \(\mu(f)\) when \(f\) belongs to a special class of measurable functions that we call \emph{simple functions}. We then define the integral to progressively larger classes of functions.

\begin{definition}[Simple functions]
Let \((E, \mathcal{E}, \mu)\) be a measure space. The set of simple functions on this space taking values in \(\mathbb{R}\) are functions of the form

\[ f(x) = \sum_{k=1}^n a_k 1_{A_k}(x). \]

Here, the \(A_k\) are sets in \(\mathcal{E}\), \(1_{A}\) represents the indicator function of the set, and the \(a_k\) are non-negative real numbers. We note that this representation of \(f\) is not unique.
\end{definition}

\begin{definition}[The integral of a simple function]
Still working in the setting above, let \(f(x) = \sum_{k=1}^n a_k 1_{A_k}(x)\), then we can define

\[ \mu(f) = \sum_{k=1}^n a_k \mu(A_k). \]
\end{definition}

\begin{lemma}

The integral of a simple function is well defined (it doesn't depend on the choice of representation of the simple function) and satisfies the following properties.

\begin{itemize}
\tightlist
\item
  For \(\alpha >0\) we have \(\mu(\alpha f) = \alpha \mu(f)\)
\item
  \(\mu(f+g) = \mu(f) + \mu(g)\).
\item
  If \(f(x) \leq g(x)\) for every \(x \in E\) then \(\mu(f) \leq \mu(g)\).
\item
  \(f=0\) \(\mu\)-almost everywhere if and only if \(\mu(f)=0\)
\end{itemize}

\end{lemma}

\begin{proof}
Let us first look at the well definedness. The most important thing to notice is that a simple function can only take finitely many values, suppose they are \(a_1, \dots, a_n\) and we can write it as \(f(x) = \sum_{k=1}^n a_k f^{-1}(\{a_k\})\). Any other representation will just split up the sets \(f^{-1}(\{a_k\})\), overlap them or add \(0*1_{B}\) for some set \(B\). We can prove it slowly as in the next paragraph but you don't need to be able to repeat this.

without loss of generality lets assume the \(a_k, b_j\) are strictly positive and the sets \(A_k\) are disjoint and similar for the \(B_j\). Let us suppose that \(f = \sum_{k=1}^n a_k 1_{A_k} = \sum_{k=1}^m b_k 1_{B_k}\) which are both simple function representations. Then we can see that \(\bigcup_{k=1}^nA_k = \bigcup_{k=1}^m B_k\) and that \(a_i =b_j\) if \(A_i \cap B_j \neq \emptyset\). Using this we can write

\begin{align*} 
\mu(f) &= \sum_{k=1}^n a_k \mu(A_k)\\
\left(\mbox{as}\, A_k = \bigcup_j (A_k \cap B_j)\, \mbox{as}\, \bigcup_{k=1}^nA_k = \bigcup_{j=1}^m B_j\right) \quad \quad &= \sum_{k=1}^n \sum_{j=1}^m a_k \mu(A_k \cap B_j) \\
\left(\mbox{as}\, a_k = b_j\, \mbox{if}\, A_k \cap B_j \neq \emptyset\, \mbox{so}\, a_k=b_j\, \mbox{or}\, \mu(A_k\cap B_j) = 0\right) \quad \quad & = \sum_{k=1}^n \sum_{j=1}^m b_j \mu(A_k \cap B_j) \\
&= \sum_{j=1}^m b_j \sum_{k=1}^n \mu(A_k \cap B_j) \\
&= \sum_{j=1}^m b_j \mu(B_j).
\end{align*}

Now we move on to the linearity properties. These come naturally from the defintion,

\begin{align*}
\mu(\alpha f) = \sum_{k=1}^n \alpha a_k \mu(A_k) = \alpha \sum_{k=1}^n a_k \mu(A_k) = \alpha \mu(A_k).
\end{align*}

Once we know the integral is well defined the sum part is immediate we can write \(f=\sum_{k=1}^n a_k 1_{A_k}\) and \(g= \sum_{j=1}^m b_j 1_{B_j}\) and then we can write \(f+g = \sum_{k=1}^n a_k 1_{A_k} + \sum_{j=1}^m b_j 1_{B_j}\) from which \(\mu(f+g) = \mu(f) + \mu(g)\) follows.

Now we move onto the monotonicity of the integral. Let us express \(f\) and \(g\) as before, the goal is to represent the two functions using the same measurable sets. We can rewrite as

\[ f = \sum_{k=0}^n \sum_{j=0}^m a_k 1_{A_k \cap B_j} = \sum_{k=0}^n \sum_{j=0}^m a_{k,j}1_{A_k \cap B_j},\]

where \(a_{k,j} = a_k 1_{A_k \cap B_j \neq \emptyset}\). Here we are using the fact that \(\bigcup_{j=0}^m B_j\) fill the space. In the same way we can write

\[ g = \sum_{k=1}^n \sum_{j=1}^m b_{k,j}1_{A_k \cap B_j}, \]

where \(b_{k,j} = b_j 1_{A_k \cap B_j \neq \emptyset}\). Then if \(f(x) \leq g(x)\) for every \(x\) we know that this means \(a_{k,j} \leq b_{k,j}\) for every \(k,j\). Then by the well definedness of the integral we have

\[ \mu(f) = \sum_{k=1}^n \sum_{j=1}^m a_{k,j} \mu(A_k \cap B_j) \leq \sum_{k=1}^n \sum_{j=1}^m b_{k,j} \mu(A_k \cap B_j) = \mu(g).\]

Lastly, we look at when \(\mu(f)=0\). First if \(f=0\) \(\mu\)-almost everywhere then \(a_k=0\) or \(\mu(A_k)=0\) for each \(k\), therefore \(\mu(f)=0\). If \(\mu(f) =0\) then since all the terms \(a_k \mu(A_k) \geq 0\) we have that \(a_k=0\) or \(\mu(A_k) =0\) for each \(k\).
\end{proof}

We are now going to extend the definition of the integral to a larger class of functions.

\begin{definition}[Lebesgue integral for positive functions]
Let \(f\) be a positive, measurable function, we define

\[ \mu(f) = \sup \{ \mu(g)\, :\, g \, \mbox{is a simple function}, g \leq f\} \]
\end{definition}

\begin{lemma}
The above definition of Lebesgue integral for positive functions is consistent with the defintion for simple functions. That is to say that if \(f = \sum_{k=1}^n a_k 1_{A_k}\) where \(a_k \geq 0\) and the \(A_k\) are disjoint measurable sets then

\[ \sum_{k=1}^n a_k \mu(A_k) = \sup \{ \mu(g)\, :\, g \, \mbox{is a simple function}, g \leq f\}.  \]
\end{lemma}

\begin{proof}
This is on the exercise sheet.
\end{proof}

\begin{definition}[Final definition of Lebesgue integral]
Suppose that \(f\) is a measurable function which is not necessarily positive. Then we call \(f\), \(\mu\)-\emph{integrable} or \emph{Lebesgue integrable} if \(\mu(|f|)< \infty\). In this case we can write \(f = f_+ - f_{-}\) where \(f_+\) and \(f_-\) are both positive and measurable (\(f_+ = \max\{f, 0\}, f_- = \max \{-f, 0\}\)). We then define the integral of \(f\) by

\[ \mu(f) = \mu(f_+) - \mu(f_-). \]
\end{definition}

\begin{remark}
Notice that we haven't yet proved that these definitions of the integral behave the way we hope (e.g.~are linear, monotone, etc). In order to do this we need to prove some convergence results.
\end{remark}

\hypertarget{convergence-theorems-for-integrals-of-functions}{%
\section{Convergence theorems for integrals of functions}\label{convergence-theorems-for-integrals-of-functions}}

This is one of the most useful parts of the course. In follow on courses in PDE and probability you will use these theorems again and again.

\begin{lemma}
If \(f\) and \(g\) are non-negative, measurable, real valued functions on \((E, \mathcal{E}, \mu)\) and \(f \leq g\) then \(\mu(f) \leq \mu(g)\).
\end{lemma}

\begin{proof}
If \(f \leq g\) then we recall that by definition

\[\mu(f) = \sup\{ \mu(\tilde{f}) \,:\, \mbox{$\tilde{f}$ is simple},\, \tilde{f} \leq f\}.\]

So if \(h\) is a simple function with \(h \leq f\) then we also have that \(h \leq g\). Therefore, we can write

\begin{align*} \mu(g) &= \sup\{ \mu(h) \,:\, \mbox{$h$ is simple},\, h \leq g\} \\ &= \max\{\sup\{ \mu(h)\, :\, \mbox{$h$ simple}, h \leq f\}, \sup\{ \mu(h)\, :\, \mbox{$h$ simple}, h \leq g, \mbox{$h$ is not $\leq$ f}\} \}\\ &= \max\{ \mu(f), \sup\{ \mu(h)\, :\, \mbox{$h$ simple}, h \leq g, \mbox{$h$ is not $\leq$ g}\}\} \geq \mu(f).\end{align*}
\end{proof}

\begin{theorem}[Monotone Convergence Theorem]
Let \(f\) be a non-negative, measurable real-valued function and let \(f_n\) be a sequence of such functions. Then if \(f_n \uparrow f\) we will have that \(\mu(f_n) \uparrow \mu(f)\).
\end{theorem}

\begin{proof}
We will break this proof down into progressively more complicated cases. First we note that by monotonicity \(\lim_n \mu(f_n) \leq \mu(f)\) and therefore it is sufficient to prove \(\mu(f) \leq \lim_n \mu(f_n)\).

First let us look at the case where \(f_n = 1_{A_n}\) and \(f=1_{A}\), then the assumptions imply that \(A_1 \subseteq A_2 \subseteq A_3 \subseteq \dots\) and \(A= \bigcup_n A_n\). Then this result is the same as the continuity of a measure as proved before.

Now let us keep \(f=1_{A}\) and let \(f_n\) be a sequence of simple functions. Pick \(\epsilon \in (0,1)\) arbitrary. Then let \(A_n = \{ x\,:\, f_n(x)>1-\epsilon\}\) then we have that \(A_n \uparrow A\), and \((1-\epsilon)1_{A_n} \leq f_n\). Therefore by the first case we have that \(\lim_n \mu(f_n) \geq \lim_n \mu((1-\epsilon)1_{A_n}) = \lim_n (1-\epsilon) \mu(1_{A_n}) = (1-\epsilon) \mu(f)\). Since \(\epsilon\) is arbitrary this gives the result.

Now we look at the case where both \(f\) and \(f_n\) are simple functions. We can write \(f = \sum_{k=1}^n a_k 1_{A_k}\), where wlog each \(a_k\) is strictly positive, then we have that \(a_k^{-1} f_n 1_{A_k} \uparrow 1_{A_k}\) so we can apply the previous case to each part of \(f\). Specifically

\[ \mu(f_n) = \mu(\sum_{k=1}^n  1_{A_k}f_n) = \sum_{k=1}^n a_k \mu (a_k^{-1} 1_{A_k}f_n) \uparrow \sum_{k=1}^n a_k \mu(A_k) = \mu(f). \]

Here the first equality follows from the fact that the support of \(f_n\) must be included in the support of \(f\) since \(0 \leq f_n \leq f\).

Our next case is when \(f\) is positive and measurable and \(f_n\) are all simple. Let us pick \(g\) a simple function with \(g \leq f\) then \(g_n = f_n \wedge g = \min\{f_n, g\}\) is a sequence of simple functions increasing to \(g\). Therefore, by our previous case \(\mu(g_n) \uparrow \mu(g)\). Furthermore \(g_n \leq f_n\) so by monotonicity

\[\mu(g) =\lim_n \mu(g_n) \leq \lim_n \mu(f_n).\]

As \(g\) is an arbitrary this means that \(\sup\{\mu(g)\,:\, g \, \mbox{is a simple function}, g \leq f\} \leq \lim_n \mu(f_n).\)

The last case is the most general where both \(f_n\) and \(f\) are positive and measureable. In this case we introduce our favorite kind of approximation (which is very similar to what we used in Lusin's theorem)

\[ g_n = \left( 2^{-n} \lfloor 2^n f_n \rfloor \right) \wedge n, \]

then \(g_n\) is a sequence of simple functions with \(g_n \uparrow f\) and \(g_n \leq f_n\). Therefore we have

\[ \mu(f) = \lim_n \mu(g_n) \leq \lim_n \mu(f_n) \leq \mu(f). \]

Hence we have the required result.
\end{proof}

We have a corollary of this result which can be thought of as another definition of \(\mu(f)\) for non-negative, measurable \(f\). This makes concrete our hand-waving definition of how Lebesgue measure works as splitting the range of \(f\) up into equal chunks and using this to approximate the area under the curve. This is often a more practically useful definition of the integral of a positive function.

\begin{corollary}
Let \(f\) be a non-negative, measurable, real valued function on \((E, \mathcal{E}, \mu)\) and define

\[ f_n = \left( 2^{-n} \lfloor 2^n f \rfloor \right) \wedge n, \]

then \(\mu(f) = \lim_n \mu(f_n)\).
\end{corollary}

\begin{proof}
\(f_n \uparrow f\) so by monotone convergence \(\lim_n \mu(f_n) = \mu(f)\).
\end{proof}

We can now use this to prove that the integral of positive measurable functions has the desired properties.

\begin{proposition}

Suppose \(f\) and \(g\) are non-negative, real valued, measurable function on a space \((E, \mathcal{E}, \mu)\) then

\begin{itemize}
\tightlist
\item
  For every \(\alpha>0\) \(\mu(\alpha f) = \alpha \mu(f)\),
\item
  \(\mu(f+g) = \mu(f) + \mu(g)\)
\item
  If \(f \leq g\) then \(\mu(f) \leq \mu(g)\)
\item
  \(\mu(f) = 0\) if and only if \(f\) is \(0\) almost everywhere.
\end{itemize}

\end{proposition}

\begin{proof}
Suppose that \(f_n\) is a sequence of simple functions with \(f_n \uparrow f\) then \(\alpha f_n\) is a sequence of simple functions with \(\alpha f_n \uparrow \alpha f\). Monotone convergence tells us that \(\mu(\alpha f) = \lim_n \mu(\alpha f_n)\). We can use our previous results for simple functions to get that \(\mu(\alpha f_n) = \alpha \mu(f_n)\). Therefore \(\mu(\alpha f) = \lim_n \mu(\alpha f_n) = \lim_n \alpha \mu(f_n) = \alpha \mu(f)\).

For the sum let \(f_n\) and \(g_n\) be sequences of simple functions with \(f_n \uparrow f\) and \(g_n \uparrow g\). Then we have \((f_n + g_n) \uparrow f+g\) and by monotone convergence and the results for simple functions we have \(\mu(f+g) = \lim_n \mu(f_n + g_n) = \lim_n \mu(f_n) + \lim_n \mu(g_n) = \mu(f) + \mu(g)\).

The third point is proved before.

Now \(\mu(f) = 0\) if and only if

\[\sup\{ \mu(h) \,:\, \mbox{$h$ simple},\, h \leq f\} = 0\]

which is if and only if \(\mu(h) = 0\) for every \(h \leq f\) and \(h\) simple. Now we know that if \(h\) is simple \(\mu(h) = 0\) if and only if \(h\) is zero almost everywhere. This tells us that \(\mu(f) = 0\) if and only if \(h \leq f\) and \(h\) simple, implies \(h = 0\) almost everywhere. If we look at the set on which \(f\) is positive we have \(\{x\,:\, f(x)>0\} = \bigcup_n \{ x \,:\, f(x) > 1/n\}\) so by continuity of measure if \(\mu( f>0)>0\) then there exists some \(n\) such that \(\mu(f >1/n)>0\) therefore \(f\) is zero almost everywhere if and only if we can't fit any simple function underneath \(f\) which is not zero almost everywhere.
\end{proof}

Using this we can give another writing of the monotone convergence theorem.

\begin{proposition}[Beppo-Levi]
Suppose that \((f_n)_{n \geq 0}\) is a sequence of non-negative real-valued measurable functions. Then \(\mu(\sum_n f_n) = \sum_n \mu(f_n)\).
\end{proposition}

\begin{proof}
Write \(g_n = \sum_{k=1}^n f_k\) then \(g_n \uparrow \sum_n f_n\)

\[  \sum_n \mu(f_n) = \lim_n \sum_{k=1}^n \mu(f_k),\]

then by linearity

\[ \lim_n \sum_{k=1}^n \mu(f_k) = \lim_n \mu(\sum_{k=1}^n f_k) = \lim_n \mu(g_n), \]

then using monotone convergence we have

\[ \lim_n \mu(g_n) = \mu(\sum_n f_n). \]
\end{proof}

We can also prove that our notion of convergence for integrable functions behaves in the way we expect. First we prove a helpful Lemma

\begin{lemma}
Let \(f_1, f_2, g_1, g_2\) all be non-negative, integrable, real valued functions such that \(f_1-f_2 = g_1-g_2\) then we have \(\mu(f_1) - \mu(f_2) = \mu(g_1) - \mu(g_2)\).
\end{lemma}

\begin{proof}
We have that \(f_1+g_2 = g_1 + f_2\) so \(\mu(f_1+g_2) = \mu(g_1+f_2)\), using linearity we have

\[ \mu(f_1) + \mu(g_2) = \mu(g_1) + \mu(f_2) \]

since all the integrals involved are finite we can rearrange this to give

\[ \mu(f_1) - \mu(f_2) = \mu(g_1) - \mu(g_2). \]
\end{proof}

\begin{proposition}

Suppose that \(f\) and \(g\) are integrable, real valued function on \((E, \mathcal{E}, \mu)\) then

\begin{itemize}
\tightlist
\item
  For every \(\alpha>0\) we have \(\mu(\alpha f) = \alpha \mu(f)\), we also have \(\mu(-f) = -\mu(f)\)
\item
  The function \(f+g\) is integrable and \(\mu(f+g) = \mu(f) + \mu(g)\)
\item
  If \(f \leq g\) then \(\mu(f) \leq \mu(g)\)
\end{itemize}

\end{proposition}

\begin{proof}
Let us write \(f= f_+ - f_-\) and \(g= g_+ - g_-\) where these are split into the positive and negative parts of \(f\) and \(g\). Then \(\alpha f = \alpha f_+ - \alpha f_-\) so \(\mu(\alpha f) = \mu(\alpha f_+) - \mu(\alpha f_-) = \alpha (\mu(f_+)-\mu(f_-))\). Similarly \(-f=f_- - f_+\) so \(\mu(-f) = \mu(f_-) - \mu(f_+) = -\mu(f)\).

First we have that \(|f+g| \leq |f|+|g|\) so \(f+g\) is integrable. For the second point we need to use the Lemma above. We know that \((f_+ + g_+) - (f_- + g_-) = (f+g)_+ - (f+g)_-\) and all of \((f_+ + g_+),(f_-+g_-), (f+g)_+, (f+g)_-\) are non-negative and integrable so using the lemma we have

\[ \mu(f+g) = \mu((f+g)_+) - \mu((f+g)_-) = \mu(f_+ +g_+) - \mu(f_- + g_-) = \mu(f_+) - \mu(f_-) + \mu(g_+) - \mu(g_-) = \mu(f) + \mu(g). \]

For the last point if \(f \leq g\) then \(g-f\) is a non-negative measurable function so \(\mu(g-f) \geq 0\) and \(\mu(g) = \mu(f+(g-f))\). We then use the linearity from the last point to get \(\mu(f + (g-f)) = \mu(f) + \mu(g-f) \geq \mu(f)\).
\end{proof}

\begin{theorem}[Fatou's Lemma]
Let \(f_n\) be a sequence of non-negative measurable function then we have the following result

\[ \mu \left( \liminf_n f_n \right) \leq \liminf_n \mu(f_n) \]
\end{theorem}

\begin{remark}
I always have trouble remembering which way around the inequality goes in this lemma. A helpful example is if \(f_n = 1_{[n,n+1)}\) and \(\mu\) is Lebesgue measure. Then \(\lambda(f_n) = 1\) for every \(n\) and \(\liminf_n f_n = 0\). This is also an instructive example for why the limits can fail to be the same. Essentially here the mass we are trying to integrate escapes to infinity.
\end{remark}

\begin{proof}
This is essentially a consequence of monotone convergence. Let \(g_n = \inf_{k \geq n} f_k\), then \(g_n\) is a non-decreasing sequence of measurable functions and \(g_n \leq f_n\) for each \(n\). By definition of the \(g_n\) we also know that \(\liminf f_n = \liminf_n g_n = \lim_n g_n\). Using Monotone convergence we then have

\[ \mu(\liminf_n f_n) = \mu(\lim_n g_n) = \lim_n \mu(g_n). \]

Then using monotonicity we have

\[ \mu(g_n) \leq \mu(f_n) \]

for each \(n\), so consequently

\[\lim_n \mu(g_n) =  \liminf_n \mu(g_n) \leq \liminf_n \mu(f_n). \]

Putting these all together gives the result.
\end{proof}

Fatou's lemma is key to proving our next important convergence theorem.

\begin{theorem}[Dominated convergence theorem]
Let \(f_n\) be a sequence of functions and \(f\) another function such that \(f_n \rightarrow f\) almost everywhere. Suppose further that there exists a positive function \(g\) such that \(|f| \leq g, |f_n| \leq g\) for every \(n\) and \(\mu(g) < \infty\), then \(\lim_n \mu(f_n) = \mu(f)\). The function \(g\) is called the \emph{dominating function}.
\end{theorem}

\begin{proof}
Let us first suppose that \(f_n \rightarrow f\) and the domination conditions hold everywhere. Then we have that \(g+f_n\) is a sequence of non-negative measurable functions whose limit is \(g+f\). Applying Fatou's lemma gives

\[ \mu(g+f) \leq \liminf_n \mu(g+f_n) = \mu(g) + \liminf_n \mu(f_n), \]

subtracting \(\mu(g)\) from each side (which we can do as it is finite) gives

\[ \mu(f) \leq \liminf_n \mu(f_n). \]

Similarly \(g-f_n\) is a sequence of non-negative measurable functions whose limit is \(g-f\). Applying Fatou's lemma again gives

\[ \mu(g) - \mu(f) \leq \mu(g) + \liminf_n (-\mu(f_n)) = \mu(g) - \limsup_n \mu(f_n). \]

Rearranging this since all the quantities are finite gives

\[ \limsup_n \mu(f_n) \leq \mu(f). \]

Putting both parts together gives

\[ \mu(f) \leq \liminf_n \mu(f_n) \leq \limsup_n \mu(f_n) \leq \mu(f). \]

Therefore the limit of the sequence \(\mu(f_n)\) exists and is equal to \(\mu(f)\).

The extension of this result to when the conditions only hold almost everywhere is due to the fact that the integrals of any function is unchanged by modifying that function on a measure zero set. This type of result will be discussed in more detail when we introduce \emph{Lebesgue spaces}. It isn't really the point of this particular theorem, we just give the full version here so we are able to apply it.
\end{proof}

The following is a useful criteria for when we can differentiate under the integral sign which also serves as a good example of how to use the dominated convergence theorem.

\begin{theorem}[Differentiation under the integral sign]
Let \((E, \mathcal{E}, \mu)\) be a measure space and \(f: U \times E \rightarrow \mathbb{R}\) be a function such that \(x \mapsto f(t,x)\) is integrable for every \(t\), and \(t \mapsto f(t,x)\) is differentiable for every \(x\), and suppose further that there exists an integrable function \(g(x)\) such that

\[ \left| \frac{\partial f(t,x)}{\partial t} \right| \leq g(x), \quad \forall t \in U \]

then the function \(x \mapsto \partial f(t,x)/ \partial t\) is integrable and the function \(F(t) = \int_E f(t,x) \mu(\mathrm{d}x)\) is differentiable with

\[ \frac{\mathrm{d}F}{\mathrm{d}t} = \int_E \frac{\partial f}{\partial t}(t,x) \mu(\mathrm{d}x). \]

Notice here we are using a different notation for the integral with respect to \(\mu\). We do this because it is helpful to be able to emphasise that we integrate in \(x\) but not \(t\).
\end{theorem}

\begin{proof}
Let \(\epsilon_n\) be an arbitrary sequence which tends towards \(0\). Let

\[ g_n(t,x) = \frac{f(t+\epsilon_n,x) - f(t,x)}{\epsilon_n} - \frac{\partial f}{\partial t}(t,x). \]

First we notice that \(g_n \rightarrow 0\) and \(g_n + \partial f/\partial t\) is measurable so \(\partial f/ \partial t\) is the limit of measurable functions so measurable. By the mean value theorem we have \(|g_n| \leq 2g\) for each \(n\). Therefore, by dominated convergence we have

\[ \int g_n(t,x) \mu(\mathrm{d}x) \rightarrow 0.  \]

This gives the required result.
\end{proof}

We have a couple of useful facts about integration which don't fit into a big section.

\begin{definition}[Restriction of a Measure]
Suppose that \((E, \mathcal{E}, \mu)\) is a measure space and \(A \in \mathcal{E}\) then the set of measurable subsets of \(A\) is a \(\sigma\) algebra we call \(\mathcal{A}\) and the restriction of \(\mu\) to \(\mathcal{E}_A\) is a measure we call \(\mu_A\). Furthermore we have that if \(f\) is a measurable function on \(E\) then \(\mu(f1_A) = \mu_A(f)\).
\end{definition}

\begin{remark}
The last part is actually a lemma whose proof is an exercise.
\end{remark}

We can use this definition to make sense of Lebesgue integrals on intervals (for example). If \(I= [a,b]\) then \(\int_a^b f(x) \mathrm{d}x = \lambda(f1_I)\).

We also notice that we can define a measure using a positive function \(f\).

\begin{proposition}
Let \((E, \mathcal{E}, \mu)\) be a measure space and let \(f\) be a non-negative measurable function. Define \(\nu(A) = \mu(f1_A)\) for each \(A \in \mathcal{E}\). Then \(\nu\) is a measure on \(E\) and for all non-negative \(g\) we have

\[ \nu(g) = \mu(fg) \]
\end{proposition}

\begin{proof}
First we need to show that \(\nu\) is indeed a measure. \(f1_\emptyset = 0\) so we have \(\nu(\emptyset) = 0\) as required. We will also have that \(\nu(A) \geq 0\) since \(f\) is non-negative. We show countable additivity, we note that if \(A\) an \(B\) are disjoin then \(1_{A \cup B} = 1_A + 1_B\) and furthermore if \$A\_1, A\_2, \dots \$ is a sequence of disjoint sets then \(1_{\bigcup_n A_n} = \sum_n 1_{A_n}\). With this reformulation \(\nu(\bigcup_n A_n) = \mu( f1_{\bigcup_n A_n}) = \mu ( \sum_n f1_{A_n})\) using the Beppo-Levi reformulation of monotone convergence we have

\[ \mu(\sum_n f1_{A_n} ) = \sum_n \mu(f1_{A_n}) = \sum_n \nu(A_n), \]

which is our desired result.

Now we want to show that if \(g \geq 0\) then \(\nu(g) = \mu(fg)\). Let us begin with the case where \(g=1_A\) for some measurable \(A\), then \(\nu(g) = \nu(A) = \mu(f1_A) = \mu(fg)\) so the result follows by definition. Then using the linearity of \(\mu\) we can see that if \(g\) is a simple function then \(\nu(g) = \mu(fg)\). Now suppose that \(g\) is not necessarilly simple, we can constuct (in our standard way) a sequence of simple functions, \(g_n\), which increase to \(g\) then by monotone convergence we have that \(\nu(g) = \lim_n \nu(g_n) = \lim_n \mu(f g_n)\). Now \(fg_n\) is a sequence of function which increases to \(fg\) so using monotone convergence we have that \(\lim_n \mu(f g_n) = \mu(fg)\) so we have that \(\nu(g) = \mu(fg)\).
\end{proof}

There are also a few facts about Riemann integration which work in pretty much exactly the same way for Lebesgue integration. For example the fundamental theorem of calculus holds equally well in this case. We will see in general that when something is Riemann integrable it is also Lebesgue integrable which will prove all these in general.

\begin{theorem}[Fundamental theorem of calculus]
Suppose that \(f: [a,b] \rightarrow \mathbb{R}\) is a continuous function and set \(F(t) = \int_a^t f(x) \mathrm{d}x = \lambda( 1_{[a,t]} f)\), then \(F\) is differentiable with \(F'(t) = f(t)\). Furthermore, let \(F: [a,b] \rightarrow \mathbb{R}\) have continuous derivative \(f\), then \(F(b) - F(a) = \int_a^b f(x) \mathrm{d}x\).
\end{theorem}

\begin{proof}
Given \(\epsilon >0\) there exists \(\delta >0\) such that \(|x-t| \leq \delta\) implies that \(|f(x) -f(t)| \leq \epsilon\) therefore if we take \(|h| \leq \delta\) then

\[ \left| \frac{1}{h}(F(t+h) - F(t)) - f(t)\right| = \frac{1}{|h|} \left|\int_t^{t+h}(f(x) - f(t)) \mathrm{d}x\right| \leq \frac{1}{|h|} \int_{t \wedge (t+h)}^{t \vee (t+h)} |f(x) - f(t)| \mathrm{d}x. \]

Now we can use the fact that inside the integral \(|x-t| \leq \delta\) so we have

\[ [\left| \frac{1}{h}(F(t+h) - F(t)) - f(t)\right| \leq \frac{1}{|h|} \int_{t \wedge (t+h)}^{t \vee (t+h)} \epsilon \mathrm{d}x = \epsilon. \]

Therefore \(\lim_{h \rightarrow 0} (F(t+h)-F(t))/h = f(t)\).

In the other direction \(\mathrm{d}/\mathrm{d}t(F(t) - \int_a^t f(x) \mathrm{d}x) = 0\) so \(F(t) - \int_a^t f(x) \mathrm{d}x\) is constant in \(t\) (by the mean value theorem), so \(F(t) = F(a) + \int_a^t f(x) \mathrm{d}x\). This gives us the result.
\end{proof}

We can use the fundamental theorem of calculus to prove the standard result about change of variables. This time we can exploit our new machinery.

\begin{proposition}
Let \(\phi: [a,b] \rightarrow [\phi(a), \phi(b)]\) be continuously differentiable and strictly increasing then for all non-negative \(g\) on \([\phi(a), \phi(b)]\) we have

\[ \int_{\phi(a)}^{\phi(b)}g(y) \mathrm{d}y = \int_a^b g(\phi(x)) \phi'(x) \mathrm{d}x. \]
\end{proposition}

\begin{proof}
First suppose that \(g\) is the indicator function of an interval \((c,d]\) then we want to prove that

\[ \int_{\phi(a)}^{\phi(b)} 1_{(c,d]}(x) \mathrm{d}y = \int_a^b  1_{(c,d]}(\phi(x)) \phi'(x) \mathrm{d}x.\]

Here the left hand side is equal to \([\phi(a), \phi(b)] \cap (c,d]\) and the right hand side is

\[ \int_{a \vee \phi^{-1}(c)}^{b \wedge \phi^{-1}(d)} \phi'(x) \mathrm{d}x,\]

using the fundamental theorem of calculus this is

\[ \phi(b \wedge \phi^{-1}(d)) - \phi(a \vee \phi^{-1}(c)) = \phi(b) \wedge d - \phi(a) \vee c = [\phi(a), \phi(b)] \cap (c,d] \]

where here we used the fact that \(\phi\) was increasing to commute it with min and max.

Now we have shown our proposition holds when \(g\) is the indicator function of a half open interval. By linearity of the integral it will hold when \(g\) is the indicator function of a finite disjoint union of half open intervals. Now let \(\mathcal{D}\) be the set of all Borel sets \(A\) such that \(1_A\) satisfies our proposition. As the name suggests we want to show that \(\mathcal{D}\) is a \(d\)-system. If \(A \subseteq B\) and \(A, B \in \mathcal{D}\) then \(1_{B \setminus A} = 1_B - 1_A\) so the proposition will hold for \(B \setminus A\) by linearity of the integral. Suppose that \(A_1 \subseteq A_2 \subseteq A_3 \dots\) then let \(g_n=1_{A_n}\) then \(g_n \uparrow 1_A\) = g and \(g_n \circ \phi \uparrow g \circ \phi\), as \(\phi\) is increasing so if

\[ \int_{\phi(a)}^{\phi(b)}g_n(y) \mathrm{d}y = \int_a^b g_n(\phi(x)) \phi'(x) \mathrm{d}x \]

for each \(n\) applying monotone convergence to each side gives the result for \(g = 1_A\). This shows that \(\mathcal{D}\) is a \(d\)-system. Applying Dynkin's lemma then shows that for every \(A \in \mathcal{B}(R)\) we have that the proposition holds with \(g=1_A\).

Linearity of the integral allows us to extend this result to any simple function \(g\). We can then use monotone convergence in exactly the same way as for the last part to extend it to any non-negative measurable \(g\).
\end{proof}

The proof method for this last theorem can be generalised using something called the monotone class theorem.

\begin{theorem}[Monotone class theorem - NONEXAMINABLE]
Let \((E, \mathcal{E})\) be a measurable space and let \(\mathcal{A}\) be a \(\pi\)-system generating \(\mathcal{E}\). Then let \(\mathcal{V}\) be a vector space (closed under linear operations) of functions such that
- For every \(A \in \mathcal{A}\) we have \(1_A \in \mathcal{V}\).
- If \(f_n\) is an increasing sequence of positive functions with \(f_n \in \mathcal{V}\) for all \(n\) then \(\lim_n f_n\) is also in \(\mathcal{V}\).

Then \(\mathcal{V}\) contains every bounded measurable function.
\end{theorem}

\begin{proof}
Let \(\mathcal{D} = \{ A \in \mathcal{E} \,:\, 1_A \in \mathcal{V}\}\) then we can show that \(\mathcal{D}\) is a d-sytem in exactly the same way as in the proof of the previous proposition. Therefore by Dynkin's lemma \(\mathcal{D} \supseteq \sigma(\mathcal{A})\) so \(\mathcal{D} = \mathcal{E}\). Hence \(1_A \in \mathcal{V}\) for every \(A \in \mathcal{A}\). By linearity this extends to all simple functions.

Now for any positive function, \(f\), we can construct a sequence of measurable functions converging to \(f\). All these simple functions will be in \(\mathcal{V}\) so our second assumption ensures that \(f\) will be in \(\mathcal{V}\).

Lastly, any bounded measurable function is the difference of two positive measurable functions so will be in \(\mathcal{V}\).
\end{proof}

\hypertarget{agreement-with-riemann-integral}{%
\section{Agreement with Riemann Integral}\label{agreement-with-riemann-integral}}

We now turn our attention to the case wher \(\mu\) is Lebesgue measure, \(\lambda\). We want to show that our new definition of the integral will agree with the Riemann integral when they are both defined. Let us first recall the definitions associated with the Riemann integral.

\begin{definition}
Let \([a,b]\) be an interval in \(\mathbb{R}\) then a finite sequence of real numbers \(\{a_k\}_{k=0}^n\) is called a \emph{partition} of the interval if \(a=a_0 < a_1 < \dots<a_n=b\). I usually denote a partition with a lower case \(p\) or \(q\). You also often see the notation \(\mathscr{P}\).
\end{definition}

\begin{definition}
If we have two partitions \(p = \{a_k\}_{k=0}^n\) and \(q=\{b_j\}_{j=0}^m\) then we say \(q\) is a \emph{refinement} of \(p\) if every element of \(p\) appears in \(q\).
\end{definition}

\begin{definition}
We call a sequence of partitions \((p_n)_{n \geq 1}\) \emph{nested} if for every \(n\) we have that \(p_{n+1}\) is a refinement of \(p_n\).
\end{definition}

\begin{definition}
If we have a partition \(p = \{a_k\}_{k=0}^n\) and a function \(f\) then we can define

\[ m_k = \inf \{ f(x) \,:\, x \in [a_{k-1},a_k] \} \quad \mbox{and}\quad M_k = \sup\{ f(x)\,:\, x \in [a_{k-1},a_k]\}. \]

Then we have the upper sum and lower sum associated to the partition which are defined as

\[ l(f,p) = \sum_{k=1}^n m_k(a_k-a_{k-1}), \quad u(f,p) = \sum_{k=1}^n M_k (a_k-a_{k-1}). \]
\end{definition}

\begin{remark}
We can check that if \(q\) is a refinement of \(p\) then

\[ l(f,p) \leq l(f,q) \leq u(f,q) \leq u(f,p). \]
\end{remark}

\begin{definition}
We call a function \(f\), \emph{Riemann integrable} on \([a,b]\) if \(\sup_p l(f,p) = \inf_q u(f,q)\).
\end{definition}

\begin{lemma}
A function, \(f\), is Riemann integrable if and only if there exists a partition \(p\) such that

\[ u(f,p) - l(f,p) < \epsilon. \]
\end{lemma}

\begin{proof}
First suppose that \(f\) satisfies that for every \(\epsilon\) there exists a \(p\) such that \(u(f,p)-l(f,p) < \epsilon\) then

\[ \inf_q u(f,q) - \sup_q l(f,q) \leq u(f,p)-l(f,p) < \epsilon. \]

Since, \(\epsilon\) is arbitrary this implies

\[ \inf_q u(f,q) = \sup_q l(f,q) \]

and therefore \(f\) is Riemann integrable.

Suppose that \(f\) is Riemann integrable then we know that \(\inf_q u(f,q) = \sup_q l(f,q) = \int f \mathrm{d}x\). Therefore, given \(\epsilon\) there exists \(p_1\) and \(p_2\) so that \(u(f,p_1) \leq \int f \mathrm{d}x + \epsilon/2\) and \(l(f,p_2) \geq \int f \mathrm{d}x - \epsilon/2\). Now let \(p = p_1 \cup p_2\), that is to say the partition made up of all the point in both \(p_1\) and \(p_2\). In this case \(p_1\) and \(p_2\) are both refinements of \(p\), so we have

\[ \int f \mathrm{d}x - \epsilon/2 \leq l(f,p_2) \leq l(f,p) \leq u(f,p) \leq u(f,p_1) \leq \int f \mathrm{d}x + \epsilon/2, \]

so

\[ u(f,p)-l(f,p) < \epsilon. \]
\end{proof}

We need a final Lemma before we prove our theorem

\begin{lemma}
Suppose that \(f: \mathbb{R} \rightarrow \mathbb{R}\) is Lebesgue measurable and \(g = f\) Lebesgue almost everywhere then \(g\) is also Lebesgue measurable.
\end{lemma}

\begin{proof}
Take any Lebesgue measurable set \(B\) and look at \(g^{-1}(B)\) we have that \(g^{-1}(B) = (f^{-1}(B) \cup \{ x\,:\, g(x) \in B, f(x) \notin B\}) \setminus \{ x \, :\, g(x) \notin B, f(x) \in B\}\). Now write \(N = \{ x \,:\, f(x) \neq g(x)\}\), by definition \(\lambda(N) = 0\). We also have that \(\{ x \,:\, g(x) \in B, f(x) \notin B\} \subseteq N\) and \(\{x\,:\, g(x) \notin B, f(x) \in B\} \subseteq N\) so they are both null sets and therefore Lebesgue measurable. As \(f\) is Lebesgue measurable \(f^{-1}(B)\) is Lebesgue measurable. Since \(\mathscr{M}\) is a \(\sigma\)-algebra this implies that \((f^{-1}(B) \cup \{ x\,:\, g(x) \in B, f(x) \notin B\}) \setminus \{ x \, :\, g(x) \notin B, f(x) \in B\}\) is Lebesgue measurable. Therefore \(g\) is Lebesgue measurable.
\end{proof}

\begin{theorem}
Let \([a,b]\) be an interval. Suppose that \(f\) is a function which is Riemann integrable on \([a,b]\), then it is Lebesgue integrable and the Riemann integral agrees with the Lebesgue integral.
\end{theorem}

\begin{proof}
Note first that all Riemann integrable functions are bounded. As \(f\) is bounded we only need to show that it is Lebesgue measurable in order for it to be integrable.
Using the lemma above there exists a nested sequence of partitions \(p_n\) such that \(u(f,p_n) - l(f,p_n) < 1/n\) for each \(n\). Let us define two sequences of functions \(g_n\) and \(h_n\). We write \(p_n = \{ a^n_k \}_{k=0}^{N_n}\), and recall the definition of \(m^n_k\) and \(M^n_k\) associated to the partition. Then we define

\[ g_n:= \sum_{k=1}^{N_n} m^n_k 1_{[a_{k-1}^n, a_k^n)}, \quad h_n :=\sum_{k=1}^{N_n} M^n_k 1_{[a_{k-1}^n, a_k^n)}.\]

Here we can see that \(g_n\) and \(h_n\) are both sequences of simple functions. We also have that \(g_n\) is a monotonically increasing sequence and \(h_n\) is a monotonically decreasing sequence. As \(f\) is bounded so are the sequences \(g_n(x)\) and \(h_n(x)\) for each \(x\) so we define \(g(x) = \lim_n g_n(x)\) and \(h(x) = \lim_n h_n(x)\), these are both bounded, Borel measurable functions. We also have that \(g_n(x) \leq f(x) \leq h_n(x) \leq \sup_{[a,b]} f\) so consequently \(g(x) \leq f(x) \leq h(x)\). We can see that \(\lambda(g_n) = l(f,p_n)\) and \(\lambda(h_n) = u(f,p_n)\). We can use \(\sup_{[a,b]}f\) as a dominating function, so we have by dominated convergence that

\[ \lambda (g) = \lim_n \lambda(g_n) = \lim_n l(f,p_n) = \lim_n u(f,p_n) = \lim_n \lambda(h_n) = \lambda(h). \]

We also have that \(h-g \geq 0\) and \(\lambda(h-g) = 0\) so we know that \(h=g\) Lebesgue almost everywhere and as \(h-f \leq h-g\) we know that \(f=h=g\) almost everywhere. Therefore, \(f\) is almost everywhere equal to a measurable function and it is bounded so is Lebesgue integrable
\end{proof}

We finish this section with some examples of functions which are Lebesgue integrable but are not Riemann integrable. The most classic example of this is

\begin{example}
Let \(f(x) = 1_{\mathbb{Q}}\) then \(f\) is Lebesgue integrable but not Riemann integrable on \([0,1]\) (or any other interval). In order to see that this function is not Riemann integrable we can see that for any partition \(p\) as the rationals an the irrationals are dense in \([0,1]\) then \(l(f,p) =0\) and \(u(f,p) =1\) therefore if we take a seqence of nested partitions \(p_n\) then we wont have the limits of \(l(f,p_n)\) and \(u(f,p_n)\) meeting.
\end{example}

\hypertarget{norms-and-inequalities}{%
\chapter{Norms and inequalities}\label{norms-and-inequalities}}

Let us remember what a normed space is with an emphasis on how this fits in with functions spaces.

\begin{definition}[Normed space]

A normed space is a vector space \(\mathcal{V}\) equipped with a norm, \(\|\cdot\|\), which should satisfy

\begin{itemize}
\tightlist
\item
  \(\| v\| \in \mathbb{R}_+\)
\item
  \(\| \lambda v\| = |\lambda\| \|v\|\)
\item
  \(\|v+u\| \leq \|v\| + \|u\|\)
\item
  \(\|v\|=0\) if and only if \(v=0\).
\end{itemize}

\end{definition}

We are interested in normed spaces of functions, where the norms come from integrating quantites.

\begin{definition}[$L^p(E)$]
Suppose that \((E, \mathcal{E}, \mu)\) is a measure space, and \(p \geq 1\), then we have the associated \(L^p\) space, which is the space of measurable functions equipped with the norm

\[\| f\|_p = \left( \mu(|f|^p)\right)^{1/p}. \]

When we are working on \(\Omega \subseteq \mathbb{R}^d\) with Lebesgue measure we often write the space \(L^p(\Omega)\) to be the set of functions with \(\int_\Omega |f|^p \mathrm{d}x < \infty\). We then often write the norm \(\| \cdot\|_{L^p(\Omega)}\) if we have not previously specified which space we are working in. If we are working with the measure \(\gamma(x) \mathrm{d}x\) for some positive function \(\gamma\) on \(\mathbb{R}^d\) then we write \(L^p(\gamma), \| \cdot\|_{L^p(\gamma)}\). We also call \(L^p(E)\) or \(L^p(\Omega)\) or \(L^p(\gamma)\) the space of measurable functions where the associated norm is finite.
\end{definition}

We also have the supremum norm.

\begin{definition}
Suppose \((E, \mathcal{E}, \mu)\) is a measure space. We have the following norm on measurable functions

\[ \|f\|_\infty = \inf \{ c \,:\, |f| \leq c \, \mbox{almost everywhere}\}. \]

We also call the space \(L^\infty(E)\) the space of all measurable functions on \(E\) with \(\|f\|_\infty < \infty\).
\end{definition}

\begin{remark}
Strictly speaking the norms defined above are seminorms. This is because all these norms will vanish for a function \(f\), where \(f\) is non-zero but is equal to zero almost everywhere. When working in \(L^p\) spaces we consider two functions the same if they are equal almost everywhere.

Strictly speaking we no longer consider functions \(f\) when we work in \(L^p\) spaces we instead consider equivalence classes of functions with the equivalence relation \(f \sim g\) if \(f=g\) almost everywhere. When working in this setting we write \(\mathcal{L}^p\) for the space of measurable function equipped with the \(p\)-seminorm and \(L^p\) for the space of equivalence classes of functions equipped with the \(p\)-norm. Most of the time we wont really think about an element of \(L^p\) as an equivalence class and \emph{hopefully} it quickly becomes natural to think about functions as defined up to alteration on a null set.
\end{remark}

\begin{theorem}
For \(p \in [1,\infty]\) the space \(L^p(E)\) is indeed a vector space.
\end{theorem}

\begin{proof}
We need to show \(f \in L^p(E)\) implies that \(\alpha f \in L^p(E)\) for \(\alpha \in \mathbb{R}\) (or \(\mathbb{C}\)) and \(f, g \in L^p(E)\) implies that \(f+g \in L^p(E)\), specifically we need to show that \(\| \alpha f \|_p < \infty\) and \(\|f+g\|_p < \infty\).

For \(p < \infty\), the first point we can use the linearity of the integral to get

\[ \mu \left( |\alpha|^p |f|^p \right) = |\alpha|^p \mu(|f|^p) < \infty.\]

Now, in a slightly more complex way we have

\[ \int |f(x) + g(x)|^p \mu(\mathrm{d}x) \leq \int \left( 2 \max\{|f(x)|, |g(x)|\}\right)^p \mu(\mathrm{d}x) \leq \int 2^p\left(|f(x)|^p + |g(x)|^p \right) \mu(\mathrm{d}x) \leq 2^p \left( \|f\|_p^p + \|g\|_p^p \right) < \infty. \]

For \(p=\infty\) for the first point it follows immediately from the definition that \(\|\alpha f\|_\infty = |\alpha| \|f\|_\infty < \infty\). For the second point since the union of two null sets is null we have that \(f+g\) is equivalent to a function which is uniformly bounded. Therefore it is clear that \(\|f+g\|_\infty \leq \|f\|_\infty + \|g\|_\infty\).
\end{proof}

\hypertarget{inequalities}{%
\section{Inequalities}\label{inequalities}}

In order to progress further with normed spaces of functions we need to be able to prove the triangle inequality for the \(p\)-norms. This inequality is called \emph{Minkowski's inequality}. In the next section we prove it as well as several other inequalities which are very useful when working with function spaces.

For our first couple of inequalities let us just look at some useful inequalities between real numbers.

\begin{lemma}[Young's inequality (watch out there are at least two things with this name)]
Let \(x\) and \(y\) be two positive real numbers and \(p \in [1, \infty)\) with \(1/p +1/q = 1\) then we have

\[ xy \leq \frac{x^p}{p} + \frac{y^q}{q}. \]
\end{lemma}

\begin{proof}
We can see the inequality holds when either \(x\) or \(y\) are zero so we neglect this case and define \(u = x^p\) and \(v = y^q\). Therefore we want to show that

\[ u^{1/p}v^{1/q} \leq \frac{u}{p} + \frac{v}{q}. \]

As everything is strictly positive we can divide both sides by \(v\), and use the relationship between \(p\) and \(q\), to get

\[ u^{1/p}v^{-1/p} \leq \frac{u/v}{p} + \frac{1}{q}. \]

Now let us define \(t = u/v\), so our orriginal inequality will be true if we can show

\[ t^{1/p} \leq \frac{t}{p} + \frac{1}{q}, \]

or equivalently

\[ \frac{t}{p} + \frac{1}{q} - t^{1/p} \geq 0. \]

We can differentiate this function in \(t\) and get

\[ \frac{\mathrm{d}}{\mathrm{d}t} \left(  \frac{t}{p} + \frac{1}{q} - t^{1/p}\right) = \frac{1}{p}(1- t^{-1/q}) \]

and differentiate a second time to get

\[  \frac{\mathrm{d}^2}{\mathrm{d}t^2} \left(  \frac{t}{p} + \frac{1}{q} - t^{1/p}\right)  =\frac{1}{pq} t^{-1-1/q} >0.\]

So this function achieves a minimum when \(t^{-1/q} = 1\), that is when \(t=1\), and it achieves the minimum value 0. Therefore it is always positive and the inequality holds.
\end{proof}

We also have the very simple corollary which is often useful (especially in Analysis of PDE)

\begin{corollary}
Suppose that \(x,y\) are positive then for every \(\eta >0\) we have

\[ xy \leq \frac{x^p \eta^p}{p} + \frac{y^q}{\eta^q q} \]
\end{corollary}

\begin{proof}
Just write \(xy = (\eta x)(y/\eta)\).
\end{proof}

Using Young's inequality we can prove an inequality about functions.

\begin{proposition}[Hölder's Inequality]
Suppose that \((E, \mathcal{E}, \mu)\) is a measure space and \(f \in L^p(E), g \in L^q(E)\) with \(1/p+1/q =1\) then \(fg \in L^1(E)\) and we have the following inequality

\[ \|fg\|_1 \leq  \|f\|_p \|g\|_q \]
\end{proposition}

\begin{proof}
First let us look at the case where \(f \in L^1(E)\) and \(g \in L^\infty(E)\) without loss of generality let \(g\) be bounded everywhere by \(\|g\|_\infty\) then we have

\[ |f(x)g(x)| \leq |f(x)| \|g\|_\infty \]

and integrating this inequality (using monotonicity) gives the result.

The more complicated case is where \(p \in (1, \infty)\) then we have for each \(\eta >0\) that

\[ |f(x)g(x)| \leq \frac{\eta^p |f(x)|^p}{p} + \frac{|g(x)|^q}{\eta^q q}. \]

Integrating this gives

\[ \|fg\|_1 \leq \frac{\eta^p}{p} \|f\|_p^p + \frac{1}{\eta^q q} \|g\|_q^q. \]

We can then choose \(\eta\) however we want so we choose it to make the right hand side as small as possible. We can find out how best to choose \(\eta\) by differentiating in \(\eta\).

\[ \frac{\mathrm{d}}{\mathrm{d}\eta} \left(\frac{\eta^p}{p} \|f\|_p^p + \frac{1}{\eta^q q} \|g\|_q^q\right) = \eta^{p-1} \|f\|_p^p - \eta^{-q-1} \|g\|_q^q, \]

and

\[ \frac{\mathrm{d}^2}{\mathrm{d}\eta^2} \left(\frac{\eta^p}{p} \|f\|_p^p + \frac{1}{\eta^q q} \|g\|_q^q\right) = (p-1) \eta^{p-2} \|f\|_p^p + (q-1) \eta^{-q-2} \|g\|_q^q>0.\]

So the right hand side of the inequality is smalles when

\[ \eta^{p-1} \|f\|_p^p = \eta^{-q-1} \|g\|_q^q.  \]

Which is when

\[ \eta = \|g\|_q^{q/(p+q)} \|f\|_p^{-p/(p+q)}. \]

Substituting this value of \(\eta\) in gives

\[ \|fg\|_1 \leq \frac{1}{p} \|f\|_p^{p-p^2/(p+q)} \|g\|^{pq/(p+q)} + \frac{1}{q} \|f\|^{pq/(p+q)}_p \|g\|_q^{q-q^2/(p+q)} = \left(\|f\|_p \|g\|_q \right)^{pq/(p+q)},\]

and

\[ pq/(p+q) = \left( (p+q)/pq \right)^{-1} = \left( 1/q + 1/p \right)^{-1} = 1. \]
\end{proof}

\begin{proof}[Second proof of Holder's inequality]
This is the more standard proof suppose first that \(\|f\|_p =1, \|g\|_q = 1\) then using Young's inequality \(|f(x)g(x)| \leq |f(x)|^p/p + |g(x)|^q/q\). So integrating this gives \(\|fg\|_1 = \|f\|^p_p/p + \|g\|^p_q/q = 1/p + 1/q = 1\). Then we have for general \(f,g\) that \(\|f/\|f\|_p\|_p = 1\) and \(\|g/\|g\|_q\|_q = 1\) so

\[ \| fg/ \|f\|_p \|g\|_q\|_1 \leq 1,  \]

and multiplying through gives

\[ \|fg\|_1 = \|f\|_p \|g\|_q.\]
\end{proof}

\begin{remark}[Cauchy-Schwartz Inequality]
The important case of this inequality when \(p=q=2\) is generally known as the Cauchy-Schwartz inequality.
\end{remark}

We also have Minkowski's inequality which as we discussed is necessary to make sure \(L^p\) is a normed space.

\begin{proposition}[Minkowski's Inequality]
Let \((E, \mathcal{E}, \mu)\) be a measure space and suppose that \(f,g\) are in \(L^p\) then

\[ \|f+g\|_p \leq \|f\|_p + \|g \|_p. \]
\end{proposition}

\begin{proof}
We have already shown this when \(p=\infty\), the case where \(p=1\) is also straightforward. We have

\[ |f(x) + g(x)| \leq |f(x)| + |g(x)| \]

and integrating this gives the required inequality.

We now move on to \(p \in (1, \infty)\). We choose \(q\) so that \(1/p + 1/q = 1\) and observe that \(|f + g|^{p-1} \in L^q(E)\) as

\[ |f+g|^{q(p-1)}= |f+g|^p. \]

We also have that \(|f|,|g| \in L^p(E)\). Therefore we have

\begin{align*}\|f+g\|_p^p = \mu(|f+g|^p) &= \mu(|f+g| |f+g|^{p-1}) \\
& \leq \mu(|f| |f+g|^{p-1}) + \mu (|g| |f+g|^{p-1} \\
\mbox{using Hölder's ineq} \quad & \leq \left( \|f\|_p + \|g\|_p\right) \| |f+g|^{p-1}\|_q \\
&= \left( \|f\|_p + \|g\|_p \right) \|f+g\|_p^{p/q}.
\end{align*}

Rearranging this gives

\[ \|f+g\|^{p(1-1/q)} \leq \|f\|_p + \|g\|_p, \]

and we recall that \(p(1-1/q) = 1\).
\end{proof}

Now we move onto some more probabilistically focussed inequalities which do not directly relate to \(L^p\) spaces

\begin{proposition}[Markov's Inequality/ Chebychev's inequality]
Let \((E, \mathcal{E}, \mu)\) be a measure space and \(f\) a non-negative measurable function and \(\lambda>0\). Then we have

\[ \mu(\{ x\,:\, f(x) > \lambda\}) \leq \frac{1}{\lambda} \mu(f). \]
\end{proposition}

\begin{proof}
We have the following inequality

\[ \lambda 1_{\{ f(x) > \lambda\}} \leq f. \]

We then integrate this and use the monotonicity of the integral to get

\[ \lambda \mu(\{ f(x) > \lambda\}) \leq \mu(f). \]
\end{proof}

\begin{remark}[Tail estimates]
On of the powerful consequences of Markov's inequality is that is allows us to estimate how the function will behave at large values. For example suppose that \(f \in L^p(\mathbb{R})\) then we know that

\[ \lambda(\{ x\, :\, |f(x)| > t \} = \lambda (\{ x\,:\, |f(x)|^p > t^p\}) \leq t^{-p} \|f\|_p^p.\]

This is particularly relevant in probability where we are interested in estimating how often extreme events happen and we get inequalities of the form

\[ \mathbb{P}(X > x) \leq x^{-p}\mathbb{E}(X^p). \]
\end{remark}

\begin{remark}[Tchernoff bounds]
Another common use of Markov's inequality is when we know how \(\mu( \exp( \alpha f(x)))\) behaves as we vary \(\alpha\). For example, in a probabilistic setting \(\mathbb{E}(e^{\alpha X})\) is the moment generating function which is often known for distributions. We can then use Markov's inequality via

\[ \mu(\{f(x)> t\}) = \mu( \{ \exp(\alpha f(x)) > e^{\alpha t} \} ) \leq \mu(\exp(\alpha f)) e^{-\alpha t}. \]

Since the left hand side does not depend on \(\alpha\) one can then optimise over \(\alpha\) which will often give a superior bound. An example of this is in the probabilistic setting if \(X\) is a normal random variable on \(\mathbb{R}\) with mean 0 and varaince \(\sigma^2\) then we have

\[ \mathbb{E}\left( e^{\alpha X}\right) = e^{\alpha^2 \sigma^2/2}. \]

This leads to

\[ \mathbb{P}(X> t) \leq e^{\alpha^2 \sigma^2/2-\alpha t}. \]

We can then see that

\[ \alpha^2 \sigma^2/2 - \alpha t = \frac{1}{2}\left(\alpha \sigma - \frac{t}{ \sigma} \right)^2 - \frac{t^2}{2 \sigma^2}, \]

so we can choose \(t= \sigma^2 \alpha\) to get

\[ \mathbb{P}(X > t) \leq e^{-t^2/2\sigma^2}.  \]
\end{remark}

Our last big inequality is Jensen's inequality which involves convexity. We briefly recall the definition of convexity and prove a useful lemma before moving onto the inequality.

\begin{definition}[Convexity]
Let \(I\) be an interval and let \(\phi: I \rightarrow \mathbb{R}\) then we call \(\phi\) \emph{convex} if for every \(t \in [0,1]\), and \(x,y \in I\), we have

\[\phi(tx +(1-t)y) \leq t\phi(x) + (1-t)\phi(y).\]
\end{definition}

\begin{lemma}
Let \(\phi: I \rightarrow \mathbb{R}\) be convex and let \(m\) be a point in the interior of \(I\) then there exists \(a,b\) such that \(ax+b \leq \phi(x)\) for every \(x \in I\) and \(am+b = \phi(m)\).
\end{lemma}

\begin{proof}
Take \(x<m<y\) then by convexity

\[ \phi(m) \leq \frac{y-m}{y-x} \phi(x) + \frac{m-x}{y-x} \phi(y). \]

We can rearrange this to

\[ (y-m + m-x) \phi(m) \leq (y-m) \phi(x) + (m-x) \phi(y), \]

then to

\[ (y-m)(\phi(m)-\phi(x)) \leq (m-x)(\phi(y)-\phi(m)), \]

then to

\[ \frac{\phi(m)-\phi(x)}{m-x} \leq \frac{\phi(y)-\phi(m)}{y-m}. \]

This is true for any \(x,y\) surrounding \(m\) so there exists \(a\) such that

\[  \frac{\phi(m)-\phi(x)}{m-x} \leq a \leq \frac{\phi(y)-\phi(m)}{y-m}, \]

for every such \(x,y\). From this we get that \(\phi(x) \geq a(x-m) + \phi(m)\).
\end{proof}

\begin{proposition}[Jensen's inequality]
Suppose that \((E, \mathcal{E}, \mu)\) is a measure space with \(\mu(E) = 1\) and let \(\phi\) be a convex function from \(\mathbb{R}\) to \(\mathbb{R}\) and \(f\) is an integrable function then \(\phi(f)\) is well defined and

\[ \mu(\phi(f)) \geq \phi(\mu(f)). \]
\end{proposition}

\begin{remark}
This is another inequality where I sometimes have trouble remembering which way the inequality sign goes. My key example to check on is

\[\frac{1}{4} = \left( \int_0^1 x \mathrm{d}x \right)^2 \leq \int_0^1 x^2 \mathrm{d}x = \frac{1}{3}. \]
\end{remark}

\begin{proof}
As \(\mu(E)=1\) we can consider \(\mu(f)\) as the average value that \(f\) takes over \(E\). Using our lemma we have that there exists \(a,b\) such that

\[ ax+b \leq \phi(x), \]

and

\[a\mu(f)+b = \phi(\mu(f)).\]

By the monotonicity of the integral

\[ \mu(af + b) \leq \mu(\phi(f)) \]

and the left hand side is \(a \mu(f) +b \mu(E)= a \mu(f) +b\) by linearity which by construction is equal to \(\phi(\mu(f))\).
\end{proof}

\hypertarget{back-to-lp-spaces}{%
\section{\texorpdfstring{Back to \(L^p\) spaces}{Back to L\^{}p spaces}}\label{back-to-lp-spaces}}

Now we are armed with our inequalities, we want to discuss some properties of \(L^p\) spaces. First let us define convergence in \(L^p\).

\begin{definition}
We say a sequence of functions \(f_n\) converges to another function \(f\) in \(L^p\) if \(\|f_n -f\|_p \rightarrow 0\) as \(n \rightarrow \infty\).
\end{definition}

\begin{theorem}[$L^p(E)$ is complete]
This is for the case \(p<\infty\).
Suppose that \(f_n\) is a sequence in \(L^p\) with \(\|f_n - f_m\|_p \rightarrow 0\) as \(n,m \rightarrow 0\) then there exists an \(f\) in \(L^p\) such that \(\|f_n -f\|_p \rightarrow 0\) as \(n \rightarrow \infty\)
\end{theorem}

\begin{proof}
Let \(n_1 = 1\) and then we can find \(n_k\) recursively such that \(\|f_{n_k}-f_{n_{k-1}}\|_p \leq 2^{-k}\). Then we have that

\[ \sum_k \|f_{n_k}-f_{n_{k-1}}\|_p \leq 1. \]

Choose \(K\) arbirtrary, then by Minkowski's inequality we have

\[ \| \sum_{k=1}^K |f_{n_k}-f_{n_{k-1}}| \|_p \leq  \sum_{k=1}^K \|f_{n_k}- f_{n_{k-1}}\|_p \leq 1.\]

By Monotone convergence we can let \(K \rightarrow \infty\) to get

\[ \| \sum_{k=1}^\infty |f_{n_k} - f_{n_{k-1}}| \|_p \leq 1. \]

Therefore,

\[ \sum_{k=1}^\infty |f_{n_k}(x) -f_{n_{k-1}}(x)| < \infty \]

almost everywhere. This implies that \(f_{n_k}(x)\) is a Cauchy sequence for almost every \(x\). Since we know that \(\mathbb{R}\) is complete, there exists a set \(E'\) with \(\mu(E\setminus E')=0\) such that for every \(x \in E'\) the sequence \(f_{n_k}(x)\). Define

\[ f(x) = \left\{ \begin{array}{ll} \lim_k f_{n_k}(x) & x \in E' \\ 0 & x \notin E' \end{array}\right. \]

Now we have a candidate for our limit, we want to show \(f_n \rightarrow f\) in \(L^p(E)\). Given \(\epsilon >0\) there exists \(N\) such that if \(n, m \geq N\) then \(\|f_n -f_m\|_p \leq \epsilon\). Therefore, for \(k\) sufficiently large and \(n \geq N\) we have \(\|f_n - f_{n_k}\|_p \leq \epsilon\). Now, using Fatou's lemma

\[ \|f_n -f\|_p = \|f_n - \lim_k f_{n_k}\|_p \leq \liminf_k \|f_n - f_{n_k}\|_p \leq \epsilon. \]

Therefore \(\|f_n - f\|_p \rightarrow 0.\)
\end{proof}

\begin{proposition}
Linear combinations of simple functions, step functions (functions of the form \(\phi(x) = \sum_{k=1}^n a_k 1_{(c_k,d_k]}\)), and continuous functions are all dense in the space \(L^p(\mathbb{R}), p \in [1,\infty)\) that is to say for any \(\epsilon > 0\) and any \(f\) in \(L^p(\mathbb{R})\) there is a function \(g\) which is a simple function/step function/ continuous function such that \(\|f-g\|_p \leq \epsilon\).
\end{proposition}

\begin{proof}
The proof for simple functions and step functions is in the fourth assignment. In order to show that it works for continuous functions we notice that the result is true for step functions so for any \(f \in L^p(\mathbb{R})\) and any \(\epsilon >0\) there exists a step function \(\phi\) such that \(\| f-\phi\|_p \leq \epsilon/2\), if we can find a continuous function \(g\) such that \(\|\phi-g\|_p \leq \epsilon/2\) then by Minkowski's inquality \(\|f-g\|_p \leq \|f-\phi\|_p + \|\phi - g\|_p \leq \epsilon/2 + \epsilon/2\).

Now if we look at the indicator function \(1_{(c,d]}(x)\) then let us take

\[ g_{\epsilon, c,d}(x) = \left\{ \begin{array}{ll} 0 & x \notin (c-\epsilon, d+\epsilon) \\ (x-c+ \epsilon)/\epsilon & x \in [c-\epsilon, c) \\ 1 & x \in [c,d) \\ -(x-d -\epsilon)/\epsilon & x \in [d, d+\epsilon) \end{array} \right. \]

Then \(\|g_{c,d,\epsilon}-1_{(c,d]}\|_p \leq 2\epsilon\). Now let \(\phi(x) = \sum_{k=1}^n a_k 1_{(c_k,d_k]}\) and let \(g = \sum_{k=1}^n a_k g_{c_k, d_k, \epsilon/2|a_k| n}\) then

\[ \| \phi - g\|_p \leq \sum_{k=1}^n \| a_k (1_{(c_k, d_k]} - g_{c_k, d_k, \epsilon/2|a_k|n})\|_p \leq \sum_{k=1}^n |a_k| \epsilon/|a_k| n \leq \epsilon.  \]
\end{proof}

\hypertarget{product-measures}{%
\chapter{Product Measures}\label{product-measures}}

In this section we look at taking two measure spaces \((E, \mathcal{E}, \mu)\) and \((F, \mathcal{F}, \nu)\) and defining a \(\sigma\) algebra and a measure on the product space \(E \times F\). This will give us another way of defining Lebesgue measure on \(\mathbb{R}^d\). First we remind ourselves of the definition of Cartesian product.

\begin{definition}[Cartesian product]
If \(E\) and \(F\) are spaces then the Cartesian product \(E \times F\) is the space of twoples \((x,y)\) where \(x \in E\) and \(y \in F\).
\end{definition}

\begin{example}
\(\mathbb{R} \times \mathbb{R} = \mathbb{R}^2\).
\end{example}

Now we want to consider the product \(\sigma\)-algebra.

\begin{definition}
The product \(\sigma\)-algebra \(\mathcal{E} \times \mathcal{F}\) is a \(\sigma\)-algebra on \(E \times F\) which is generated by the collection

\[ \mathcal{A} = \{ A \times B \,:\, A \in \mathcal{E}, B \in \mathcal{F}\}. \]

That is to say \(\mathcal{E} \times \mathcal{F} = \sigma(\mathcal{A}).\)
\end{definition}

We now take some time to look at the projection maps \(\pi_E\) and \(\pi_F\).

\begin{definition}
We define two maps \(\pi_E: E \times F \rightarrow E\) and \(\pi_F: E \times F \rightarrow F\) by

\[ \pi_E (x,y) = x, \quad \pi_F(x,y) = y. \]
\end{definition}

\begin{lemma}
The maps \(\pi_E\) and \(\pi_F\) are both measurable. Furthermore if \(C \in \mathcal{E} \times \mathcal{F}\) then the following sets are measurable

\[ C_x = \{ y \in F \,:\, (x,y) \in C \} = \pi_F\left(\pi_E^{-1}(\{x\}) \cap C\right) \in \mathcal{F} , \quad C_y = \{ x \in E \,:\, (x,y) \in C\} = \pi_E \left( \pi_F^{-1}(\{y\}) \cap C \right). ] \]

Furthermore if \(f: E \times F \rightarrow G\) is a measurable function then \(f_x: F \rightarrow G\) defined by \(f_x(y) = f(x,y)\) and \(f_y: E \rightarrow G\) defined by \(f_y(x) = f(x,y)\) are both measurable functions.
\end{lemma}

\begin{proof}
First let us show that the projection maps are measurable. Let \(A\) be in \(\mathcal{E}\) then \(\pi_E^{-1}(A) = A \times F\), as \(F \in \mathcal{F}\) this is a product set so is in \(\mathcal{E} \times \mathcal{F}\).

Now let us look at \(C_x\). Let \(\mathcal{C}\) be the collection of sets in \(\mathcal{E} \times \mathcal{F}\) such that \(C_x \in \mathcal{F}\). Then \(\mathcal{C}\) contains all the product sets. We now want to show that \(\mathcal{C}\) is a \(\sigma\)-algebra. \((C^c)_x = \{ y \in F \,:\, (x,y) \in C^c\} = \{ y \in F \, :\, (x,y) \notin C\} = F \setminus \{ y \in F\,:\, (x,y) \in C\} = (C_x)^c\). Therefore \(C \in \mathcal{C}\) implies that \(C^c \in \mathcal{C}\). We also have that \(\left(\bigcup_n C_n \right)_x = \bigcup_n \left( (C_n)_x \right)\). Therefore, \(\mathcal{C}\) is closed under complements and countable unions so is a \(\sigma\)-algebra. Therefore \(\mathcal{C} \supset \mathcal{E} \times \mathcal{F}\).

Now we move onto \(f_x\). If \(A \in \mathcal{F}\) then \(f_x^{-1}(A) = \{ y \in F \,:\, f(x,y) \in A\} = (f^{-1}(A))_x\). Using the previous part we know that this is a measurable set. Therefore \(f_x\) is measurable.
\end{proof}

\begin{theorem}[Product Measure]
Given two \(\sigma\)-finite measure spaces \((E, \mathcal{E}, \mu)\) and \((F, \mathcal{F}, \nu)\) there exists a unique measure, \(\mu \times \nu\), on \(\mathcal{E} \times \mathcal{F}\) such that \((\mu \times \nu)(A \times B) = \mu(A)\nu(B)\) when \(A \in \mathcal{E}\) and \(B \in \mathcal{F}\). Furthermore

\[ (\mu \times \nu)(C) = \int_E \nu( C_x) \mu(\mathrm{d}x) = \int_F \mu(C_y) \nu(\mathrm{d}y).\]
\end{theorem}

\begin{proof}
Let us begin in the case where both measure spaces are finite.
As \(\mathcal{A} = \{ A \times B \,:\, A \in \mathcal{E}, B \in \mathcal{F}\}\) is a \(\pi\)-system generating \(\mathcal{E} \times \mathcal{F}\) we can use Carathéodory's extension theorem to prove the first part of this theorem. However we will work directly as defining this measure is straightforward and useful for understanding it.

First we check that \(x \mapsto \nu(C_x)\) and \(y \mapsto \mu(C_y)\) are both measurable functions so the integrals are well defined. Let us begin in the case that \(\nu\) is a finite measure. Let \(\mathcal{C}\) be the collection of sets for which the function \(x \mapsto \nu(C_x)\) is \(\mathcal{E}\) measurable. If \(C = A \times B\) then \(\nu(C_x) = \nu(B)1_{x \in A}\) which is measurable. Now we want to show that \(\mathcal{C}\) is a \(\sigma\)-algebra. If \(C^1 \subset C^2\) then \(\nu((C^2 \setminus C^1)_x) = \nu(C^2_x) - \nu(C^1_x)\) so \(C^2 \setminus C^1 \in \mathcal{C}\). Suppose that \(C^n\) is an increasing sequence of sets in \(\mathcal{C}\) then \(\nu\left( \left(\bigcup_n C^n\right)_x\right) = \lim_n \nu \left( C^n_x\right)\) so \(\bigcup_n C_n\) is in \(\mathcal{C}\). Therefore \(\mathcal{C}\) is a \(\sigma\)-algebra and consequently contains \(\mathcal{E} \times \mathcal{F}\). Now the only reason that we needed \(\nu\) to be finite was to ensure that \(A \times B \in \mathcal{C}\) as otherwise this function might take the value infinity sometimes. You can solve this problem by putting a \(\sigma\)-algebra on \([0,\infty]\) or we can work in the \(\sigma\)-finite setting and let \(\{D_n\}\) be a sequence of disjoint subsets with \(\nu(D_n)< \infty\) whose union is the whole of \(F\). By the argument above \(x \mapsto \nu((C\cap D_n)_x)\) is always measurable (restricting the space to \(D_n\)) and \(\nu(C_x) = \lim_n \sum_{k=1}^n \nu((C \cap D_n)_x)\).

Now we move onto the main part of the proof we can define two different candidates for \((\mu \times \nu)\) namely

\[ (\mu \times \nu)_1(C) = \int_E \nu(C_x) \mu(\mathrm{d}x), \quad (\mu \times \nu)_2(C) = \int_F \mu(C_y) \nu(\mathrm{d}y). \]

We can see that if \(C\) is of the form \(A \times B\) then

\[ (\mu \times \nu)_1(A \times B) = \int_E \nu(B)1_{x \in A} \mu(\mathrm{d}x) = \mu(A) \nu(B) = \int_F \mu(A)1_{y \in B} \nu(\mathrm{d}y) = (\mu \times \nu)_2 (A \times B). \]

Now we know that \((\mu \times \nu)_1\) and \((\mu \times \nu)_2\) agree on a \(\pi\)-system generating \(\mathcal{E} \times \mathcal{F}\) so Dynkin's uniqueness of extension lemma says that they agree on all of \(\mathcal{E} \times \mathcal{F}\).

Now we need to extend to the \(\sigma\)-finite case. There are sequences \(E_n\) and \(F_n\) of sets such that \(\mu(E_n)<\infty, \nu(F_n)< \infty\) for every \(n\) and \(E= \bigcup_n E_n, F = \bigcup_n F_n\). Then we know that \(x \mapsto \nu((C \cap (E_n \times F_n))_x)\) is a measurable function of \(x\) for every \(n\), so letting \(n\) tend to infinity we have \(\nu(C_x) = \lim_n \nu((C \cap (E_n \times F_n))_x)\) so \(x \mapsto \nu(C_x)\) is the limit of measurable functions so measurable. Therefore in the \(\sigma\) finite case we can still define our two candidate measures \((\mu \times \nu)_1\) and \((\mu \times \nu)_2\) and we have that \((\mu \times \nu_1(C) = \lim_n (\mu \times \nu))_1(C \cap (E_n \times F_n)) = \lim_n (\mu \times \nu)_2 ( C \cap (E_n \times F_n)) = (\mu \times \nu)_2 (C)\). So the two measures are equal.

Now let \((\mu \times \nu)_3\) be any other candidate measure on \(E \times F\) such that \((\mu \times \nu)_3 (A \times B) = \mu(A) \nu(B)\). Dynkin's uniqueness of extension theorem tells us that it must be equal to \((\mu \times \nu)\) when restricted to \(E_n \times F_n\) for any \(n\). We can then repeat exactly the same argument as above to extend it to any set in \(\mathcal{E} \times \mathcal{F}\).
\end{proof}

One of the key tools we get when using product measure is Fubini's theorem. There are two theorems one for positive functions, one for integrable functions. The naming gets a bit wooly, but often the theorem for positive functions is called Tonelli's theorem and that for integrable functions is called Fubini's theorem. Sometimes the later is called the Fubini-Tonelli theorem and sometimes both are called Fubini-Tonelli or Fubini. To play it safe I'm going to call both Fubini-Tonelli Theorem.

\begin{theorem}[Fubini-Tonelli theorem for positive functions]
Suppose that \((E, \mathcal{E}, \mu)\) and \((F, \mathcal{F}, \nu)\) are \(\sigma\)-finite measure spaces and \(f\) is a non-negative \(\mathcal{E} \times \mathcal{F}\) measurable function then the functions \(x \mapsto \int_F f(x,y) \nu(\mathrm{d}y)\) and \(y \mapsto \int_E f(x,y) \mu(\mathrm{d}x)\) are both measurable and

\[(\mu \times \nu)(f) = \int_E \left( \int_F f(x,y) \nu(\mathrm{d}y) \right) \nu(\mathrm{d}x) = \int_F \left( \int_E f(x,y) \mu(\mathrm{d}x) \right) \nu(\mathrm{d}y). \]
\end{theorem}

\begin{proof}
We build up the proof gradually, beginning with the case where \(f\) is the indicator function of a set \(C \in \mathcal{E} \times \mathcal{F}\). In this case the measurability of the integrals in \(x\) or \(y\) and the form for \((\mu \times \nu)(f)\) are given by the construction of the product measure in the previous theorem.

The linearity of the integral then imply that the Fubini-Tonelli theorem holds whenever \(f\) is a non-negative simple function, we also can see that \(\int f(x,y) \nu(\mathrm{d}y)\) will be measurable as the previous lemma shows that \(\int 1_{C_x}(y) \nu(\mathrm{d}y)\) is measurable and this is the sum of functions of that form.. We then note that any non-negative measurable function \(f\), can be approximated from below by non-negative simple functions. Let \(f_n\) be a sequence of simple functions approximating \(f\). Then

\[ f_n = \sum_{k=1}^{N_n} c^n_k 1_{C^n_k}, \]

where \(C^n_k \in \mathcal{E} \times \mathcal{F}\). Then we know that

\[ (\mu \times \nu)(f_n) = \int_E \left( \int_F c^n_k 1_{C^n_k}(x,y) \nu(\mathrm{d}y) \right) \mu(\mathrm{d}x) = \int_E \left( \int_F c^n 1_{(C^n_k)_x}(y) \nu(\mathrm{d}y) \right)\mu(\mathrm{d}x). \]

By monotone convergence as \(n \rightarrow \infty\) the left hand side converges to \((\mu \times \nu)(f)\). We can also see that by monotone convergence

\[ \int_F c^n 1_{(C^n_k)_x}(y) \nu(\mathrm{d}y) \uparrow \int_F f(x,y) \nu(\mathrm{d}y). \]

We note that this shows that \(\int_F f(x,y) \nu(\mathrm{d}y)\) is the limit of measurable functions. Consequently, we use monotone convergence again to get that the right hand side converges to

\[ \int_E \left( \int_F f(x,y) \nu(\mathrm{d}y) \right) \mu(\mathrm{d}x). \]

This gives the desired conclusion for positive \(f\).
\end{proof}

\begin{theorem}[Fubini-Tonelli theorem for integrable functions]
Suppose that \((E, \mathcal{E}, \mu)\) and \((F, \mathcal{F}, \nu)\) are \(\sigma\)-finite measure spaces and \(f\) is a \(\mathcal{E} \times \mathcal{F}\) measurable function which is integrable with respect to \((\mu \times \nu)\) then the functions

\[ g(x) = \left\{ \begin{array}{ll} \int_F f(x,y) \nu(\mathrm{d}y) & \int_F|f(x,y)| \nu(\mathrm{d}y) < \infty \\
0 & \int_F |f(x,y)| \nu(\mathrm{d}y) = \infty  \end{array} \right. \]

and

\[ h(y) = \left\{ \begin{array}{ll} \int_E f(x,y) \mu(\mathrm{d}x) & \int_E |f(x,y)| \mu(\mathrm{d}x) < \infty \\
0 & \int_E |f(x,y)| \mu(\mathrm{d}x) = \infty \end{array} \right. \]

are both measurable and integrable. Furthermore,

\[ (\mu \times \nu)(f) = \int_E \left( \int_F f(x,y) \nu(\mathrm{d}y) \right) \nu(\mathrm{d}x) = \int_F \left( \int_E f(x,y) \mu(\mathrm{d}x) \right) \nu(\mathrm{d}y). \]
\end{theorem}

\begin{proof}
Now we turn to the case where \(f\) is not necessarily non-negative but is \((\mu \times \nu)\) integrable. By our result for non-negative functions we know that

\[ (\mu \times \nu)(|f|) = \int_E \left( \int_F |f(x,y)| \nu(\mathrm{d}y) \right) \mu(\mathrm{d}x), \]

which proves that the function \(x \mapsto \int_F |f(x,y)| \nu(\mathrm{d}y)\) is \(\mu\)-integrable, and is consequently finite almost everywhere, therefore restricting the functions \(g,h\) to where they would be finite is not a problem. Let \(A\) be the set on which \(x \mapsto \int_F |f(x,y)| \nu(\mathrm{d}y)\) is finite. Now we write \(f = f_+ - f_-\) in our usual way. Then by definition

\[ \int f(x,y) \nu(\mathrm{d}y)1_{x \in A} =\left( \int f_+(x,y) \nu(\mathrm{d}y) - \int f_-(x,y) \nu(\mathrm{d}y)\right)1_{x \in A}.  \]

Then using the fact that \(\mu(A^c)=0\), and our result for non-negative functions we have

\begin{align*} (\mu \times \nu)(f) = (\mu \times  \nu)(f_+) - (\mu \times \nu)(f_-) &= \int_E \int_F f_+(x,y) \nu(\mathrm{d}y)\mu(\mathrm{d}x) - \int_E \int_F f_-(x,y) \nu(\mathrm{d}y) \mu(\mathrm{d}x) \\
&= \int_E \left( \int_F f_+(x,y) \nu(\mathrm{d}y) - \int_F f_-(x,y) \nu(\mathrm{d}y) \right)1_{x \in A} \mu(\mathrm{d}x) \\
&= \int_E \left( \int_F f(x,y) \nu(\mathrm{d}y) 1_A\right) \mu(\mathrm{d}x)\\
&= \int_E \int_F f(x,y) \nu(\mathrm{d}y) \mu(\mathrm{d}x).
\end{align*}
\end{proof}

\hypertarget{applications-of-product-measure-and-fubinis-theorem}{%
\section{Applications of product measure and Fubini's theorem}\label{applications-of-product-measure-and-fubinis-theorem}}

This section is a collection of examples and applications of product measure and Fubini's theorem

\begin{example}
Suppose \((E, \mathcal{E}, \mu)\) is a measure space we look at its product with \((\mathbb{R}, \mathcal{B}(\mathbb{R}), \lambda)\) and suppose that \(f:E \rightarrow \mathbb{R}\) is a non-negative measurable, then the set

\[ A = \{(x,y) \,:\, 0 \leq y \leq f(x) \} \]

is measurable with the product \(\sigma\)-algebra and its measure is the \emph{area under the graph} of \(f\). We have that

\[ (\mu \times \lambda)(A) = \mu( \lambda(A_x)) = \mu(f),  \]

and

\[ (\mu \times \lambda)(A) = \lambda( \mu(A_y)) = \lambda (\{ x \,:\, f(x) \geq y \}) = \int_0^ \infty \mu(\{x \,:\, f(x) \geq y\}) \mathrm{d}y. \]
\end{example}

\begin{example}[Convolutions]
Suppose that both \(f\) and \(g\) are in \(L^1(\mathbb{R})\) then for almost every \(x\) the function \(t \mapsto f(x-t) g(t)\) is also in \(L^1(\mathbb{R})\). We have that the function \(f*g\) defined by

\[x \mapsto \left\{ \begin{array}{ll} \int_{\mathbb{R}} f(x-t)g(t) \mathrm{d}t & \mbox{if}\, t \mapsto f(x-t)g(t)\, \mbox{is Lebesgue integrable} \\
0 & \mbox{Otherwise} \end{array}\right. \]

is in \(L^1\) and satisfies \(\|f*g\|_1 \leq \|f\|_1 \|g\|_1\).

We can prove this using Fubini-Tonelli. First we want to check that \(t \mapsto f(x-t)g(t)\) is measurable. Write \(h(t) = x-t\) this continuous function (for fixed \(x\)) and \(t \mapsto f(x-t) = f(h(t))\) so it is the composition of two measurable functions so measurable. We also know that the product of two measurable functions is measurable to \(f(x-t)g(t)\) is a measurable function of \(t\). Now we want to check that it is integrable

\[ \int \left| \int f(x-t)g(t) \mathrm{d}t \right| \mathrm{d}x \leq \int \int |f(x-t)g(t)| \mathrm{d}t \mathrm{d}x \]

as \(f(x-t)g(t) \leq |f(x-t)g(t)|\) and \(-f(x-t)g(t) \leq |f(x-t)g(t)|\). Now we apply Fubini-Tonelli and get

\[ \int \int |f(x-t)g(t)| \mathrm{d}t \mathrm{d}x = \int \left( \int |f(x-t)| \mathrm{d}x\right) |g(t)| \mathrm{d}t = \int \|f\|_1 |g(t)| \mathrm{d}t = \|f\|_1 \|g\|_1. \]
\end{example}

We can also show that convolutions of functions are continuous functions using the tools from measure theory. For this we need to show that shifts are continuous in \(L^1\).

\begin{lemma}
Define the map \(T_\tau: L^p(\mathbb{R}) \rightarrow L^p(\mathbb{R})\) by \((T_\tau f)(x) = f(x+ \tau)\) then

\[ \lim_{\tau \rightarrow 0}\|T_\tau f - f\|_p = 0. \]
\end{lemma}

\begin{proof}
We want to show that for any \(\epsilon\) there exists \(\tau_*\) such that if \(\tau \leq \tau_*\) then \(\|T_\tau f-f\|_p \leq \epsilon\). First let us show the result for step functions, that is to say functions of the form

\[ \phi(x) = \sum_{k=1}^n a_k 1_{[c_k, d_k)}.\]

First by Minkowski's inequality we have

\[ \| T_\tau \phi - \phi\|_p \leq \sum_{k=1}^n |a_k| \| T_\tau 1_{[c_k, d_k)} - 1_{[c_k, d_k)}\|_p  = \sum_{k=1}^n |a_k| \lambda ([c_k + \tau, d_k + \tau) \Delta [c_k, d_k) \leq \sum_{k=1}^n |a_k| 2|\tau|.\]

Therefore we can make \(\tau\) small enough so that this is less than \(\epsilon\).

Now let us look at a general \(f\) we know (from Assignment 4) that there is a step function \(\phi\) such that \(\|f-\phi\|_p \leq \epsilon/3\). We also can change variables \(x \leftrightarrow x+\tau\) so \(\|T_\tau f - T_\tau \phi\|_p = \left( \int |f(x+\tau) - \phi(x+\tau)|^p \mathrm{d}x\right)^{1/p} = \|f-\phi\|_p\) for any \(\tau\). For this \(\phi\) we can find \(\tau\) sufficiently small such that \(\|T_\tau \phi - \phi\|_p \leq \epsilon/3\). Hence

\[ \|T_\tau f - f\|_p  \leq \|T_\tau f - T_\tau \phi\|_p + \| T_\tau \phi - \phi\|_p + \| \phi - f\|_p \leq \epsilon. \]
\end{proof}

Now we go back to convolutions, we can show that if \(f, \in L^p(\mathbb{R})\) and \(g \in L^q(\mathbb{R})\) then \(f*g\) is continous.

\[ |f*g(y) - f*g(x)| = |\int_{\mathbb{R}}(f(x-t) - f(y-t)) g(t) \mathrm{d}t| \leq \int_{\mathbb{R}} |f(x-t)-f(y-t)||g(t)| \mathrm{d}t  \]

we can bound this using Hölder's inequailty by

\[ \|g\|_q \left(\int |f(x-t) - f(y-t)|^p\mathrm{d}t\right)^{1/p} = \|g\|_q \left(\int |f(t-x+y) - f(t)| \mathrm{d}t\right)^{1/p} = \|g\|_q \| T_{-x+y} f - f\|_p. \]

So if \(|x-y|\) is small enough then \(|f*g(x) - f*g(y)|\) will also be small.

\hypertarget{radon-nikodym-theorem}{%
\chapter{Radon-Nikodym Theorem}\label{radon-nikodym-theorem}}

\hypertarget{signed-measures}{%
\section{Signed measures}\label{signed-measures}}

We introduce the notion of signed measures which will be useful in the proof of the Radon-Nikodym theorem.

\begin{definition}[Finite signed measure]

A function \(\mu\) from a \(\sigma\)-algebra \(\mathcal{E}\) to \(\mathbb{R}\) is a \emph{finite signed measure} if

\begin{itemize}
\tightlist
\item
  \(\mu(\emptyset) = 0\),
\item
  If \((A_n)_{n \geq 1}\) is a sequence of disjoint sets then \(\mu (\bigcup_n A_n) = \sum_n \mu(A_n)\)
\end{itemize}

\end{definition}

\begin{example}
If \((E, \mathcal{E}, \mu)\) is a measure space and \(f \in L^1(E)\) then \(\nu\) defined by \(\nu(A) = \mu(f1_A)\) is a signed measure.
\end{example}

We want to show two decomposition theorems which basically allow us to reduce the situation back to measures. First we need some more definitions and a useful Lemma.

\begin{definition}
If \((E, \mathcal{E})\) is a measurable space and \(\nu\) is a finite signed measure then we call \(A\) a \emph{positive set} if for every \(B \in \mathcal{E}\) with \(B \subseteq A\) then \(\nu(B) \geq 0\). The \emph{negative sets} are defined analogously.
\end{definition}

\begin{lemma}
Suppose that \(\nu\) is a finite signed measure on \((E, \mathcal{E})\) and suppose \(A \in \mathcal{E}\) with \(\nu(A) <0\) then there exists a negative set \(B\) with \(B \subseteq A\) and \(\nu(B) \leq \nu(A)\).
\end{lemma}

\begin{proof}
We will produce this set \(A\) by an itterative process, define

\[ \delta_1 = \sup \{ \nu(C) \,:\, C \subseteq A\}, \]

then since \(\emptyset \subseteq A\) we have that \(\delta_1 \geq 0\). If \(\delta_1 = 0\) then we have a negative set so are done. If not we can find a set \(C_1 \subseteq A\) with

\[ \nu(C_1) \geq \min\{\delta_1/2 ,1\}. \]

(We take the minimum here because we don't know that \(\delta_1\) is finite.) Now we will define a sequence of \(\delta_n\) and \(C_n\) by setting

\[ \delta_n = \sup\{ \nu(C) \,:\, C \subseteq (A \setminus \bigcup_{i=1}^{n-1}C_i)\} \]

and \(C_n \subseteq A\) a set so that \(C_n \cap \left( \bigcup_{i=1}^{n-1}C)i\right) = \emptyset\) and

\[ \nu(C_n) \geq \min\{ \delta_n /2 ,1\}. \]

Now let \(C_\infty = \bigcup_n C_n\) and \(B = A \setminus C_\infty\). We now need to check that \(B\) has the required properties,

\[ \nu(A) = \nu(C_\infty) + \nu(B) \geq \nu(B), \]

as \(\nu(C_\infty) \geq 0\) by construction.
As \(\nu\) is a finite measure we must have \(\nu(C_\infty) < \infty\) and as the \(C_n\) are constructed to be disjoint this means we must have \(\lim_n \nu(C_n) = 0\). Therefore \(\lim_n \delta_n = 0\). If \(D \subseteq B\) then we must have that \(\nu(D) \leq \delta_n\) for every \(n\), therefore \(\nu(D) \leq 0\).
\end{proof}

Now we are able to state and prove our two decomposition theorems.

\begin{theorem}[Hahn Decomposition theorem]
Let \((E, \mathcal{E})\) be a measure space and \(\nu\) a finite signed measure. Then there exists a positive set \(P\) and a negative set \(N\) for \(\nu\) such that \(E = P \cup N\).
\end{theorem}

\begin{proof}
Let \[L = \inf\{ \nu(A)\,:\, \mbox{$A$ is a negative set for $\nu$}\}\] then \(L\) is finite as otherwise we could construct a set with measure \(-\infty\). Then let \(A_n\) be a negative set with \(\nu(A_n) \leq L+1/n\) then let \(N = \bigcup_n A_n\).

We can check that \(N\) is a negative set and that \(\nu(N) = L\). If \(A \subseteq N\) then let \(B_n = A_n \setminus \bigcup_{k=1}^{n-1}A_k\) then \(A = \bigcup_n (A \cap B_n)\) and \(A \cap B_n \subseteq A_n\) so \(\nu(A \cap B_n) \leq 0\) and \(\nu(A) = \sum_n \nu(A \cap B_n) \leq 0\). Now since \(N\) is a negative set \(\nu(N \setminus A_n) \leq 0\), therefore \(\nu(N) = \nu(N \setminus A_n) + \nu(A_n) \leq \nu(A_n) \leq L +1/n\). This is true for any \(n\) so \(\nu(N) \leq L\) and since \(L\) is defined to be the infinmum over \(\nu(A)\) for all negative sets \(A\), we will have \(\nu(N) \geq L\), therefore \(\nu(N) = L\).

Let \(P = N^c\) we want to check that \(P\) is a positive set. Suppose there exists a set \(A \subseteq P\) with \(\nu(A) < 0\), then by our lemma there exists a negative set \(B \subseteq A\) with \(\nu(B) \leq \nu(A)<0\). Then \(N \cup B\) is a negative set and \(N\) and \(B\) are disjoint so \(\nu(N \cup B) = \nu(N) + \nu(B) < \nu(N)\) which contradicts the fact that \[\nu(N) = L = \inf\{ \nu(A)\,:\, \mbox{$A$ is a negative set for $\nu$}\}\] so we are done.
\end{proof}

\begin{theorem}[Jordan decompostion theorem]
Every finite signed measure is the difference of two positive measures. Precisely, if \((E, \mathcal{E})\) is a measure space and \(\nu\) is a signed measure then there exist measures \(\nu_+\) and \(\nu_-\) such that for every \(A \in \mathcal{E}\) we have \(\nu(A) = \nu_+(A)- \nu_-(A)\).
\end{theorem}

\begin{proof}
Take some Hahn decomposition \((P, N)\) then let \(\nu_+(A) = \nu(A \cap P)\), as \(A \cap P \subseteq P\) then \(\nu(A \cap P) \geq 0\). Similarly let \(\nu_-(A) = -\nu(A \cap N)\). By additivity of \(\nu\) we have that \(\nu(A) = \nu_+(A) - \nu_-(A)\). Countable additivity of \(\nu_+\) and \(\nu_-\) follow immediately from countable additivity of \(\nu\).

Now we notice that if \(B \subseteq A\) then

\[ \nu(B) = \nu_+(B) - \nu_-(B) \leq \nu_+(B) \leq \nu_+(A) \]

and \(\nu_+(A) = \nu(A \cap P)\) therefore we have that

\[ \nu_+(A)  = \sup\{\nu(B) \,:\, B \subseteq A, B \in \mathcal{E}\} \]

in the same way

\[ \nu_-(A) = \sup\{ - \nu(B) \,:\, B \subseteq A, B \in \mathcal{E}\}. \]

This shows that the values of \(\nu_+, \nu_-\) do not depend on the particular choice of Hahn decomposition.
\end{proof}

\hypertarget{absolute-continuity}{%
\section{Absolute Continuity}\label{absolute-continuity}}

We now move on to the main focus of this section, the Radon-Nikodym theorem. In order to understand the theorem we need a definition.

\begin{definition}
Let \((E, \mathcal{E})\) be a measurable space and \(\mu\) and \(\nu\) be two measures then we say that \(\nu\) is absolutely continuous with respect to \(\mu\) of \(\nu \ll \mu\) if for every \(A \in \mathcal{E}\) with \(\mu(A) = 0\) we also have \(\nu(A) = 0\).
\end{definition}

We can characterise absolute continuity

\begin{lemma}
Suppose that \((E, \mathcal{E})\) is a measurable space and \(\mu\) a measure, \(\nu\) a finite measure then \(\nu \ll \mu\) if and only if for earch \(\epsilon >0\) there exists a \(\delta>0\) such that \(\mu(A) < \delta\) implies that \(\nu(A) < \epsilon\).
\end{lemma}

\begin{proof}
First let us suppose there exists such at \(\delta\) for each \(\epsilon\), then if \(\mu(A) = 0\) we have that \(\mu(A)< \delta\) for every \(\delta\) so we must have \(\nu(A) < \epsilon\) for every \(\epsilon\) so \(\nu(A) =0\).

Now let us suppose that \(\nu \ll \mu\). We prove the result by contradiction. Suppose there exists an \(\epsilon\) such that for every \(\delta\) there exists a set \(A\) with \(\mu(A)< \delta\) but \(\nu(A) >\epsilon\). Then we can find a sequence of sets \(A_k\) such that \(\mu(A_k) < 2^{-k}\) but \(\nu(A_k) \geq \epsilon\). By the first Borel-Cantelli lemma we have that

\[ \mu \left( \bigcap_n \bigcup_{m \geq n} A_m \right) = 0. \]

We also have that \(\nu(\bigcup_{m \geq n} A_m) \geq \nu(A_n) \geq \epsilon\) and

\[\nu \left( \bigcap_n \bigcup_{m \geq n} A_m\right) = \lim_n \nu \left( \bigcup_{m \geq n} A_m \right) \geq \epsilon. \]

This show gives us a set with \(\mu(B) = 0\) but \(\nu(B) > 0\) which contradicts \(\nu \ll \mu\).
\end{proof}

Now we can prove the main theorem for this section.

\begin{theorem}[Radon-Nikodym Theorem]
Let \((E, \mathcal{E})\) be a measure space and let \(\mu, \nu\) be two finite measures with \(\nu \ll \mu\). Then there exists a measurable function \(g: E \rightarrow [0, \infty)\) such that \(\nu(A) = \mu(g1_A)\). The function \(g\) is unique up to identifying almost everywhere equal functions. We write \(g = \mathrm{d}\nu/\mathrm{d}\mu\) and call it the Radon-Nikodym derivative of \(\nu\) with respect to \(\mu\).
\end{theorem}

\begin{proof}
Let us define the set \(\mathcal{F}\) which is the set of all measurable functions, \(f\), with \(\mu(f1_A) \leq \nu(A)\) for every \(A \in \mathcal{E}\). The idea is that \(\mathcal{F}\) contains a function \(g\) which achieves \(\mu(g) = \sup_{f \in \mathcal{F}} \mu(f)\).

As a first step we show that \(f_1 \vee f_2 = \max\{ f_1, f_2\} \in \mathcal{F}\) when \(f_1, f_2 \in \mathcal{F}\). Let us take any \(A \in \mathcal{E}\) then let \(A_1 = A \cap \{ f_1 \geq f_2\}\) and \(A_2 = A \cap \{ f_1 < f_2\}\). Then

\[ \mu(f_1 \vee f_2 1_A) = \mu(f_1 \vee f_2 1_{A_1}) + \mu(f_1 \vee f_2 1_{A_2}) = \mu(f_1 1_{A_1}) + \mu(f_2 1_{A_2}) \leq \nu(A_1) + \nu(A_2) = \nu(A).  \]

Therefore \(f_1 \vee f_2 \in \mathcal{F}\).

Now take a sequence \(f_n\) such that \(\mu(f_n) \geq \sup_{f \in \mathcal{F}} \mu(f) - 1/n\). Then let \(g_n = f_1 \vee f_2 \vee \dots \vee f_n\), so that the sequence of function \(g_n\) is increasing and \(\mu(g_n) \geq \sup_{f \in \mathcal{F}} \mu(f) - 1/n\). Then as \(g_n\) is increasing it has a limit \(g\) and the monotone convergence theorem shows that

\[ \mu(g1_A) = \lim_n \mu(g_n1_A) \leq \nu(A). \]

So \(g \in \mathcal{F}\).

Now we can define another positive measure \(\nu_0(A) = \nu(A) - \mu(g1_A)\). We want to show that \(\nu_0 =0\) and will do this by contradiction. Suppose that there exists \(A \in \mathcal{E}\) such that \(\nu_0(A)>0\) then by monotonicity we will have \(\nu_0(E) >0\) and since \(\mu\) is a finite measure there exists a number \(\epsilon >0\) such that \(\nu_0(E) > \epsilon \mu(E)\). Now \(\nu_0 - \epsilon \mu\) is a finite signed measure. Let \((P, N)\) be a Hahn decomposition for this signed measure. Then \((\nu_0 - \epsilon \mu)(A \cap P) \geq 0\) so \(\nu_0(A\cap P) \geq \epsilon \mu(A \cap P)\). Hence we have

\begin{align*}
\nu(A) &= \mu(g1_A) + \nu_0(A) \geq \mu(g1_A) + \nu_0(A \cap P) \\
& \geq \mu(g1_A) + \epsilon \mu(A \cap P) = \mu(1_A(g +\epsilon 1_{P})).
\end{align*}

We also have that \(\mu(P) >0\) as if \(\mu(P) = 0\) then we would have \(\nu_0(P)=0\) as \(\nu_0 \ll \nu \ll \mu\), and this would mean

\[ (\nu_0 - \epsilon \mu)(E) = (\nu_0 - \epsilon \mu)(N) \leq 0, \]

which would contradict \(\nu_0(E) > \epsilon \mu(E)\). Therefore, \(g+ \epsilon 1_P\) belongs to \(\mathcal{F}\) but \(\mu(g+1_P) > \mu(g)\) which contradicts the fact that \(g\) achieves \(\mu(g) = \sup_{f \in \mathcal{F}} \mu(f)\). Hence \(\nu(A) = \mu(g1_A)\).

Now we turn to uniqueness suppose that we have two positive functions \(g,h\) such that \(\nu(A) = \mu(g1_A) = \mu(h1_A)\) for every \(A\), then as \(\nu\) is finite \(g\) and \(h\) are integrable so \(g-h\) is integrable and \(\mu((g-h)1_A) = 0\) for every \(A\). As \(g-h\) is measurable then \(\{x \in E\,:\, g-h \geq 0\}\) is a measurable set so \(\mu((g-h)1_{\{x \in E\,:\, g-h \geq 0\}}) = 0\). This shows that \((g-h)1_{\{x \in E\,:\, g-h \geq 0\}} = 0\) almost everywhere. In the same way \((g-h)1_{\{ x \in E\,:\, g-h \leq 0\}} =0\) almost everywhere. Therefore \(g=h\) \(\mu\)-almost everywhere.
\end{proof}

\hypertarget{duality-in-lp-spaces---nonexaminable}{%
\section{\texorpdfstring{Duality in \(L^p\) spaces - NONEXAMINABLE}{Duality in L\^{}p spaces - NONEXAMINABLE}}\label{duality-in-lp-spaces---nonexaminable}}

The goal of this section is to prove that if \(1/p+1/q =1\) then the dual space of \(L^p(E)\) is isomorphic to the space \(L^q(E)\). First let us define a dual space.

\begin{definition}
Let \(\mathcal{V}\) be a Banach space (a complete, normed vector space) then the dual space of \(\mathcal{V}\) is written \(\mathcal{V}'\) and is the space of all bounded linear operators from \(\mathcal{V}\) to \(\mathbb{R}\). We recall that we call an operator \(K\) on \(\mathcal{V}\) bounded if \(|K(v)| \leq C\|v\|\) for all \(v \in \mathcal{V}\). We can define a norm on \(\mathcal{V}'\) by \(\|K\| = sup_{\|v\| =1}|K(v)|\).
\end{definition}

The first thing to note is that if \(g \in L^q(E)\) then we can define a bounded linear operator on \(L^p(E)\) by \(K_g(f) = \mu(fg)\). This is bounded by Hölder's inequality \(|\mu(fg)| \leq \mu(|fg|) = \|fg\|_1 \leq \|f\|_p \|g\|_p\). It is also linear thanks to the linearity of the integral. Therfore we can produce a map from \(L^q(E) \rightarrow (L^p(E))'\) by \(g \mapsto K_g\).

\begin{theorem}
Let \((E, \mathcal{E}, \mu)\) be a finite measure space and \(p \in (1, \infty)\). The dual space of \(L^p(E)\) is \(L^q(E)\) where \(1/p +1/q = 1\). Furthermore the map defined by \(g \mapsto K_g\) is an isometry.
\end{theorem}

\begin{remark}
This result also holds for arbitrary measure spaces (without the finite assumption). Extending to \(\sigma\)-finite measure spaces is relatively straightforward and then to any measure space is more complicated.
\end{remark}

\begin{proof}
Remark: This result is similar in spirit to the Riesz representation result that was a non-examinable topic in week 6.

First we note that the map \(g \mapsto K_g\) is linear and \(\|K_g\|_{(L^p)'} \leq \|g\|_q\). Therefore the map is injective we want to show that \(\|K_g\| = \|g\|\) and that it is surjective.

First for the fact that \(\|K_g\| = \|g\|\) we look at the function \(f(x) = sgn(g)|g(x)|^{q-1}\) then \(\mu(|f|^p) = \mu(|g|^q) < \infty\). Therefore we can look at the action of \(K_g\) on \(f\) and we have \(K_g(f) = \mu(|g|^q)\) so we know that \(\|K_g\| \geq K_g(f)/\|f\|_p = \mu(|g|^q)/\mu(|g|^q)^{1/p} = \mu(|g|^q)^{1-1/p} = \|g\|_q\). Therefore \(g \mapsto K_g\) preserves norms.

Now we want to show that this map is surjective. Let us take \(K\) an arbitrary element of \((L^p(E))'\). Since \(\mu(E) < \infty\), \(1_A \in L^p(E)\) for every \(A \in \mathcal{E}\) so we can define a function on \(\mathcal{E}\) by \(k(A)=K(1_A)\). We want to show that \(k\) is a signed measure. \(k(\emptyset)=K(0)=0\) and let \(A_1,A_2,\dots\) be a sequence of disjoint measurable sets. Then \(1_{\bigcup_{j=1}^n A_j} = \sum_{j=1}^n 1_{A_j}\) then \(k(\bigcup_{j=1}^n A_j) = K(1_{\bigcup_{j=1}^n A_j}) = K( \sum_{j=1}^n 1_{A_j}) = \sum_{j=1}^n K(1_{A_j}) = \sum_{j=1}^n k(A_j)\). We also have that \(\| 1_{\bigcup_j A_j} - 1_{\bigcup_{j=1}^n A_j} \|_p \rightarrow 0\) as \(n \rightarrow 0\). Therefore, as \(K\) is a continuous map on \(L^p\) we have \(K(1_{\bigcup_n A_n}) = \sum_n K(1_{A_n})\), so \(k(\bigcup_n A_n) = \sum_n k(A_n)\) Therefore \(k\) is indeed a signed measure. By the Hahn decomposition and the Jordan decomposition we can write \(k = k_+ - k_-\) and there exists \(P \cup N\) a Hahn decomposition with \(k\) being positive on \(P\) and negative on \(N\).

Next we want to show that \(k_+ \ll \mu\) and \(k_- \ll \mu\). If \(A \in \mathcal{E}\) is such that \(\mu(A) = 0\) then \(\mu(A \cap P)=0\) and \(\mu(A \cap N) = 0\) and as \(1_{A \cap P}= 0 \mu\)-a.e. we have \(K(1_{A \cap P}) = K(0) = 0\) and \(K(1_{A \cap N}) = K(0) = 0\). Therefore \(k_+(A) = 0\) and \(k_-(A) = 0\).

Then by the Radon-Nikodym theorem there exists functions \(g_+\) and \(g_-\) such that \(k_+(A) = \mu(g_+1_A)\) and \(k_-(A) = - \mu(g_- 1_A)\). Now let \(g = g_+ - g_-\) we want to show that \(g \in L^q\) and that \(K = K_g\). This is complicated!

Let us define \(E_n\) by \(E_n = \{ x \,:\, |g(x)| \leq n\}\) then \(g1_{E_n}\) is bounded and so in \(L^q\) as \(\mu\) is finite. Then define a linear functional on \(L^p\) by \(K_n(f) = \mu(fg1_{E_n})\) and another by \(\tilde{K}_n (f) = K(f1_{E_n})\). Then if \(A\) is a measurable set we have \(K_n (1_A) = \tilde{K}_n (1_A)\), by linearity if \(h\) is a simple function then \(K_n(h) = \tilde{K}_n(h)\).

We showed in Assignment 4 that given a function \(f \in L^p, \epsilon >0\) there exists a simple function \(h\) with \(\|f-h\|_p \leq \epsilon\). Then we have that
\[ |K_n(f) - \tilde{K}_n(f)| \leq |K_n(f) - K_n(h)| + |\tilde{K}_n(f) - \tilde{K}_n (h)| \leq \|K\| \|f-h\|_p + \|g1_{E_n}\|_q \|f-h\|_p \leq (\|K\| + \|g\|_q) \epsilon.\] Since \(\epsilon\) is arbitrary this shows that \(K_n(f) = \tilde{K}_n(f)\). \(\tilde{K}_n(f) = K_{g1_{E_n}}(f)\) so by our isometry we have \(\|\tilde{K}_n\| = \|g1_{E_n}\|_q\). We also have that \(\|\tilde{K}_n\| \leq \|K\|\) as
\(\| \tilde{K}_n\| = \sup_{\|f\|_p =1} K_n(f) = \sup_{\|f\|_p = 1} K(f1_{E_n}) \leq \sup_{\|f\|_p=1} K(f) = \|K\|\). Therefore \(\|g1_{E_n}\|_q \leq \|K\|\) therefore \(\|g1_{E_n}\|_p^p = \int |g|^p 1_{E_n} \mu(\mathrm{d}x)\) and then by monotone convergence we get that \(\|g\|_q = \lim_n \|g 1_{E_n}\|_q \leq \|K\|\). Therefore, \(g \in L^q\). Then by exactly the same argument with which we showed \(K_n = \tilde{K}_n\) we have that \(K = K_g\). This concludes the proof in the finite case.

Extending to the sigma finite case works very similarly to previous results.
\end{proof}

\hypertarget{summary-of-the-course-and-list-of-important-theorems}{%
\chapter{Summary of the course and list of important theorems}\label{summary-of-the-course-and-list-of-important-theorems}}

This section is primarily intended to help you prepare for the exam. Questions on the exam are split into three types (only visible on the solutions). These are bookwork, seen and unseen.

Bookwork comprises material I expect you to know by heart, or be able to reproduce to look like that in the course. This includes all definitions and the statements and proofs of most named theorems in the course. I'm afraid measure theory is a naturally bookwork heavy course. I'm not expecting you to learn all of these by heart but I am hoping you will be able to reproduce the majority of any proof in the exam. Look at previous exams to get an idea of what is expected.

Seen material includes everything in the lecture notes, assignments or exercise sheets which isn't bookwork. I expect you to find it easier to answer questions where you have seen the question or something almost identical before. Therefore its helpful to be familiar with all this before the exam.

Unseen material will be problem based questions that are similar, but substantially different, to questions on the exercise sheets or worked examples, or theorems from the course.

Below is a list of the key material from the course. Anything which is a definition should be considered bookwork, or anything where I've written +proof, should be considered bookwork. I've also recorded some results where I expect you to know the statement but not the theorem.

\hypertarget{sigma-algebras-and-measures}{%
\section{Sigma algebras and measures}\label{sigma-algebras-and-measures}}

\begin{itemize}
\tightlist
\item
  Definition of a sigma algebra
\item
  What is means to say a sigma-algebra is generated by a collection of sets
\item
  Definition of Borel sigma-algebra
\item
  Examples of sets generating \(\mathcal{B}(\mathbb{R})\) + proof
\item
  \(\pi\)-systems and \(d\)-systems and the statement of Dynkin's lemma
\item
  Definition of a measure
\item
  Definition of countable subadditivity and monotonicity
\item
  Definition of a measure space
\item
  Definition Finite and sigma-finite measure spaces
\item
  Continuity of measure theorem
\end{itemize}

\hypertarget{lebesgue-measure}{%
\section{Lebesgue measure}\label{lebesgue-measure}}

\begin{itemize}
\tightlist
\item
  Definition of Lebesgue outer measure
\item
  Definition of a Lebesgue measurable set plus some knowledge of the proof they form a sigma algebra
\item
  Lebesgue measure restricted to the Lebesgue measurable sets is a measure
\item
  Borel sets are Lebesgue measurable + proof
\item
  Uniqueness of extension, how to apply it to sigma-finite spaces and uniqueness of Lebesgue measure in particular, some idea of the proof
\item
  Translation invariance of Lebesgue measure + proof
\item
  Null sets are Lebesgue measurable + proof
\item
  Characterisation of Lebesgue measurable sets as null set + Borel and some notion of the proof of this
\item
  Regularity of Lebesgue measure + proof
\item
  Existence of a non-Lebesgue measurable set (Vitali set) + proof
\end{itemize}

\hypertarget{measurable-functions}{%
\section{Measurable functions}\label{measurable-functions}}

\begin{itemize}
\tightlist
\item
  Definition of a measurable function plus use of generating sets to prove functions are measurable
\item
  Continuous functions are Borel measurable + proof
\item
  Monotone functions from \(\mathbb{R}\) to \(\mathbb{R}\) are Borel measurable + proof
\item
  Compositions of measurable function are measurable
\item
  Definition of image measure and some notions of Theorem 4.1
\item
  Definition of almost everywhere convergence
\item
  Definition of convergence in measure
  -Quasiequivalence of convergence (Theorem 4.2) + proof
\item
  Egoroff's Theorem + proof
\item
  Lusin's Theorem + proof
\end{itemize}

\hypertarget{integration-2}{%
\section{Integration}\label{integration-2}}

\begin{itemize}
\tightlist
\item
  Definition of a simple function
\item
  Definition of the integral of a simple function
\item
  Definition of the integral of a non-negative function
\item
  Definition of the integral of an integrable function
\item
  Monotone convergence theorem + the main ideas of the proof (Its too long to get you to repeat it in full but you should be familiar with it)
\item
  Working with non-negative functions by approximating by simple functions
\item
  Beppo-Levi + proof
\item
  Fatou's lemma + proof
\item
  Dominated convergence + proof
\item
  Some knowledge of how to differentiate under the integral sign
\item
  Some knowledge of how to prove the change of variables formula
\item
  Main ideas to show that Riemann integrable imples Lebesgue measurable and the integrals agree (again its too long to repeat in full but you should be familiar with the steps)
\end{itemize}

\hypertarget{norms-and-inequalities-1}{%
\section{Norms and Inequalities}\label{norms-and-inequalities-1}}

\begin{itemize}
\tightlist
\item
  Definition of \(L^p(E)\) and \(\|\cdot\|_p\) norm
\item
  Holder's inequality +proof
\item
  Minkowski's inequality + proof
\item
  Markov's inequality +proof
\item
  Jensen's inequality (+idea of the proof)
\item
  Completeness of \(L^p(E)\) + proof
\item
  Density of step functions and continuous functions in \(L^p(E)\)
\end{itemize}

\hypertarget{product-measure}{%
\section{Product Measure}\label{product-measure}}

\begin{itemize}
\tightlist
\item
  Definition of the product sigma-algebra and knowlege of associated small lemmas
\item
  Characterisation, existence and uniqueness of product measure in sigma-finite spaces (Theorem 7.1)+ proof
\item
  Fubini-Tonelli for positive functions + proof
\item
  Fubini-Tonelli for integrable functions + proof
\item
  Ideas from the applications of product measure section.
\end{itemize}

\hypertarget{radon-nikodym-theorem-1}{%
\section{Radon-Nikodym Theorem}\label{radon-nikodym-theorem-1}}

\begin{itemize}
\tightlist
\item
  Definition of finite signed measure
\item
  Definition of positive and negative sets
\item
  Hahn Decomposition theorem + proof
\item
  Jordan Decompositino theorem + proof
\item
  Definition of absolute continuity
\item
  Radon-Nikodym theorem + main ideas of the proof
\end{itemize}

  \bibliography{book.bib,packages.bib}

\end{document}
